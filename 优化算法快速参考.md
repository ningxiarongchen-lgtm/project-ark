# 优化算法快速参考 ⚡

**文件**: `frontend/src/utils/optimization.js`  
**版本**: v1.0

---

## 🚀 快速使用

```javascript
import { optimizeProjectSelection } from '@/utils/optimization';

const result = optimizeProjectSelection(project.selections);
```

---

## 📊 算法核心

### 4步优化流程

```
1. 收集需求
   ↓
2. 扭矩排序 (大→小)
   ↓
3. 贪心分组 (归并兼容需求)
   ↓
4. 生成BOM
```

---

## 💻 返回数据

```javascript
{
  optimized_bill_of_materials: [
    {
      actuator_model: "SF10-150DA",
      total_quantity: 3,
      unit_price: 8500,
      total_price: 25500,
      covered_tags: ["V-101", "V-102", "V-103"]
    }
  ],
  statistics: {
    original_count: 5,
    optimized_count: 3,
    total_quantity: 5,
    total_price: 34515,
    consolidation_rate: "40.00%",
    message: "成功优化：5 个选型 → 3 个型号"
  }
}
```

---

## 🔍 兼容性检查

**必须相同的参数**:
- ✅ 系列 (Series)
- ✅ 作用类型 (DA/SR)
- ✅ 机构类型
- ✅ 温度代码
- ✅ 阀门类型 (SF)
- ✅ 轭架类型 (SF)

---

## 📈 优化示例

### 输入 (5个选型)

```
V-101: SF10-150DA (3500 Nm, ¥8,500)
V-102: SF10-150DA (3200 Nm, ¥8,500)
V-103: SF10-150DA (2800 Nm, ¥8,500)
V-104: AT-DA63 (50 Nm, ¥90)
V-105: SF10-150DA-T1 (3600 Nm, ¥8,925)
```

### 输出 (3个型号)

```
1. SF10-150DA × 3 = ¥25,500
   位号: V-101, V-102, V-103

2. SF10-150DA-T1 × 1 = ¥8,925
   位号: V-105

3. AT-DA63 × 1 = ¥90
   位号: V-104

合并率: 40%
```

---

## 🎯 关键代码

### 贪心分组

```javascript
// 从最大需求开始
requirements.sort((a, b) => b.required_torque - a.required_torque);

for (let i = 0; i < requirements.length; i++) {
  // 归并所有兼容的较小需求
  for (let j = i + 1; j < requirements.length; j++) {
    if (checkCompatibility(req1, req2)) {
      if (currentTorque >= otherRequiredTorque) {
        // 归并
      }
    }
  }
}
```

---

## 📦 导出CSV

```javascript
import { exportOptimizedBOM } from '@/utils/optimization';

const csv = exportOptimizedBOM(result, 'ProjectName');
// 创建下载
const blob = new Blob([csv], { type: 'text/csv' });
const link = document.createElement('a');
link.href = URL.createObjectURL(blob);
link.download = 'BOM.csv';
link.click();
```

---

## 🎯 典型效果

| 项目规模 | 合并率 | 效果 |
|---------|--------|------|
| 小 (5-10) | 40-60% | 基本优化 |
| 中 (20-30) | 60-75% | ✅ 显著 |
| 大 (50+) | 70-80% | ✅✅ 优秀 |

---

**详细文档**: 见 `项目选型优化算法说明.md`

