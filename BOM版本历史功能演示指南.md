# BOM版本历史与对比 - 演示指南

## 🎯 功能演示步骤

### 第一步：创建初始版本

1. **打开项目详情页**
   - 进入任意项目（例如"测试项目"）
   - 切换到"BOM清单"Tab

2. **生成BOM数据**
   ```
   点击"从选型自动生成"按钮
   ↓
   系统自动生成优化后的BOM
   ↓
   表格中显示执行器型号、数量、价格等
   ```

3. **保存第一个版本**
   ```
   点击"保存BOM"按钮
   ↓
   看到提示："BOM清单已保存到项目中！（版本 1）"
   ↓
   注意"历史版本与对比"按钮出现蓝色标签(1)
   ```

---

### 第二步：创建更多版本

1. **修改BOM数据**
   ```
   点击某一行的"编辑"按钮
   ↓
   修改数量（例如从3改为5）
   ↓
   点击"保存"（行保存）
   ```

2. **保存第二个版本**
   ```
   点击"保存BOM"按钮
   ↓
   看到提示："BOM清单已保存到项目中！（版本 2）"
   ↓
   按钮标签更新为(2)
   ```

3. **再次修改并保存**
   ```
   手动添加一行新数据
   ↓
   点击"保存BOM"
   ↓
   创建版本3
   ```

---

### 第三步：查看版本历史

1. **打开版本历史Modal**
   ```
   点击"📜 历史版本与对比"按钮
   ↓
   弹出大型Modal（1200px宽）
   ↓
   左侧显示版本列表（版本3、版本2、版本1）
   ```

2. **查看版本列表**
   ```
   每个版本显示：
   - ✅ 版本号（例如"版本 3"）
   - 📅 时间戳
   - 👤 创建者
   - 📝 描述
   - 📊 统计（型号数、数量、总价）
   ```

---

### 第四步：查看单个版本详情

1. **选择一个版本**
   ```
   勾选"版本 2"
   ↓
   右侧显示版本详情卡片
   ```

2. **查看详情内容**
   ```
   ┌─────────────────────────┐
   │ 版本 2 详情             │
   ├─────────────────────────┤
   │ 版本号: 2               │
   │ 创建时间: 2025-10-27... │
   │ 创建者: 张三            │
   │ 型号数: 5               │
   │ 总数量: 20              │
   │ 总价: ¥105,600         │
   ├─────────────────────────┤
   │ [完整BOM表格]           │
   └─────────────────────────┘
   ```

---

### 第五步：对比两个版本 ⭐

1. **选择第二个版本**
   ```
   保持"版本 2"勾选
   ↓
   再勾选"版本 3"
   ↓
   右侧自动切换为并排对比视图
   ```

2. **查看对比结果**
   ```
   顶部显示差异统计：
   🟢 新增: 1   🔴 删除: 0   🟠 修改: 2
   
   中间并排显示：
   ┌─────────────┬─────────────┐
   │   版本2     │   版本3     │
   ├─────────────┼─────────────┤
   │ SF050  3台  │ SF050  5台  │ ← 🟠橙色高亮（数量修改）
   │ SF075  2台  │ SF075  2台  │
   │ (未创建)    │ SF100  3台  │ ← 🟢绿色高亮（新增）
   └─────────────┴─────────────┘
   
   底部差异详情：
   • 新增项 (1): SF100-DA - 数量: 3
   • 修改项 (1): SF050-DA: 数量 3 → 5
   ```

3. **理解颜色含义**
   - **🟢 绿色背景** = 新增的型号
   - **🔴 红色背景** = 删除的型号
   - **🟠 橙色背景** = 数量/价格有变化

---

### 第六步：恢复到历史版本

1. **选择要恢复的版本**
   ```
   找到"版本 1"
   ↓
   点击其"恢复"按钮
   ```

2. **确认恢复**
   ```
   弹出确认对话框：
   "将BOM清单恢复到版本 1？
    当前未保存的修改将丢失。"
   ↓
   点击"确认恢复"
   ```

3. **验证恢复结果**
   ```
   Modal自动关闭
   ↓
   BOM表格数据已恢复到版本1的状态
   ↓
   看到成功提示："已恢复到版本 1"
   ```

4. **保存恢复后的数据**
   ```
   检查数据无误
   ↓
   点击"保存BOM"
   ↓
   创建新版本（版本4）
   ```

---

## 🎬 完整演示剧本

### 场景：发现错误需要回退

```
【背景】
小明昨天修改了BOM清单，今天发现修改有误，需要回退到前天的版本。

【操作流程】
1. 小明打开项目详情页
2. 切换到"BOM清单"Tab
3. 点击"历史版本与对比"按钮
4. 在左侧看到：
   - 版本5（今天14:30）  ← 当前版本（有错误）
   - 版本4（今天10:00）
   - 版本3（昨天16:00）
   - 版本2（前天15:00）  ← 正确版本
   - 版本1（前天09:00）

5. 小明想先对比版本2和版本5，看看到底改了什么：
   - 勾选"版本2"
   - 勾选"版本5"
   - 右侧显示对比：
     * 新增: 2个型号
     * 删除: 1个型号
     * 修改: 3个型号的数量

6. 小明确认版本2是正确的：
   - 点击版本2的"恢复"按钮
   - 确认恢复
   - 数据已恢复

7. 小明保存新版本：
   - 点击"保存BOM"
   - 创建版本6（实际上是版本2的复制）
   - 大功告成！
```

---

## 📸 关键界面截图说明

### 界面1：版本列表（左侧）

```
┌───────────────────────────┐
│ 📜 历史版本列表 (5个版本) │
├───────────────────────────┤
│ ℹ️  勾选最多2个版本...     │
├───────────────────────────┤
│ ┌─────────────────────┐   │
│ │ ☑ 版本 5    [恢复]  │   │  ← 最新版本
│ │ 2025-10-27 14:30    │   │
│ │ 创建者: 小明        │   │
│ │ ─────────────────   │   │
│ │ 🔷5型 🟢20台 🟠¥106K│   │
│ └─────────────────────┘   │
│                           │
│ ┌─────────────────────┐   │
│ │ ☐ 版本 4    [恢复]  │   │
│ │ 2025-10-27 10:00    │   │
│ │ ...                 │   │
│ └─────────────────────┘   │
└───────────────────────────┘
```

### 界面2：单版本查看（右侧）

```
┌─────────────────────────────────┐
│ 版本 5 详情                     │
├─────────────────────────────────┤
│ 版本号: 5    创建时间: ...      │
│ 创建者: 小明  型号数: 5         │
│ 总数量: 20    总价: ¥105,600   │
├─────────────────────────────────┤
│ ┌──┬─────────┬───┬─────┬────┐ │
│ │#│ 型号    │数量│单价 │总价│ │
│ ├──┼─────────┼───┼─────┼────┤ │
│ │1│SF050-DA │ 5 │5,280│... │ │
│ │2│SF075-DA │ 2 │6,800│... │ │
│ │3│SF100-DA │ 3 │8,500│... │ │
│ └──┴─────────┴───┴─────┴────┘ │
└─────────────────────────────────┘
```

### 界面3：双版本对比（右侧）

```
┌─────────────────────────────────────────┐
│ ✅ 版本对比                             │
│ 对比版本 2 和版本 5，差异已高亮显示     │
├─────────────────────────────────────────┤
│ 🟢新增:1  🔴删除:0  🟠修改:2           │
├─────────────────────────────────────────┤
│ ┌────────────┬────────────┐            │
│ │  版本 2    │  版本 5    │            │
│ ├────────────┼────────────┤            │
│ │ SF050  3台 │ SF050  5台 │ 🟠修改    │
│ │ SF075  2台 │ SF075  2台 │            │
│ │ ─────────  │ SF100  3台 │ 🟢新增    │
│ └────────────┴────────────┘            │
├─────────────────────────────────────────┤
│ 差异详情:                               │
│ • 新增项(1): SF100-DA - 数量:3         │
│ • 修改项(1): SF050-DA: 数量 3→5        │
└─────────────────────────────────────────┘
```

---

## 🧪 测试检查清单

### 基础功能测试

- [ ] ✅ 保存BOM时创建版本
- [ ] ✅ 版本号自动递增
- [ ] ✅ 时间戳正确显示
- [ ] ✅ 创建者信息正确
- [ ] ✅ 统计数据准确
- [ ] ✅ 版本列表按时间倒序

### 查看功能测试

- [ ] ✅ 打开版本历史Modal
- [ ] ✅ 左侧显示版本列表
- [ ] ✅ 勾选1个版本显示详情
- [ ] ✅ 详情数据完整准确

### 对比功能测试

- [ ] ✅ 勾选2个版本显示对比
- [ ] ✅ 并排显示两个版本
- [ ] ✅ 差异统计正确
- [ ] ✅ 新增项绿色高亮
- [ ] ✅ 删除项红色高亮
- [ ] ✅ 修改项橙色高亮
- [ ] ✅ 差异详情显示正确

### 恢复功能测试

- [ ] ✅ 点击恢复弹出确认框
- [ ] ✅ 确认后数据恢复
- [ ] ✅ 取消后无变化
- [ ] ✅ Modal自动关闭
- [ ] ✅ 显示成功提示

### 边界情况测试

- [ ] ✅ 无版本时按钮禁用
- [ ] ✅ 只有1个版本时能查看
- [ ] ✅ 选择3个版本时自动替换
- [ ] ✅ 空BOM保存提示错误
- [ ] ✅ 编辑中保存提示先完成编辑

### UI/UX测试

- [ ] ✅ Modal宽度1200px
- [ ] ✅ 左右布局8:16
- [ ] ✅ 版本卡片选中高亮
- [ ] ✅ 按钮状态正确
- [ ] ✅ 颜色对比明显
- [ ] ✅ 滚动条样式美观

---

## 💡 使用技巧

### 技巧1：快速找到特定版本

```
在版本列表中，按时间或创建者快速定位：
- 最新的版本在最上方
- 每个版本显示时间和创建者
- 可以通过统计数据（型号数、总价）快速识别
```

### 技巧2：对比相邻版本找出变化

```
要了解每次修改的内容：
1. 勾选版本4
2. 勾选版本5
3. 查看差异
4. 然后勾选版本3和版本4
5. 持续对比相邻版本
```

### 技巧3：版本恢复后立即保存

```
建议恢复版本后的操作：
1. 恢复到版本X
2. 检查数据是否正确
3. 立即保存BOM（创建新版本）
4. 这样版本历史更清晰
```

### 技巧4：定期查看版本历史

```
养成好习惯：
- 每周查看一次版本历史
- 了解BOM的演变过程
- 发现异常及时处理
```

---

## 🎓 培训要点

### 向用户介绍的重点

1. **自动版本管理**
   - "每次保存BOM都会自动创建版本快照"
   - "不需要手动管理版本号"
   - "完整记录所有历史变化"

2. **可视化对比**
   - "可以并排对比任意两个版本"
   - "颜色高亮显示差异"
   - "一目了然看出变化"

3. **安全恢复**
   - "可以随时恢复到任意历史版本"
   - "恢复前需要确认"
   - "防止误操作"

4. **审计追踪**
   - "记录谁在何时做了什么修改"
   - "方便问题追溯"
   - "满足合规要求"

---

## 📝 演示脚本（5分钟版）

```
大家好！今天演示BOM版本历史与对比功能。

【1分钟 - 介绍】
这个功能可以帮助我们：
- 自动记录BOM的所有历史版本
- 对比不同版本的差异
- 恢复到之前的版本

【1分钟 - 查看版本】
首先，点击"历史版本与对比"按钮...
左侧显示所有版本，包括时间、创建者、统计信息...

【2分钟 - 对比版本】
现在我勾选两个版本，版本2和版本5...
右侧自动显示并排对比...
看，绿色是新增的，橙色是修改的，红色是删除的...
底部还有详细的差异列表...

【1分钟 - 恢复版本】
如果要恢复到某个版本，点击"恢复"按钮...
确认后，BOM数据就恢复了...
记得保存创建新版本...

【总结】
就是这样！简单、直观、安全！
```

---

**完成时间:** 2025-10-27  
**适用人群:** 系统用户、培训师、测试人员  
**难度等级:** ⭐⭐☆☆☆（中低）

