# âœ… å½“å‰éƒ¨ç½²çŠ¶æ€ä¸ä¸‹ä¸€æ­¥æ“ä½œ

**æ–¹æ¡ˆ**: Vercel + Render + MongoDB Atlasé¦™æ¸¯  
**æ£€æŸ¥æ—¶é—´**: 2025-10-31  

---

## ğŸ“Š å½“å‰çŠ¶æ€æ€»ç»“

### 1ï¸âƒ£ å‰ç«¯ï¼ˆVercelï¼‰- âœ… å·²å®Œæˆ

| é¡¹ç›® | çŠ¶æ€ |
|------|------|
| éƒ¨ç½²çŠ¶æ€ | âœ… æˆåŠŸ |
| åŸŸå | `project-ark-one.vercel.app` |
| æ„å»º | âœ… æ­£å¸¸ |
| ä¾èµ–é—®é¢˜ | âœ… å·²ä¿®å¤ï¼ˆcmdk, @mui/icons-materialï¼‰|

**âš ï¸ å¾…å®Œæˆ**:
- éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ `VITE_API_URL`ï¼ˆç­‰åç«¯éƒ¨ç½²å®Œæˆåé…ç½®ï¼‰

---

### 2ï¸âƒ£ åç«¯ï¼ˆRenderï¼‰- â“ æœªç¡®è®¤

**éœ€è¦ç¡®è®¤**:
- æ˜¯å¦å·²åœ¨ Render åˆ›å»ºåç«¯æœåŠ¡ï¼Ÿ
- å¦‚æœå·²åˆ›å»ºï¼ŒURL æ˜¯ä»€ä¹ˆï¼Ÿ

**å¦‚æœæœªåˆ›å»º**ï¼Œéœ€è¦ï¼š
1. æ³¨å†Œ Render è´¦å·
2. åˆ›å»º Web Service
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²åç«¯

---

### 3ï¸âƒ£ æ•°æ®åº“ï¼ˆMongoDB Atlas é¦™æ¸¯ï¼‰- â“ æœªç¡®è®¤

**éœ€è¦ç¡®è®¤**:
- æ˜¯å¦å·²åˆ›å»º MongoDB Atlas è´¦å·ï¼Ÿ
- æ˜¯å¦å·²åˆ›å»ºé¦™æ¸¯èŠ‚ç‚¹é›†ç¾¤ï¼Ÿ
- æ˜¯å¦å·²è·å–è¿æ¥å­—ç¬¦ä¸²ï¼Ÿ

**æœ¬åœ°æ•°æ®æƒ…å†µ**:
```
æ•°æ®åº“å: cmax
æ•°æ®å¤§å°: 2.95 MB

æ•°æ®æ˜ç»†:
- users: 9 ä¸ªç”¨æˆ·
- actuators: 337 ä¸ªæ‰§è¡Œå™¨äº§å“
- projects: 4 ä¸ªé¡¹ç›®
- accessories: 10 ä¸ªé…ä»¶
- suppliers: 5 ä¸ªä¾›åº”å•†
- manualoverrides: 18 ä¸ªæ‰‹åŠ¨æ“ä½œè£…ç½®
- refreshtokens: 101 ä¸ªåˆ·æ–°ä»¤ç‰Œï¼ˆå¯åˆ é™¤ï¼‰
```

**æ•°æ®è¿ç§»é€‰é¡¹**:
- **é€‰é¡¹A**: è¿ç§»æœ¬åœ°æ•°æ®åˆ°äº‘ç«¯ï¼ˆä¿ç•™ç°æœ‰æ•°æ®ï¼‰
- **é€‰é¡¹B**: ä½¿ç”¨ seed è„šæœ¬ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼ˆæ¨èé¢„å”®é˜¶æ®µï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œæ–¹æ¡ˆ

### æ–¹æ¡ˆAï¼šä»å¤´å¼€å§‹éƒ¨ç½²ï¼ˆæ¨èï¼‰

**é€‚åˆ**: åˆšå¼€å§‹éƒ¨ç½²ï¼Œè¿˜æ²¡æœ‰åˆ›å»º Render å’Œ MongoDB Atlas

**æ­¥éª¤**:
1. éƒ¨ç½² MongoDB Atlas é¦™æ¸¯èŠ‚ç‚¹ï¼ˆ5åˆ†é’Ÿï¼‰
2. éƒ¨ç½²åç«¯åˆ° Renderï¼ˆ10åˆ†é’Ÿï¼‰
3. é…ç½® Vercel ç¯å¢ƒå˜é‡ï¼ˆ2åˆ†é’Ÿï¼‰
4. æµ‹è¯•å®Œæ•´åŠŸèƒ½ï¼ˆ3åˆ†é’Ÿï¼‰

**æ€»è€—æ—¶**: çº¦20åˆ†é’Ÿ

---

### æ–¹æ¡ˆBï¼šç»§ç»­æœªå®Œæˆçš„éƒ¨ç½²

**é€‚åˆ**: å·²ç»éƒ¨ç½²äº†éƒ¨åˆ†æœåŠ¡ï¼Œéœ€è¦ç»§ç»­å®Œæˆ

**éœ€è¦æ‚¨å‘Šè¯‰æˆ‘**:
1. Render åç«¯ URLï¼ˆå¦‚æœå·²éƒ¨ç½²ï¼‰
2. MongoDB Atlas è¿æ¥å­—ç¬¦ä¸²ï¼ˆå¦‚æœå·²åˆ›å»ºï¼‰
3. å½“å‰é‡åˆ°çš„é—®é¢˜ï¼ˆå¦‚æœæœ‰ï¼‰

---

## ğŸš€ è¯¦ç»†éƒ¨ç½²æ­¥éª¤ï¼ˆæ–¹æ¡ˆAï¼‰

### ç¬¬1æ­¥ï¼šéƒ¨ç½² MongoDB Atlas é¦™æ¸¯èŠ‚ç‚¹ï¼ˆ5åˆ†é’Ÿï¼‰

#### 1.1 æ³¨å†Œè´¦å·
```
è®¿é—®ï¼šhttps://www.mongodb.com/cloud/atlas/register
é€‰æ‹©ï¼šSign up with Googleï¼ˆæœ€å¿«ï¼‰
```

#### 1.2 åˆ›å»ºå…è´¹é›†ç¾¤
```
1. ç‚¹å‡»ï¼šBuild a Database
2. é€‰æ‹©ï¼šShared (FREE)
3. äº‘æœåŠ¡å•†ï¼šAWS
4. åŒºåŸŸï¼šâ­ Hong Kong (ap-east-1) ã€å¿…é¡»é€‰è¿™ä¸ªï¼ã€‘
5. é›†ç¾¤åç§°ï¼šproject-ark-hk
6. ç‚¹å‡»ï¼šCreate
```

**âš ï¸ å…³é”®**ï¼šå¿…é¡»é€‰æ‹© Hong Kong (ap-east-1)ï¼Œè¿™æ ·å»¶è¿Ÿæœ€ä½ï¼ˆ20-50msï¼‰

#### 1.3 åˆ›å»ºæ•°æ®åº“ç”¨æˆ·
```
Security â†’ Database Access â†’ Add New Database User

Username: arkadmin
Password: ç‚¹å‡» "Autogenerate Secure Password"
ã€ä¿å­˜è¿™ä¸ªå¯†ç ï¼Œåé¢è¦ç”¨ã€‘
Role: Atlas admin
ç‚¹å‡»ï¼šAdd User
```

#### 1.4 é…ç½®ç½‘ç»œè®¿é—®
```
Security â†’ Network Access â†’ Add IP Address
é€‰æ‹©ï¼šAllow Access from Anywhere
è¾“å…¥ï¼š0.0.0.0/0
ç‚¹å‡»ï¼šConfirm
```

#### 1.5 è·å–è¿æ¥å­—ç¬¦ä¸²
```
Database â†’ Connect â†’ Connect your application

Driver: Node.js
Version: 4.1 or later

å¤åˆ¶è¿æ¥å­—ç¬¦ä¸²ï¼š
mongodb+srv://arkadmin:<password>@project-ark-hk.xxxxx.mongodb.net/?retryWrites=true&w=majority

âš ï¸ æŠŠ <password> æ›¿æ¢æˆä½ çš„å®é™…å¯†ç 
âš ï¸ ä¿å­˜è¿™ä¸ªè¿æ¥å­—ç¬¦ä¸²
```

**âœ… æ£€æŸ¥ç‚¹**: å·²è·å– MongoDB è¿æ¥å­—ç¬¦ä¸²

---

### ç¬¬2æ­¥ï¼šéƒ¨ç½²åç«¯åˆ° Renderï¼ˆ10åˆ†é’Ÿï¼‰

#### 2.1 æ³¨å†Œ Render
```
è®¿é—®ï¼šhttps://render.com
ç‚¹å‡»ï¼šGet Started
é€‰æ‹©ï¼šSign Up with GitHub
```

#### 2.2 åˆ›å»º Web Service
```
Dashboard â†’ New + â†’ Web Service
é€‰æ‹©ä»“åº“ï¼šningxiarongchen-lgtm/project-ark
ç‚¹å‡»ï¼šConnect
```

#### 2.3 é…ç½®æœåŠ¡
```
Name: project-ark-backend
Region: Singapore â­ï¼ˆç¦»é¦™æ¸¯æœ€è¿‘ï¼‰
Branch: main
Root Directory: backend
Runtime: Node
Build Command: npm install
Start Command: node server.js
Instance Type: Free
```

#### 2.4 é…ç½®ç¯å¢ƒå˜é‡ï¼ˆé‡è¦ï¼‰

ç‚¹å‡» "Advanced" â†’ "Add Environment Variable"

æ·»åŠ ä»¥ä¸‹6ä¸ªå˜é‡ï¼š

**1. NODE_ENV**
```
production
```

**2. PORT**
```
5001
```

**3. MONGODB_URI**
```
mongodb+srv://arkadmin:ä½ çš„å¯†ç @project-ark-hk.xxxxx.mongodb.net/cmax?retryWrites=true&w=majority
```
âš ï¸ ä½¿ç”¨ç¬¬1æ­¥è·å¾—çš„è¿æ¥å­—ç¬¦ä¸²ï¼Œæœ«å°¾æ·»åŠ  `/cmax`

**4. JWT_SECRET**
```
624f154889a31793e7a74857fc8699296080cd1883bce90a6ff75d831f8dc77736037dddc00e14f9c0dbfefb42916ecb0dae6eb86c8133b821ab56e494f4d6dd
```

**5. JWT_REFRESH_SECRET**
```
0bef6a83aa1e56bcf61f4f9fdce62d16e7ec90dc221e734d4ba6b21f8f9efd965786cb8bd542e127113a33711f5ef9c7e2bedf9194ef0c4d1d49e59270aa66d4
```

**6. ALLOWED_ORIGINS**
```
https://project-ark-one.vercel.app
```
âš ï¸ ä½¿ç”¨æ‚¨çš„å®é™… Vercel å‰ç«¯åœ°å€

#### 2.5 åˆ›å»ºå¹¶ç­‰å¾…éƒ¨ç½²
```
ç‚¹å‡»ï¼šCreate Web Service
ç­‰å¾…5-10åˆ†é’Ÿè‡ªåŠ¨éƒ¨ç½²
```

éƒ¨ç½²å®Œæˆåï¼Œè®°ä¸‹ç½‘å€ï¼š
```
https://project-ark-backend.onrender.com
ï¼ˆæˆ–ç±»ä¼¼çš„åœ°å€ï¼‰
```

#### 2.6 åˆå§‹åŒ–æ•°æ®åº“

**é€‰é¡¹Aï¼šä½¿ç”¨æµ‹è¯•æ•°æ®ï¼ˆæ¨èï¼‰**
```
Render æ§åˆ¶å° â†’ Shell æ ‡ç­¾

æ‰§è¡Œï¼š
npm run seed:final

ç­‰å¾…å®Œæˆï¼ˆçº¦30ç§’ï¼‰
```

**é€‰é¡¹Bï¼šè¿ç§»æœ¬åœ°æ•°æ®**
```
åœ¨æœ¬åœ°è¿è¡Œï¼š
cd backend

# å¯¼å‡ºæœ¬åœ°æ•°æ®
mongodump --db cmax --out ./local_backup

# å¯¼å…¥åˆ°äº‘ç«¯
mongorestore --uri "mongodb+srv://arkadmin:å¯†ç @project-ark-hk.xxxxx.mongodb.net/" --db cmax ./local_backup/cmax
```

**âœ… æ£€æŸ¥ç‚¹**: åç«¯å·²éƒ¨ç½²ï¼ŒURL å·²è·å–

---

### ç¬¬3æ­¥ï¼šé…ç½® Vercel ç¯å¢ƒå˜é‡ï¼ˆ2åˆ†é’Ÿï¼‰

#### 3.1 è¿›å…¥ Vercel é¡¹ç›®è®¾ç½®
```
è®¿é—®ï¼šhttps://vercel.com/dashboard
é€‰æ‹©é¡¹ç›®ï¼šproject-ark
ç‚¹å‡»ï¼šSettings
ç‚¹å‡»ï¼šEnvironment Variables
```

#### 3.2 æ·»åŠ ç¯å¢ƒå˜é‡
```
Key: VITE_API_URL
Value: https://project-ark-backend.onrender.com
ï¼ˆä½¿ç”¨ç¬¬2æ­¥è·å¾—çš„ Render åç«¯ URLï¼‰

Environment: 
âœ… Production
âœ… Preview
âœ… Development

ç‚¹å‡»ï¼šSave
```

#### 3.3 é‡æ–°éƒ¨ç½²
```
ç‚¹å‡»ï¼šDeployments
æ‰¾åˆ°æœ€æ–°éƒ¨ç½²
ç‚¹å‡»ï¼š... â†’ Redeploy
ç­‰å¾…1-2åˆ†é’Ÿ
```

**âœ… æ£€æŸ¥ç‚¹**: å‰ç«¯ç¯å¢ƒå˜é‡å·²é…ç½®

---

### ç¬¬4æ­¥ï¼šæµ‹è¯•å®Œæ•´åŠŸèƒ½ï¼ˆ3åˆ†é’Ÿï¼‰

#### 4.1 æµ‹è¯•åç«¯
```
æµè§ˆå™¨è®¿é—®ï¼š
https://project-ark-backend.onrender.com/api/health

åº”è¯¥è¿”å›ï¼š
{
  "status": "OK",
  "message": "Project Ark Platform API is running"
}
```

#### 4.2 æµ‹è¯•å‰ç«¯
```
è®¿é—®ï¼šhttps://project-ark-one.vercel.app

åº”è¯¥çœ‹åˆ°ï¼š
âœ… ç™»å½•é¡µé¢æ­£å¸¸æ˜¾ç¤º
```

#### 4.3 æµ‹è¯•ç™»å½•
```
ä½¿ç”¨æµ‹è¯•è´¦å·ï¼š
æ‰‹æœºå·ï¼š13000000002
å¯†ç ï¼špassword

ç™»å½•ååº”è¯¥ï¼š
âœ… è·³è½¬åˆ°ä»ªè¡¨ç›˜
âœ… å¯ä»¥çœ‹åˆ°æ•°æ®
âœ… åŠŸèƒ½æ­£å¸¸ä½¿ç”¨
```

**âœ… éƒ¨ç½²å®Œæˆï¼**

---

## ğŸ“ éƒ¨ç½²å®Œæˆåçš„ä¿¡æ¯è®°å½•

å®Œæˆéƒ¨ç½²åï¼Œè¯·è®°å½•ä»¥ä¸‹ä¿¡æ¯ï¼š

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Project Ark - éƒ¨ç½²ä¿¡æ¯
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

å‰ç«¯ URL:
https://project-ark-one.vercel.app

åç«¯ URL:
https://project-ark-backend.onrender.com

æ•°æ®åº“:
MongoDB Atlas é¦™æ¸¯èŠ‚ç‚¹

æµ‹è¯•è´¦å·:
ç®¡ç†å‘˜ï¼š13000000001 / password
é”€å”®ç»ç†ï¼š13000000002 / password
æŠ€æœ¯å·¥ç¨‹å¸ˆï¼š13000000003 / password

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ğŸ”„ æœ¬åœ°æ•°æ®è¿ç§»è¯¦ç»†æ­¥éª¤ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœæ‚¨æƒ³ä¿ç•™æœ¬åœ°çš„337ä¸ªäº§å“å’Œå…¶ä»–æ•°æ®ï¼š

### æ­¥éª¤1ï¼šå¤‡ä»½æœ¬åœ°æ•°æ®
```bash
cd "/Users/hexiaoxiao/Desktop/Model Selection System"
mongodump --db cmax --out ./cloud_migration_backup
```

### æ­¥éª¤2ï¼šå¯¼å…¥åˆ° MongoDB Atlas
```bash
# ä½¿ç”¨ MongoDB Atlas çš„è¿æ¥å­—ç¬¦ä¸²
mongorestore \
  --uri "mongodb+srv://arkadmin:ä½ çš„å¯†ç @project-ark-hk.xxxxx.mongodb.net/" \
  --db cmax \
  ./cloud_migration_backup/cmax
```

### æ­¥éª¤3ï¼šéªŒè¯æ•°æ®
```bash
# ç™»å½• MongoDB Atlas
mongosh "mongodb+srv://project-ark-hk.xxxxx.mongodb.net/" --username arkadmin

# æ£€æŸ¥æ•°æ®
use cmax
db.users.countDocuments()
db.actuators.countDocuments()
db.projects.countDocuments()
```

---

## ğŸ’¡ é‡è¦æç¤º

### 1. MongoDB å¿…é¡»é€‰é¦™æ¸¯èŠ‚ç‚¹
```
âŒ ä¸è¦é€‰ï¼šSingaporeã€Tokyoã€Mumbai
âœ… å¿…é¡»é€‰ï¼šHong Kong (ap-east-1)

åŸå› ï¼šå»¶è¿Ÿæœ€ä½ï¼ˆ20-50msï¼‰
```

### 2. Render ç¬¬ä¸€æ¬¡è®¿é—®ä¼šæ…¢
```
åŸå› ï¼šå…è´¹ç‰ˆ15åˆ†é’Ÿæ— è®¿é—®ä¼šä¼‘çœ 
è§£å†³ï¼šé…ç½® UptimeRobotï¼ˆ5åˆ†é’Ÿé—´éš”pingï¼‰
```

### 3. æ•°æ®é€‰æ‹©
```
æµ‹è¯•æ•°æ®ï¼ˆæ¨èï¼‰ï¼š
- ä½¿ç”¨ seed:final è„šæœ¬
- 9ä¸ªæµ‹è¯•è´¦å·
- 337ä¸ªæ‰§è¡Œå™¨äº§å“
- å¹²å‡€æ•´æ´

è¿ç§»æœ¬åœ°æ•°æ®ï¼š
- ä¿ç•™ç°æœ‰æ•°æ®
- éœ€è¦é¢å¤–æ­¥éª¤
- å¯èƒ½æœ‰å†—ä½™æ•°æ®
```

---

## â“ ç°åœ¨è¯·å‘Šè¯‰æˆ‘

ä¸ºäº†ç»§ç»­å¸®åŠ©æ‚¨ï¼Œè¯·å›ç­”ï¼š

**1. æ‚¨æƒ³ä½¿ç”¨å“ªä¸ªæ–¹æ¡ˆï¼Ÿ**
- [ ] æ–¹æ¡ˆAï¼šä»å¤´å¼€å§‹éƒ¨ç½²ï¼ˆæˆ‘ä¸€æ­¥æ­¥æŒ‡å¯¼ï¼‰
- [ ] æ–¹æ¡ˆBï¼šå·²ç»éƒ¨ç½²äº†éƒ¨åˆ†ï¼Œéœ€è¦ç»§ç»­

**2. å¦‚æœé€‰æ–¹æ¡ˆBï¼Œè¯·æä¾›ï¼š**
- Render åç«¯ URLï¼š_________________
- MongoDB Atlas è¿æ¥å­—ç¬¦ä¸²ï¼š_________________
- å½“å‰é—®é¢˜ï¼š_________________

**3. æ•°æ®é€‰æ‹©ï¼š**
- [ ] ä½¿ç”¨ seed æµ‹è¯•æ•°æ®ï¼ˆæ¨èï¼‰
- [ ] è¿ç§»æœ¬åœ°337ä¸ªäº§å“æ•°æ®

**4. å½“å‰èƒ½åšçš„æµ‹è¯•ï¼š**
- èƒ½æ‰“å¼€ `https://project-ark-one.vercel.app` å—ï¼Ÿ
- èƒ½çœ‹åˆ°ç™»å½•é¡µé¢å—ï¼Ÿ
- å°è¯•ç™»å½•æœ‰ä»€ä¹ˆæç¤ºï¼Ÿ

å›ç­”è¿™äº›é—®é¢˜åï¼Œæˆ‘ä¼šæä¾›ç²¾ç¡®çš„ä¸‹ä¸€æ­¥æ“ä½œï¼ğŸš€

