# 角色权限与功能清单

> 更新时间：2025年10月30日  
> 版本：v2.0

---

## 📊 角色功能对照表

### 1️⃣ 销售经理 (Sales Manager)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 项目管理
- ✅ 订单管理（只读）
- ✅ 售后服务
- ✅ 产品目录

#### 项目管理权限

**创建项目阶段**
| 功能 | 权限 | 说明 |
|------|------|------|
| 创建项目 | ✅ | 填写客户信息、需求 |
| 上传技术文件 | ✅ | 上传客户技术说明书 |
| 指派技术工程师 | ✅ | 将项目分配给技术工程师 |
| 编辑项目基本信息 | ✅ | 客户信息、联系方式等 |
| 删除项目 | ❌ | 仅管理员可删除 |

**询价阶段**（状态：已报价-询价中）
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看技术清单 | ✅ 只读 | 不能修改技术选型 |
| 查看报价单 | ✅ 只读 | 不能修改价格 |
| 下载报价单 | ✅ | 下载PDF给客户 |
| 修改价格 | ❌ | 仅商务可修改 |

**合同阶段**
| 功能 | 权限 | 状态要求 |
|------|------|---------|
| 上传销售合同 | ✅ | 已报价-询价中（客户接受后） |
| 下载盖章合同 | ✅ | 待客户盖章 |
| 上传最终合同 | ✅ | 待客户盖章（客户盖章后） |

**生产跟进**
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看订单状态 | ✅ 只读 | 查看生产进度 |
| 创建生产订单 | ❌ | 仅商务可创建 |

#### 限制说明
- ❌ 不能修改技术选型
- ❌ 不能修改报价和价格
- ❌ 不能查看成本价
- ❌ 不能手动标记"赢单"（系统自动，客户盖章后）
- ❌ 不能访问生产排期、采购管理

---

### 2️⃣ 技术工程师 (Technical Engineer)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 项目管理（仅分配给自己的）
- ✅ 售后服务

#### 项目管理权限

**技术选型阶段**
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看分配给自己的项目 | ✅ | 仅看指派给自己的 |
| 下载技术文件 | ✅ | 查看客户需求文档 |
| 填写技术清单 | ✅ | 添加型号、数量、参数 |
| 选择产品型号 | ✅ | 选择执行器和配件 |
| 提交技术选型 | ✅ | 提交给商务报价 |

**限制说明**
| 功能 | 权限 | 原因 |
|------|------|------|
| 查看价格 | ❌ | 技术不涉价 |
| 查看报价单 | ❌ | 避免价格干扰技术判断 |
| 查看合同 | ❌ | 不参与商务环节 |
| 访问产品数据库 | ❌ | 数据库包含价格信息 |
| 创建项目 | ❌ | 仅销售创建 |
| 修改客户信息 | ❌ | 仅销售可修改 |

#### 工作流程
```
接收任务 → 查看技术文件 → 技术选型 → 提交 → 工作结束
```

---

### 3️⃣ 商务专员 (Sales Engineer)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 项目管理
- ✅ 产品数据库（管理价格）

#### 项目管理权限

**报价阶段**（状态：待商务报价）
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看技术清单 | ✅ | 查看技术选型结果 |
| 查看成本价 | ✅ | 计算利润 |
| 设置价格策略 | ✅ | 标准价/阶梯价/手动调价 |
| 生成报价单 | ✅ | 完成报价 |
| 反馈修改技术清单 | ✅ | 如需调整选型 |

**合同阶段**
| 功能 | 权限 | 状态要求 |
|------|------|---------|
| 审核销售合同 | ✅ | 待商务审核合同 |
| 下载合同盖章 | ✅ | 待商务审核合同 |
| 上传盖章合同 | ✅ | 待商务审核合同 → 待客户盖章 |

**预付款管理**
| 功能 | 权限 | 状态要求 |
|------|------|---------|
| 确认预付款到账 | ✅ | 待预付款 |
| 创建生产订单 | ✅ | 预付款到账后 |
| 通知生产排期 | ✅ | 创建订单后 |

#### 产品数据库权限
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看产品 | ✅ | 查看所有产品 |
| 编辑产品 | ✅ | 修改产品信息 |
| 设置价格 | ✅ | 设置销售价、成本价 |
| 设置阶梯价 | ✅ | 设置批量优惠 |

---

### 4️⃣ 生产员 (Production Planner)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 订单管理
- ✅ 生产排期
- ✅ 产品数据库（查看物料）

#### 订单管理权限

**接收生产订单**
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看生产订单 | ✅ | 预付款到账的订单 |
| 查看技术清单 | ✅ 只读 | 了解产品型号数量 |
| 查看报价单 | ❌ | 不涉及价格 |

**BOM管理**
| 功能 | 权限 | 说明 |
|------|------|------|
| 拆分BOM表 | ✅ | 将产品拆为零部件 |
| 检查库存 | ✅ | 区分有料/缺料 |
| 修改BOM | ✅ | 调整物料清单 |

**生产排期**
| 功能 | 权限 | 说明 |
|------|------|------|
| 创建生产工单 | ✅ | 有料部分 |
| 创建采购申请 | ✅ | 缺料部分 |
| 更新生产进度 | ✅ | 跟踪进度 |
| 安排车间排期 | ✅ | 生产计划 |

#### 产品数据库权限
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看产品 | ✅ | 查看产品规格 |
| 查看BOM结构 | ✅ | 了解物料构成 |
| 编辑产品 | ❌ | 仅管理员可编辑 |
| 查看价格 | ❌ | 不涉及价格 |

---

### 5️⃣ 采购专员 (Procurement Specialist)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 采购管理
- ✅ 供应商管理
- ✅ 产品数据库（管理供应商）

#### 采购管理权限
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看采购申请 | ✅ | 生产员提交的申请 |
| 创建采购订单 | ✅ | 向供应商下单 |
| 跟踪采购进度 | ✅ | 到货跟踪 |
| 确认到货 | ✅ | 通知生产员 |

---

### 6️⃣ 售后工程师 (After-sales Engineer)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 售后服务
- ✅ 产品数据库（查询配件）

#### 售后服务权限
| 功能 | 权限 | 说明 |
|------|------|------|
| 查看工单 | ✅ | 分配给自己的工单 |
| 接单处理 | ✅ | 处理售后问题 |
| 添加跟进记录 | ✅ | 记录处理过程 |
| 标记已解决 | ✅ | 完成工单 |
| 指派工程师 | ✅ | 将工单分配给其他工程师 |

---

### 7️⃣ 管理员 (Administrator)

#### 可访问菜单
- ✅ 仪表盘
- ✅ 用户管理
- ✅ 产品批量导入
- ✅ 数据管理
- ✅ 系统报表
- ❌ 不访问业务菜单（项目、订单、生产等）

#### 系统管理权限
| 功能 | 权限 | 说明 |
|------|------|------|
| 用户管理 | ✅ | 创建、编辑、删除用户 |
| 角色分配 | ✅ | 分配用户角色 |
| 产品导入 | ✅ | 批量导入产品数据 |
| 数据备份 | ✅ | 系统数据备份 |
| 查看报表 | ✅ | 系统统计报表 |

#### 限制说明
- ⚠️ 管理员不参与具体业务操作
- ⚠️ 不访问项目、订单、生产等业务模块
- ⚠️ 专注于系统管理和维护

---

## 🔐 核心权限原则

### 1. 技术不涉价
- 技术工程师完全不接触价格信息
- 不能访问产品数据库（含价格）
- 不能查看报价单

### 2. 询价≠赢单
- "已报价-询价中"状态：只是给客户报价，未签约
- "合同已签订-赢单"状态：客户盖章完成，正式赢单
- 不能手动标记赢单，必须走合同流程

### 3. 预付款启动生产
- 预付款未到账：不能创建生产订单
- 预付款到账：商务确认后通知生产
- 生产员才能开始BOM拆分和排期

### 4. 角色职责边界
- 销售：客户关系、项目跟进、合同
- 技术：技术选型、参数配置
- 商务：报价、合同审核、预付款
- 生产：BOM拆分、生产排期、采购协调

### 5. 只读 vs 可编辑
- 销售可查看技术清单（只读）
- 销售可查看报价（只读）
- 技术不能查看价格（完全隐藏）
- 生产可查看技术清单（只读）

---

## 📝 项目详情页面按钮权限

### 根据项目状态和用户角色显示不同按钮

#### 状态：待指派技术
- **销售经理**：显示"指派技术工程师"按钮
- **商务专员**：显示"指派技术工程师"按钮（协助）
- **其他角色**：无按钮

#### 状态：选型中
- **技术工程师**：显示"提交技术选型"按钮
- **其他角色**：无按钮

#### 状态：待商务报价
- **商务专员**：显示"设置报价"按钮
- **其他角色**：无按钮

#### 状态：已报价-询价中
- **销售经理**：显示"下载报价单"、"上传销售合同"按钮
- **商务专员**：显示"修改报价"按钮
- **其他角色**：无按钮

#### 状态：待商务审核合同
- **商务专员**：显示"审核通过并上传盖章合同"按钮
- **销售经理**：显示"查看合同"（只读）
- **其他角色**：无按钮

#### 状态：待客户盖章
- **销售经理**：显示"下载盖章合同"、"上传客户盖章合同"按钮
- **其他角色**：无按钮

#### 状态：合同已签订-赢单
- **商务专员**：显示"等待预付款"提示
- **其他角色**：显示"赢单"标签

#### 状态：待预付款
- **商务专员**：显示"确认预付款到账"按钮
- **销售经理**：显示"催收预付款"提示
- **其他角色**：无按钮

#### 状态：生产准备中 / 采购中 / 生产中
- **生产员**：显示生产管理相关按钮
- **销售经理**：显示"查看生产进度"（只读）
- **其他角色**：无按钮

---

## ✅ 检查清单

在实施角色权限时，请确保：

- [ ] 技术工程师无法查看任何价格信息
- [ ] 销售经理不能修改技术选型
- [ ] 销售经理不能修改报价
- [ ] "赢单"状态必须通过合同签订流程触发
- [ ] 预付款未到账不能创建生产订单
- [ ] 生产员不能查看价格信息
- [ ] 管理员不干预具体业务流程
- [ ] 每个角色只能看到自己职责范围内的菜单
- [ ] 项目详情页按钮根据状态和角色动态显示

---

**文档版本**：v2.0  
**更新日期**：2025年10月30日  
**维护团队**：智能制造系统开发组

