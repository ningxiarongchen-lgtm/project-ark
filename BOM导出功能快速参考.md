# BOM导出功能快速参考

## 🚀 快速开始

### 导出Excel
```
1. 点击 [导出BOM ▼] 按钮
2. 选择 "导出为Excel"
3. 文件自动下载
```

### 导出PDF
```
1. 点击 [导出BOM ▼] 按钮
2. 选择 "导出为PDF"
3. 文件自动下载
```

---

## 📊 导出格式

### Excel格式 (.xlsx)
```
✅ 可编辑
✅ 支持数据分析
✅ 包含统计行
✅ 自动设置列宽
```

**导出内容:**
- 序号
- 执行器型号
- 数量
- 单价 (¥)
- 总价 (¥)
- 覆盖位号
- 备注
- 合计行（自动计算）

**文件名示例:**
```
BOM清单_P2024001_20251027_143022.xlsx
```

### PDF格式 (.pdf)
```
✅ 专业排版
✅ 打印友好
✅ 包含项目信息
✅ 自动分页
```

**导出内容:**
- 标题: "BOM清单 / Bill of Materials"
- 项目信息（项目编号、名称、客户、时间）
- BOM表格
- 合计行（特殊样式）
- 页码

**文件名示例:**
```
BOM清单_P2024001_20251027_143022.pdf
```

---

## 🎯 数据源

**明确使用当前BOM表格数据:**
- ✅ 导出的是**当前表格**中显示的所有数据
- ✅ 包括手动添加的行
- ✅ 包括自动生成的行
- ✅ 实时反映最新编辑

**不包括:**
- ❌ 已删除的行
- ❌ 后端保存的旧数据（除非已加载到表格）

---

## 💡 使用场景

### 导出Excel - 适合
- 📊 需要进一步数据分析
- ✏️ 需要二次编辑
- 🔄 需要导入其他系统
- 👥 团队内部协作

### 导出PDF - 适合
- 📄 提交给客户
- 🗂️ 正式存档
- 🖨️ 打印纸质文档
- 📧 邮件发送

---

## ⚙️ 按钮位置

```
功能按钮区:
[从选型自动生成] [手动添加行] [保存BOM] [📥导出BOM▼] [生成报价单PDF] [清空BOM]
                                        ↑
                                   导出按钮
```

**下拉菜单:**
```
┌─────────────────┐
│ 📥 导出BOM ▼    │ ← 点击展开
└─────────────────┘
     ↓
┌─────────────────┐
│ 📊 导出为Excel  │
├─────────────────┤
│ 📄 导出为PDF    │
└─────────────────┘
```

---

## ✅ 导出步骤

### 完整流程

```
1. 生成或编辑BOM数据
   ↓
2. 确认数据准确
   ↓
3. 点击"导出BOM"按钮
   ↓
4. 选择导出格式
   - Excel: 用于编辑和分析
   - PDF: 用于存档和打印
   ↓
5. 等待自动下载
   ↓
6. 查看成功提示
   ↓
7. 打开下载的文件
```

---

## 🔍 导出内容示例

### Excel示例数据

| 序号 | 执行器型号 | 数量 | 单价(¥) | 总价(¥) | 覆盖位号 | 备注 |
|------|------------|------|---------|---------|----------|------|
| 1    | SF050-DA   | 3    | 5,280   | 15,840  | V-001, V-002, V-003 | - |
| 2    | SF075-DA   | 2    | 6,800   | 13,600  | V-004, V-005 | - |
|      | **合计**   | **5** |         | **29,440** |          |      |

### PDF示例内容

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  BOM清单 / Bill of Materials

  项目编号: P2024001
  项目名称: XX工业园区阀门控制系统
  客户: ABC集团
  生成时间: 2025-10-27 14:30:22
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

┌────┬───────────┬─────┬──────┬──────┬──────────┬──────┐
│No. │ Model     │ Qty │ Unit │Total │ Tags     │Notes │
│    │           │     │Price │Price │          │      │
├────┼───────────┼─────┼──────┼──────┼──────────┼──────┤
│ 1  │ SF050-DA  │ 3   │¥5,280│¥15,840│V-001...│  -   │
│ 2  │ SF075-DA  │ 2   │¥6,800│¥13,600│V-004...│  -   │
├────┼───────────┼─────┼──────┼──────┼──────────┼──────┤
│    │合计/Total │ 5   │      │¥29,440│         │      │
└────┴───────────┴─────┴──────┴──────┴──────────┴──────┘

                                          Page 1 of 1
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## ⚠️ 注意事项

### 导出前
- ✅ 确认BOM数据已正确生成或编辑
- ✅ 保存重要修改（点击"保存BOM"）
- ✅ 检查统计数据是否正确

### 导出时
- ⏳ 等待下载完成（通常<1秒）
- 📁 文件保存在浏览器默认下载文件夹
- 🔔 注意成功提示消息

### 导出后
- 📂 及时整理下载的文件
- 🔍 打开文件验证内容
- 💾 重要文件建议备份

---

## 🔔 提示消息

### 成功 ✅
```
"Excel文件已导出: BOM清单_P2024001_20251027_143022.xlsx"
"PDF文件已导出: BOM清单_P2024001_20251027_143022.pdf"
```

### 警告 ⚠️
```
"BOM清单为空，无法导出"
```

### 错误 ❌
```
"导出Excel失败: [错误信息]"
"导出PDF失败: [错误信息]"
```

---

## 🎨 文件特性

### Excel文件特性
- **格式:** .xlsx
- **工作表:** BOM清单
- **列宽:** 自动优化
- **数据行:** BOM数据 + 统计行
- **公式:** 无（纯数据）

### PDF文件特性
- **格式:** PDF/A（适合存档）
- **页面:** A4竖向
- **字体:** Helvetica
- **表头:** 蓝色背景
- **统计行:** 灰色背景，粗体
- **页码:** 显示在底部

---

## 🆚 格式对比

| 特性 | Excel | PDF |
|------|-------|-----|
| **可编辑性** | ✅ 可编辑 | ❌ 只读 |
| **数据分析** | ✅ 支持 | ❌ 不支持 |
| **打印效果** | ⚠️ 需调整 | ✅ 完美 |
| **文件大小** | 较小 | 较大 |
| **兼容性** | 需Excel软件 | 任何设备 |
| **安全性** | ⚠️ 易修改 | ✅ 不可改 |

---

## 💼 实际应用

### 场景1: 内部审核
```
目标: 财务审核BOM成本
推荐: 导出Excel
理由: 
- 可以添加审核备注
- 可以计算总成本
- 可以筛选和排序
```

### 场景2: 客户报价
```
目标: 向客户提供正式报价
推荐: 导出PDF
理由:
- 格式专业美观
- 客户无法修改
- 打印效果好
```

### 场景3: 采购下单
```
目标: 提交给采购部门
推荐: 导出Excel
理由:
- 采购可能需要调整
- 需要关联供应商信息
- 便于数据处理
```

### 场景4: 项目存档
```
目标: 长期保存项目文档
推荐: 导出PDF
理由:
- 格式稳定不变
- 长期可读性好
- 符合存档标准
```

---

## 📱 快捷操作

### 键盘快捷键（建议）
- `Ctrl + E` - 导出Excel（待实现）
- `Ctrl + P` - 导出PDF（待实现）
- `Ctrl + D` - 打开导出菜单（待实现）

### 鼠标操作
- 单击"导出BOM" - 显示下拉菜单
- 选择"导出为Excel" - 立即导出Excel
- 选择"导出为PDF" - 立即导出PDF

---

## 🔧 故障排除

### Q: 点击导出后没有反应？
**A:** 检查：
- BOM数据是否为空
- 浏览器是否阻止下载
- 控制台是否有错误

### Q: 导出的文件在哪里？
**A:** 
- 默认在浏览器下载文件夹
- Windows: `C:\Users\用户名\Downloads`
- Mac: `~/Downloads`

### Q: Excel文件无法打开？
**A:** 
- 确保已安装Microsoft Excel或WPS
- 尝试用在线工具打开（Google Sheets）

### Q: PDF文件显示乱码？
**A:** 
- 更新PDF阅读器到最新版本
- 使用Adobe Reader打开

### Q: 导出的数据不完整？
**A:** 
- 确认BOM表格中有完整数据
- 检查是否有编辑中的行
- 尝试刷新页面重新导出

---

## 📚 相关功能

### 配合使用
1. **从选型自动生成** → 生成BOM数据
2. **手动编辑** → 调整BOM内容
3. **保存BOM** → 保存到数据库
4. **导出BOM** → 导出为Excel/PDF
5. **生成报价单PDF** → 完整报价文档

### 工作流程
```
选型 → 优化 → 编辑 → 保存 → 导出 → 分享
```

---

**快速帮助:** 如有问题，请查看详细文档 `BOM导出功能完成报告.md`

