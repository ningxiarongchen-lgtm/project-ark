# 🎯 生产环境 - 开始使用真实数据

**目标**: 清理所有测试数据，只保留管理员账号，准备创建真实用户和数据

---

## ⚡ 快速执行（推荐）

### 在 Render Shell 中执行

1. **访问 Render Dashboard**
   ```
   https://dashboard.render.com
   ```

2. **进入服务** → 选择您的后端服务（项目方舟）

3. **点击 "Shell" 标签**

4. **运行初始化命令**：
   ```bash
   npm run init:production
   ```

5. **按照提示操作**：
   - 输入 `YES` 确认清理数据库
   - 检查现有管理员账号
   - 选择是否重置管理员密码

---

## 📋 脚本会做什么？

### ✅ 清理操作
```
✓ 删除所有测试用户（保留管理员）
✓ 清空所有项目数据
✓ 清空所有订单数据
✓ 清空所有产品数据
✓ 清空所有供应商数据
✓ 清空所有质检记录
✓ 清空所有物流配送记录
✓ 清空所有合同数据
```

### 🔐 保留管理员
```
✓ 保留现有管理员账号
✓ 可选：重置管理员密码为 admin123
✓ 设置首次登录强制修改密码
```

---

## 🎯 执行后的结果

### 数据库状态
```
管理员账号: 1 个
其他用户: 0 个
产品数据: 0 个
供应商: 0 家
项目: 0 个
```

### 管理员登录信息
```
手机号: [您现有的管理员手机号]
密码: admin123（如果选择重置）
状态: 激活
```

⚠️ **首次登录会强制要求修改密码**

---

## 📝 下一步操作清单

### 1️⃣ 登录系统
```
✓ 使用管理员账号登录
✓ 首次登录修改密码
✓ 确认登录成功
```

### 2️⃣ 创建员工账号
访问 **用户管理** 模块：
```
✓ 创建销售经理账号
✓ 创建技术工程师账号
✓ 创建商务工程师账号
✓ 创建采购专员账号
✓ 创建生产计划员账号
✓ 创建质检员账号
✓ 创建物流专员账号
✓ 创建车间工人账号
```

### 3️⃣ 导入产品数据
访问 **产品批量导入** 功能：
```
✓ 准备产品Excel文件
✓ 上传并导入产品数据
✓ 验证导入结果
```

### 4️⃣ 创建供应商
访问 **数据管理** 模块：
```
✓ 创建供应商信息
✓ 设置供应商联系人
✓ 配置供应商产品清单
```

### 5️⃣ 开始业务流程
```
✓ 创建第一个真实项目
✓ 进行产品选型
✓ 生成销售订单
✓ 开始正常业务流程
```

---

## ⚠️ 重要注意事项

### 🚨 数据将被永久删除
```
此脚本会：
✗ 删除所有测试数据
✗ 清空所有业务记录
✗ 移除所有非管理员用户

此操作不可逆！
```

### ✅ 适用场景
```
✓ 生产环境首次启用
✓ 从测试环境切换到生产
✓ 需要全新开始
```

### ❌ 不适用场景
```
✗ 已有真实业务数据
✗ 正在运行中的生产系统
✗ 需要保留历史记录
```

---

## 🔧 故障排除

### 如果命令失败

**数据库连接失败**
```
检查 Render 环境变量:
- MONGODB_URI 是否正确配置
- MongoDB 服务是否正常运行
```

**权限不足**
```
确保：
- 数据库用户有删除权限
- Render 服务有足够权限
```

**超时问题**
```
如果清理数据量大：
- 可能需要等待更长时间
- Render 免费服务有时间限制
```

---

## 📊 验证初始化成功

### 检查清单

1. **登录测试**
   ```
   ✓ 管理员可以正常登录
   ✓ 首次登录强制修改密码
   ✓ 修改密码后可以重新登录
   ```

2. **数据验证**
   ```
   ✓ 用户列表只有1个管理员
   ✓ 产品目录为空
   ✓ 项目列表为空
   ✓ 订单列表为空
   ```

3. **功能测试**
   ```
   ✓ 可以创建新用户
   ✓ 可以导入产品
   ✓ 可以创建项目
   ✓ 各模块正常访问
   ```

---

## 🎉 成功标志

运行完成后会看到：

```
╔═══════════════════════════════════════════════════════════════╗
║  生产环境初始化完成                                          ║
╚═══════════════════════════════════════════════════════════════╝

📊 当前数据库状态：

   管理员账号数: 1
   用户总数: 1
   产品数据: 0 个（等待导入）
   供应商: 0 家（等待创建）
   项目: 0 个（等待创建）

📋 下一步操作：

   1. 使用管理员账号登录系统
   2. 首次登录强制修改密码
   3. 访问"用户管理"创建员工账号
   4. 访问"产品批量导入"导入产品数据
   5. 访问"数据管理"创建供应商
   6. 开始正常业务流程

✨ 系统已准备就绪，可以开始使用！
```

---

## 🔗 相关文档

- **用户管理指南**: `管理员使用指南.md`
- **产品导入指南**: `如何添加备件数据-快速指南.md`
- **系统功能说明**: `📖-从这里开始.md`

---

## 📞 需要帮助？

如果遇到问题：
1. 检查 Render 的 Logs 标签页
2. 查看 Shell 中的错误信息
3. 确认环境变量配置正确

---

**🚀 现在就去 Render Shell 运行命令开始吧！**

```bash
npm run init:production
```

