# BOM清单功能快速参考

## 🚀 快速开始

### 访问BOM清单
1. 进入项目详情页面
2. 点击"BOM清单"标签

### 从选型自动生成（推荐）
```
点击 [从选型自动生成] 按钮
  ↓
系统自动优化选型数据
  ↓
生成优化后的BOM清单
  ↓
显示在可编辑表格中
```

---

## 🎯 核心功能

### 1. 从选型自动生成 ⭐
- **按钮:** 渐变紫色"从选型自动生成"
- **功能:** 调用 `optimizeProjectSelection` 算法
- **数据:** 使用真实SF系列执行器数据
- **结果:** 自动合并相同型号，计算总价

**示例:**
```
输入: 10个选型（可能有重复型号）
输出: 5个优化后的BOM条目
节省: 简化采购，降低成本
```

### 2. 手动添加行
- **按钮:** "手动添加行"
- **操作:** 点击后自动添加新行并进入编辑状态
- **字段:** 型号、数量、单价、备注

### 3. 编辑/删除
- **编辑:** 点击"编辑"按钮
- **保存:** 点击绿色✓图标
- **取消:** 点击红色✗图标
- **删除:** 点击"删除"按钮（需确认）

### 4. 保存到后端
- **按钮:** "保存BOM"
- **功能:** 将BOM数据保存到项目中
- **要求:** 没有正在编辑的行

### 5. 生成PDF
- **按钮:** "生成报价单PDF"
- **功能:** 导出BOM为PDF报价单

---

## 📊 表格字段说明

| 字段 | 可编辑 | 必填 | 说明 |
|------|--------|------|------|
| 序号 | ❌ | - | 自动编号 |
| 执行器型号 | ✅ | ✅ | 例如: SF050-DA |
| 数量 | ✅ | ✅ | 整数，最小值1 |
| 单价 (¥) | ✅ | ✅ | 保留2位小数 |
| 总价 (¥) | ❌ | - | 自动计算 |
| 覆盖位号 | ❌ | - | 显示关联位号 |
| 备注 | ✅ | ❌ | 可选 |
| 操作 | - | - | 编辑/删除按钮 |

---

## ⚡ 操作流程

### 标准流程（自动生成）
```
1. 在"选型明细"中添加选型
2. 切换到"BOM清单"标签
3. 点击"从选型自动生成"
4. 查看并确认BOM数据
5. 点击"保存BOM"
6. 点击"生成报价单PDF"
```

### 手动编辑流程
```
1. 点击"手动添加行"或"编辑"
2. 填写/修改数据
3. 点击"保存"（✓）
4. 重复编辑其他行
5. 点击"保存BOM"
```

---

## 💡 使用技巧

### 优化算法自动做什么？
1. ✅ 合并相同型号
2. ✅ 累加数量
3. ✅ 计算总价（使用真实价格）
4. ✅ 追踪覆盖的位号
5. ✅ 按型号排序

### 什么时候手动添加？
- 需要特殊型号（未在选型中）
- 需要备用件
- 需要工具或配件
- 临时调整数量

### 编辑注意事项
- 一次只能编辑一行
- 编辑时总价自动计算
- 必填项不能为空
- 数量必须大于0

---

## 🎨 视觉提示

### 按钮颜色
- **紫色渐变:** 从选型自动生成（主要功能）
- **蓝色:** 保存BOM（重要操作）
- **灰色:** 手动添加行（辅助功能）
- **红色:** 删除/清空（危险操作）

### 行状态
- **正常:** 白色背景
- **编辑中:** 蓝色背景高亮
- **悬停:** 浅灰色背景

### Tab徽章
```
[BOM清单 (5)]
         ↑
    显示条目数
```

---

## 🔔 提示信息

### 成功 ✅
- "成功生成BOM清单！原10个选型优化为5个型号"
- "保存成功"
- "BOM清单已保存到项目中！"

### 警告 ⚠️
- "当前项目没有选型数据，无法生成BOM清单"
- "请先保存或取消当前编辑的行"

### 错误 ❌
- "生成BOM失败: [错误信息]"
- "请检查输入是否正确"

---

## 📱 快捷操作

### 键盘快捷键（建议）
- `Enter` - 保存编辑
- `Esc` - 取消编辑
- `Ctrl+S` - 保存BOM（待实现）

### 鼠标操作
- 点击"编辑" - 进入编辑模式
- 点击✓ - 保存编辑
- 点击✗ - 取消编辑
- 点击"删除" - 删除行（需确认）

---

## 🔧 常见问题

### Q: 为什么"从选型自动生成"按钮是灰色的？
**A:** 项目中没有选型数据。请先在"选型明细"标签添加选型。

### Q: 为什么"保存BOM"按钮被禁用？
**A:** 可能原因：
- BOM数据为空
- 有行正在编辑中（请先保存或取消）

### Q: 如何修改已保存的BOM？
**A:** 
1. BOM数据会自动加载到表格
2. 点击"编辑"修改
3. 修改完成后点击"保存BOM"

### Q: 自动生成会覆盖现有BOM吗？
**A:** 是的，会替换当前表格中的所有数据。建议先保存当前数据。

### Q: 总价如何计算？
**A:** 总价 = 数量 × 单价（自动计算，不可手动编辑）

---

## 📈 优化效果示例

### 优化前（选型明细）
```
V-001: SF050-DA  价格: ¥5,280
V-002: SF050-DA  价格: ¥5,280
V-003: SF050-DA  价格: ¥5,280
V-004: SF075-DA  价格: ¥6,800
V-005: SF075-DA  价格: ¥6,800
----------------------------------
总计: 5条选型  ¥30,240
```

### 优化后（BOM清单）
```
SF050-DA  数量: 3  单价: ¥5,280  总价: ¥15,840
SF075-DA  数量: 2  单价: ¥6,800  总价: ¥13,600
--------------------------------------------------
总计: 2个型号  5台  ¥29,520
```

**优化效果:**
- 型号数: 5 → 2 (减少60%)
- 采购简化
- 管理便捷

---

## 🎯 最佳实践

### 推荐工作流
1. ✅ 先完成所有选型
2. ✅ 使用"从选型自动生成"
3. ✅ 检查优化结果
4. ✅ 手动调整（如需要）
5. ✅ 保存BOM
6. ✅ 生成PDF报价单

### 数据准确性
- 自动生成使用真实价格数据
- 手动添加请确认价格准确
- 定期更新价格库

### 备份建议
- 重要BOM先保存到后端
- 定期导出PDF备份
- 重大修改前先保存

---

**快速帮助:** 如有问题，请查看详细文档 `BOM清单管理功能完成报告.md`

