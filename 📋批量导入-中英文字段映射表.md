# 📋 批量导入 - 中英文字段映射表

## ✅ 所有数据模型均支持中英文列名上传

系统已全面支持中英文混合的Excel/CSV文件上传，您可以使用中文或英文列名。

---

## 📊 支持的数据模型

### 1️⃣ 供应商管理 (Supplier)

| 中文列名 | 英文列名 | 说明 | 必填 |
|---------|---------|------|------|
| 供应商名称 / 名称 | name | 供应商名称 | ✅ |
| 联系人 | contact_person | 联系人姓名 | ❌ |
| 电话 / 手机 / 联系电话 | phone | 联系电话 | ❌ |
| 地址 | address | 详细地址 | ❌ |
| 经营范围 / 业务范围 / 范围 | business_scope | 业务范围 | ❌ |
| 评级 / 评级(1-5) | rating | 评级（1-5） | ❌ |
| 认证状态 / 认证 | certification_status | Certified/Pending/Not Certified | ❌ |
| 累计交易额 / 交易额 | total_transaction_value | 累计交易金额 | ❌ |
| 准时交付率 / 交付率 | on_time_delivery_rate | 准时交付率（0-100） | ❌ |
| 备注 / 说明 / NOTES | notes | 备注信息 | ❌ |
| 状态 | status | active/inactive/blacklisted | ❌ |

**示例Excel表格（中文）：**
```
供应商名称 | 联系人 | 电话 | 地址 | 经营范围 | 评级 | 认证状态 | 累计交易额 | 准时交付率 | 状态
```

**示例Excel表格（英文）：**
```
name | contact_person | phone | address | business_scope | rating | certification_status | total_transaction_value | on_time_delivery_rate | status
```

---

### 2️⃣ 执行器管理 (Actuator)

| 中文列名 | 英文列名 | 说明 | 必填 |
|---------|---------|------|------|
| 基础型号 / 型号 | model_base | 执行器型号（如AT-SR52K8） | ✅ |
| 系列 | series | SF/AT/GY | ❌ |
| 机构类型 / 机构 | mechanism | 机构类型 | ❌ |
| 阀门类型 / 阀门 | valve_type | Ball Valve/Butterfly Valve/Gate Valve等 | ❌ |
| 本体尺寸 / 尺寸 | body_size | 本体尺寸代码 | ❌ |
| 气缸尺寸 | cylinder_size | 气缸尺寸（SF系列） | ❌ |
| 作用类型 / 作用 | action_type | DA/SR | ✅ |
| 弹簧范围 | spring_range | K8/K10等（SR类型） | ❌ |
| 输出扭矩 / 扭矩 | output_torque | 输出扭矩（N·m） | ❌ |
| 最大扭矩 | max_output_torque | 最大输出扭矩（N·m） | ❌ |
| 输入压力 / 压力 / 气源压力 | input_pressure 或 air_pressure | 工作压力（bar） | ❌ |
| 回转角度 / 角度 | rotation_angle | 回转角度（度） | ❌ |
| 工作温度范围 / 温度范围 | temperature_range | 温度范围 | ❌ |
| 重量 | weight | 重量（kg） | ❌ |
| 连接方式 / 连接类型 | connection_type | 连接方式 | ❌ |
| 连接尺寸 | connection_size | 连接尺寸 | ❌ |
| 失气位置 / 故障安全位置 | fail_safe_position | Open/Close/Hold | ❌ |
| 常温标准价 / 常温价格 / 标准价格 / 价格 | base_price_normal | 常温价格（元） | ❌ |
| 低温标准价 / 低温价格 | base_price_low | 低温价格（元） | ❌ |
| 高温标准价 / 高温价格 | base_price_high | 高温价格（元） | ❌ |

**示例Excel表格（中文）：**
```
型号 | 系列 | 阀门类型 | 作用类型 | 输出扭矩 | 常温价格
AT-SR52K8 | AT | Ball Valve | SR | 52 | 2500
```

**示例Excel表格（英文）：**
```
model_base | series | valve_type | action_type | output_torque | base_price_normal
AT-SR52K8 | AT | Ball Valve | SR | 52 | 2500
```

---

### 3️⃣ 配件管理 (Accessory)

| 中文列名 | 英文列名 | 说明 | 必填 |
|---------|---------|------|------|
| 配件名称 / 名称 | name | 配件名称 | ✅ |
| 配件类别 / 类别 | category | 控制类/连接与传动类/安全与保护类等 | ✅ |
| 规格 | specifications | 规格说明 | ❌ |
| 型号规格 | model_number | 型号 | ❌ |
| 制造商 / 厂家 | manufacturer | 制造商名称 | ❌ |
| 描述 | description | 详细描述 | ❌ |
| 库存数量 | stock_info.quantity | 库存数量 | ❌ |
| 是否可用 | stock_info.available | true/false | ❌ |
| 交货时间 | stock_info.lead_time | 交货时间 | ❌ |
| 常温标准价 / 价格 | base_price_normal | 价格（元） | ❌ |
| 低温标准价 | base_price_low | 低温价格（元） | ❌ |
| 高温标准价 | base_price_high | 高温价格（元） | ❌ |
| 是否激活 | is_active | true/false | ❌ |

**示例Excel表格（中文）：**
```
配件名称 | 类别 | 型号规格 | 制造商 | 价格
电磁阀 | 控制类 | SV-200 | 品牌A | 500
```

---

### 4️⃣ 用户管理 (User)

| 中文列名 | 英文列名 | 说明 | 必填 |
|---------|---------|------|------|
| 姓名 / 全名 | full_name | 用户姓名 | ✅ |
| 电话 / 手机 | phone | 11位手机号 | ✅ |
| 英文名 | english_name | 英文名称 | ❌ |
| 个性签名 / 签名 | signature | 个性签名 | ❌ |
| 密码 | password | 初始密码（至少6位） | ✅ |
| 角色 | role | Administrator/Sales Manager等 | ✅ |
| 部门 | department | 所属部门 | ❌ |
| 是否激活 / 激活状态 | isActive | true/false | ❌ |

**支持的角色值：**
- Administrator（管理员）
- Sales Manager（销售经理）
- Technical Engineer（技术工程师）
- Business Engineer（商务工程师）
- Procurement Specialist（采购专员）
- Production Planner（生产计划员）
- QA Inspector（质检员）
- Logistics Specialist（物流专员）
- Shop Floor Worker（车间工人）

**示例Excel表格（中文）：**
```
姓名 | 手机 | 角色 | 部门 | 密码
张三 | 13800138000 | Technical Engineer | 技术部 | pass123
```

---

## 🔄 智能字段映射规则

### 1. 自动映射优先级

1. **精确匹配**：优先使用预定义的中文映射
2. **备选名称**：支持同一字段的多个中文名称
3. **自动清理**：如果没有预定义映射，自动清理字段名

### 2. 支持的字段名变体

以"电话"字段为例：
- ✅ 电话
- ✅ 手机
- ✅ 联系电话
- ✅ phone

以"名称"字段为例：
- ✅ 供应商名称
- ✅ 配件名称
- ✅ 名称
- ✅ name

### 3. 数据类型自动转换

- **数字**：自动转换为数字类型（价格、评级、数量等）
- **布尔值**：true/false 自动转换
- **空值**：空字符串、"N/A"、"null" 转换为 null
- **电话号码**：保留为字符串（不转换为数字）

---

## 💡 使用建议

### ✅ 推荐做法

1. **使用中文列名**：更直观，减少错误
2. **保持一致性**：在同一文件中使用统一的语言
3. **参考模板**：下载系统提供的模板进行编辑
4. **检查必填项**：确保必填字段有值

### ⚠️ 注意事项

1. **列名不要有空格**：虽然系统会自动清理，但最好避免
2. **数据格式要正确**：
   - 评级：1-5之间的数字
   - 电话：11位数字
   - 价格：正数
   - 准时交付率：0-100之间的数字

3. **状态值要准确**：
   - 供应商状态：active/inactive/blacklisted
   - 认证状态：Certified/Pending/Not Certified

---

## 📖 导入步骤

### 第1步：准备数据文件

- 支持格式：Excel (.xlsx, .xls) 或 CSV (.csv)
- 可使用中文或英文列名
- 确保必填字段有值

### 第2步：上传文件

1. 进入对应的数据管理页面
2. 点击"上传文件"按钮
3. 选择准备好的文件
4. 点击确认上传

### 第3步：查看结果

- ✅ 成功导入的数量
- ❌ 失败的记录和错误原因
- 📊 数据统计更新

---

## 🔧 常见问题

### Q1: 我的Excel用的是中文列名，能上传吗？

**A:** 可以！系统完全支持中文列名，如"供应商名称"、"联系人"、"电话"等。

### Q2: 如果列名既不是预定义的中文也不是英文怎么办？

**A:** 系统会尝试自动清理字段名。建议使用参考表中的列名以确保准确映射。

### Q3: 可以混用中英文列名吗？

**A:** 可以，系统会智能识别每个列名。但建议在同一文件中使用统一的语言。

### Q4: 上传显示"成功 0 条"是什么原因？

**A:** 可能原因：
1. 列名无法识别（使用参考表中的列名）
2. 必填字段缺失
3. 数据格式不正确

### Q5: 数字字段（如电话）被错误转换怎么办？

**A:** 系统已优化：
- 电话号码始终保持为字符串
- 以0开头的数字保持为字符串
- 其他数字字段会自动转换

---

## 🎯 快速测试

### 测试供应商导入

创建一个Excel文件，包含以下列：

```
供应商名称 | 联系人 | 电话 | 评级 | 状态
测试供应商1 | 张三 | 13800138000 | 4 | active
测试供应商2 | 李四 | 13900139000 | 5 | active
```

上传后应该显示：**成功导入 2 条**

---

## ✅ 完成！

现在所有的数据管理模块都支持中英文列名上传了：

- ✅ 供应商管理
- ✅ 执行器管理  
- ✅ 配件管理
- ✅ 用户管理

**如有任何问题，请参考此文档或联系技术支持。** 🚀

