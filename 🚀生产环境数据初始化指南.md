# 🚀 生产环境数据初始化指南

## ⚠️ 重要提示

### 🎯 如果要开始使用真实数据
**请阅读**: `🎯生产环境-开始使用真实数据.md`  
**执行命令**: `npm run init:production`  
**结果**: 只保留管理员账号，清空所有测试数据

### 📝 如果要创建测试数据（继续阅读本文档）
**执行命令**: `npm run seed:final`  
**结果**: 创建完整的测试数据（10个角色、示例项目、订单等）

---

**问题**: 质检管理、物流配送等模块返回 500 错误，没有数据  
**原因**: 生产环境数据库是空的  
**解决**: 运行数据库种子脚本

---

## ⚡ 快速解决（在 Render 执行）

### 方法 1: Render Shell（推荐）

1. **访问 Render Dashboard**  
   https://dashboard.render.com

2. **进入服务** → 项目方舟

3. **点击 "Shell" 标签**

4. **运行命令**：
```bash
npm run seed:final
```

5. **等待完成**（2-5 分钟）

---

## 📊 将会创建的数据

### 用户账号
```
✅ 10个角色的测试账号
- 管理员、销售经理、技术工程师
- 商务工程师、采购专员、生产计划员
- 质检员、物流专员、车间工人
```

### 产品数据
```
✅ 完整的产品目录
- 执行器产品
- 配件产品
- 产品规格和价格
```

### 业务数据
```
✅ 示例项目
✅ 销售订单
✅ 生产订单
✅ 采购订单
✅ 质检记录
✅ 物流配送任务
✅ 工作中心数据
```

---

## 🔍 验证数据是否成功

### 检查各个模块

运行完成后，刷新页面检查：

1. **产品目录**  
   - 应该显示多个产品
   - 不再是 0 个

2. **质检管理**  
   - 应该有质检记录
   - 不再返回 500 错误

3. **物流配送**  
   - 应该有配送任务
   - 不再返回 500 错误

4. **用户管理**  
   - 10 个测试账号
   - 包含所有角色

---

## 📝 完整的测试账号列表

运行完成后，可以使用这些账号测试：

```
管理员：13000000001 / password
销售经理：13000000002 / password
技术工程师：13000000003 / password
商务工程师：13000000004 / password
采购专员：13000000005 / password
生产计划员：13000000006 / password
质检员：13000000007 / password
物流专员：13000000008 / password
车间工人：13000000009 / password
```

---

## ⚠️ 注意事项

### 数据会被清空

**⚠️ 警告**: 运行 `seed:final` 会：
- 清空现有所有数据
- 重新创建测试数据

**如果有重要数据**：
- 先备份数据库
- 或不要运行此脚本

### 仅用于测试环境

**建议**：
- ✅ 测试环境：可以随意运行
- ✅ 开发环境：可以运行
- ⚠️ 生产环境：谨慎使用（会清空数据）

---

## 🔧 故障排除

### 如果运行失败

**常见错误**：

1. **数据库连接失败**
```
Error: MongoDB connection failed
```
**解决**: 检查 MONGODB_URI 环境变量

2. **权限问题**
```
Error: Permission denied
```
**解决**: 确保有足够的权限访问数据库

3. **内存不足**
```
Error: Out of memory
```
**解决**: Render 免费服务内存有限，等待一段时间重试

---

## 📞 需要帮助？

### 查看日志

如果出错，检查：
1. **Shell 输出** - 查看具体错误信息
2. **Render Logs** - 查看服务日志
3. **Network 错误** - 浏览器开发者工具

### 常见问题

**Q: 需要多长时间？**  
A: 通常 2-5 分钟

**Q: 会影响现有用户登录吗？**  
A: 会！会重置所有用户账号

**Q: 可以只导入部分数据吗？**  
A: 脚本会导入完整数据集，不支持部分导入

---

## ✅ 成功标志

### 运行完成后应该看到

```bash
╔═══════════════════════════════════════════════╗
║  最终验收测试数据初始化完成                    ║
╚═══════════════════════════════════════════════╝

✅ 用户数据：10 个角色
✅ 产品数据：完整产品目录
✅ 业务数据：示例项目、订单、质检记录等

🎉 系统已准备就绪！
```

### 刷新页面验证

1. 清除浏览器缓存
2. 重新登录
3. 检查各个模块是否有数据
4. 不应再出现 500 错误

---

**🎯 现在就去 Render Shell 运行: `npm run seed:final`**


