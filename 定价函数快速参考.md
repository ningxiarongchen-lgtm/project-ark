# å®šä»·å‡½æ•°å¿«é€Ÿå‚è€ƒå¡ ğŸš€

## æ ¸å¿ƒå‡½æ•°

### calculatePrice(product, quantity)
è®¡ç®—äº§å“å•ä»·

```javascript
const { calculatePrice } = require('./utils/pricing');

// å›ºå®šä»·æ ¼
const sfProduct = { pricing_model: 'fixed', base_price: 1200 };
const price1 = calculatePrice(sfProduct, 5);  // è¿”å›: 1200

// é˜¶æ¢¯ä»·æ ¼
const atProduct = {
  pricing_model: 'tiered',
  base_price: 2500,
  price_tiers: [
    { min_quantity: 1, unit_price: 2500 },
    { min_quantity: 10, unit_price: 2300 },
    { min_quantity: 50, unit_price: 2100 }
  ]
};
const price2 = calculatePrice(atProduct, 15);  // è¿”å›: 2300
```

---

### getProductPriceInfo(product, quantity)
è·å–è¯¦ç»†ä»·æ ¼ä¿¡æ¯

```javascript
const { getProductPriceInfo } = require('./utils/pricing');

const priceInfo = getProductPriceInfo(atProduct, 15);
// è¿”å›: {
//   unit_price: 2300,
//   total_price: 34500,
//   applied_tier: { ... },
//   savings: { amount: 3000, rate: 8.0 },
//   next_tier: { ... }
// }
```

---

## å¿«é€Ÿä½¿ç”¨

### API è·¯ç”±
```javascript
router.get('/products/:id/price', async (req, res) => {
  const product = await Product.findById(req.params.id);
  const unitPrice = calculatePrice(product, req.query.quantity);
  res.json({ unit_price: unitPrice });
});
```

### é€‰å‹ç®—æ³•
```javascript
const unitPrice = calculatePrice(candidate, quantity);
const score = evaluateCandidate(candidate, unitPrice);
```

### æ‰¹é‡è®¡ç®—
```javascript
const items = [
  { product: product1, quantity: 5 },
  { product: product2, quantity: 10 }
];
const result = calculateBulkPrice(items);
```

---

## å®šä»·æ¨¡å¼

| æ¨¡å¼ | å€¼ | è¯´æ˜ |
|------|-----|------|
| å›ºå®šä»·æ ¼ | `'fixed'` | ä»·æ ¼ä¸å˜ |
| é˜¶æ¢¯ä»·æ ¼ | `'tiered'` | æ•°é‡è¶Šå¤šä»·æ ¼è¶Šä½ |

---

## è¿”å›å€¼

### calculatePrice
- **æ–°æ–¹å¼**: `Number` (å•ä»·)
- **æ—§æ–¹å¼**: `Object` (è¯¦ç»†ä¿¡æ¯)

### getProductPriceInfo
- **è¿”å›**: `Object` (åŒ…å«æ‰€æœ‰ä»·æ ¼ä¿¡æ¯)

---

## æµ‹è¯•å‘½ä»¤

```bash
cd backend
node test-pricing-upgrade.js
```

---

## æ–‡æ¡£

- ğŸ“– è¯¦ç»†æŒ‡å—: `å®šä»·å‡½æ•°å‡çº§ä½¿ç”¨æŒ‡å—.md`
- ğŸ“‹ å®ŒæˆæŠ¥å‘Š: `å®šä»·å‡½æ•°å‡çº§å®ŒæˆæŠ¥å‘Š.md`
- ğŸ§ª æµ‹è¯•è„šæœ¬: `backend/test-pricing-upgrade.js`

---

**ç‰ˆæœ¬**: v2.0.0  
**æ›´æ–°**: 2025-10-28

