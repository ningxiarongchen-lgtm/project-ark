# 📖 执行器批量导入功能 - 使用指南

## 一、功能概述

本系统提供了一个**简化、统一**的执行器数据批量导入功能，允许管理员通过一个标准化的Excel模板，一次性导入和更新SF、AT、GY三个系列的执行器产品数据。

### ✨ 主要特点

- **统一模板**：一个Excel文件包含所有三个系列的数据
- **全量替换**：导入时清空旧数据，避免数据冗余
- **严格校验**：提供详细的数据验证，确保数据质量
- **错误报告**：自动生成带错误说明的Excel文件，方便修正
- **简单易用**：四步完成导入，界面清晰明了

## 二、访问路径

1. 登录系统（管理员账号）
2. 进入 **数据管理** 页面
3. 选择 **执行器批量导入** 标签页

## 三、使用流程

### 步骤1: 下载模板

点击"下载执行器数据模板"按钮，系统会下载名为 `C-MAX_Actuator_Data_Template.xlsx` 的Excel文件。

### 步骤2: 填写数据

打开下载的Excel文件，你会看到4个工作表：

#### 📋 Instructions（说明页）
- 详细的使用说明和注意事项
- 请务必仔细阅读

#### 📊 SF_Data（SF系列数据）
包含10列：
- `Model` - 执行器型号（必填）
- `Type` - 动作类型：SR或DA（必填）
- `Price` - 核算底价（必填，数字）
- `Air_Pressure_bar` - 气源压力（必填，数字）
- `SST_Nm` - 弹簧启动扭矩（SR类型必填）
- `SET_Nm` - 弹簧结束扭矩（SR类型必填）
- `AST_Nm` - 气缸启动扭矩（SR类型必填）
- `AET_Nm` - 气缸结束扭矩（SR类型必填）
- `DA_Torque_0deg_Nm` - 双作用0°扭矩（DA类型必填）
- `DA_Torque_90deg_Nm` - 双作用90°扭矩（DA类型必填）

**重要规则：**
- Type=SR时：必须填写SST_Nm、SET_Nm、AST_Nm、AET_Nm，DA扭矩必须为空
- Type=DA时：必须填写DA_Torque_0deg_Nm、DA_Torque_90deg_Nm，SR扭矩必须为空

#### 📊 AT_Data（AT系列数据）
包含4列：
- `Model` - 执行器型号（必填）
- `Type` - 动作类型：SR或DA（必填）
- `Price` - 核算底价（必填，数字）
- `Output_Torque_Nm` - 输出扭矩（必填，数字）

**自动处理：**
- 系统会自动为AT系列添加材质属性："铝合金+硬质氧化"

#### 📊 GY_Data（GY系列数据）
包含4列（与AT_Data相同）：
- `Model` - 执行器型号（必填）
- `Type` - 动作类型：SR或DA（必填）
- `Price` - 核算底价（必填，数字）
- `Output_Torque_Nm` - 输出扭矩（必填，数字）

**自动处理：**
- 系统会自动为GY系列添加材质属性："不锈钢"

### 步骤3: 上传文件

1. 填写完成后，保存Excel文件
2. 在系统中点击"选择填写好的Excel文件"
3. 选择你刚才填写的文件
4. 系统会显示文件信息，确认无误后点击"确认并开始导入"

### 步骤4: 完成导入

- 如果数据全部通过校验，系统会显示导入成功的统计信息
- 如果有错误，系统会提供错误报告下载

## 四、数据校验规则

### 通用校验
- Model（型号）：不能为空
- Type（类型）：只能是"SR"或"DA"
- Price（价格）：不能为空，必须是有效数字，不能为负数

### SF系列专属校验
- Air_Pressure_bar：不能为空，必须是有效数字
- 当Type=SR时：
  - SST_Nm、SET_Nm、AST_Nm、AET_Nm 必须填写且为有效数字
  - DA_Torque_0deg_Nm、DA_Torque_90deg_Nm 必须为空
- 当Type=DA时：
  - DA_Torque_0deg_Nm、DA_Torque_90deg_Nm 必须填写且为有效数字
  - SST_Nm、SET_Nm、AST_Nm、AET_Nm 必须为空

### AT/GY系列专属校验
- Output_Torque_Nm：不能为空，必须是有效数字

## 五、错误处理

如果上传的文件存在错误，系统会：

1. **中断导入流程**：不会对数据库进行任何修改
2. **生成错误报告**：创建一个Excel文件副本
3. **标注错误位置**：在有错误的行添加"错误说明"列
4. **描述错误原因**：清晰说明每个错误的具体问题

### 如何修复错误

1. 下载错误报告
2. 查看"错误说明"列，了解每个错误的原因
3. 在原始文件中修正错误
4. 重新上传修正后的文件

## 六、重要提示

### ⚠️ 全量替换模式

本功能使用**全量替换**模式：
- 上传数据将**完全替换**现有数据库中的所有执行器数据
- 旧数据会被**永久删除**
- 请确保上传的Excel文件包含**所有需要保留**的产品信息

### ✅ 最佳实践

1. **先备份**：导入前，先导出现有数据作为备份
2. **仔细检查**：上传前，仔细检查Excel文件中的数据
3. **测试数据**：首次使用时，建议先用少量测试数据试验
4. **分批导入**：如果数据量很大，考虑分批导入并验证

### 📝 注意事项

1. **不要修改工作表名称**：SF_Data、AT_Data、GY_Data
2. **不要修改列标题**：Model、Type、Price等
3. **示例数据可以删除**：模板中的示例数据仅供参考
4. **文件大小限制**：最大10MB
5. **文件格式**：仅支持.xlsx和.xls格式

## 七、常见问题

### Q: 可以只更新某个系列的数据吗？
A: 不可以。本功能是全量替换模式，必须提供所有三个系列的完整数据。如果只想更新某个系列，请在模板中保留其他系列的现有数据。

### Q: 如果Type填错了会怎样？
A: 系统会在校验阶段检测到错误，并在错误报告中指出具体的问题位置。

### Q: 价格单位是什么？
A: 价格单位为人民币元（¥），直接填写数字即可，不需要添加货币符号。

### Q: 扭矩单位是什么？
A: 扭矩单位为牛·米（Nm），直接填写数字即可。

### Q: 导入失败后数据会丢失吗？
A: 不会。系统使用事务机制，如果导入过程中出现任何错误，所有操作都会回滚，数据库保持原状。

### Q: 可以在Excel中使用公式吗？
A: 可以，但上传时系统会读取计算后的值，而不是公式本身。

## 八、技术支持

如果在使用过程中遇到问题，请联系系统管理员或技术支持团队。

---

**更新日期**：2025-11-07  
**版本**：v1.0  
**适用系统**：C-MAX智能制造管理系统

