# Project Ark - 核心数据清单

> **版本**: v1.0  
> **更新日期**: 2025-10-30  
> **状态**: ✅ 已验证完整

## 📋 目录

1. [数据概览](#数据概览)
2. [执行器数据](#执行器数据)
3. [手动操作装置数据](#手动操作装置数据)
4. [配件数据](#配件数据)
5. [数据导入流程](#数据导入流程)
6. [数据验证](#数据验证)

---

## 数据概览

### 核心产品数据统计

| 类别 | 数量 | 数据源 | 状态 |
|------|------|--------|------|
| **AT/GY系列执行器** | 55个 | `at_gy_actuators_data_final.csv` | ✅ 完整 |
| **SF系列执行器** | 141个 | `sf_actuators_data.csv` | ✅ 完整 |
| **手动操作装置** | 18个 | `manual_overrides_data.csv` | ✅ 完整 |
| **配件** | 10个 | 程序内定义 | ✅ 完整 |
| **总计** | **224个产品** | - | ✅ 完整 |

### 辅助数据统计

| 类别 | 数量 | 状态 |
|------|------|------|
| 测试用户 | 10个 | ✅ 完整 |
| 供应商 | 5个 | ✅ 完整 |

---

## 执行器数据

### AT/GY系列执行器 (55个)

**数据源**: `backend/data_imports/at_gy_actuators_data_final.csv`

**字段映射**:
- `model_base` → 型号基础
- `series` → 系列 (AT/GY)
- `valve_type` → 阀门类型
- `action_type` → 作用类型 (SR/DA)
- `body_size` → 本体尺寸
- `max_output_torque` → 最大输出扭矩
- `operating_pressure` → 工作压力范围
- `base_price` → 基础价格

**数据特点**:
- 覆盖AT和GY两个系列
- 包含单作用(SR)和双作用(DA)型号
- 包含标准温度和低温型号
- 完整的技术参数和价格信息

**样本数据**:
```
AT-AT-SR52K8 (SR) - 已发布
AT-AT-SR63K8 (SR) - 已发布
AT-AT-SR75K8 (SR) - 已发布
```

---

### SF系列执行器 (141个)

**数据源**: `backend/data_imports/sf_actuators_data.csv`

**字段映射**:
- `model_base` → 型号基础 (如: SF10-150DA)
- `series` → 系列 (SF)
- `body_size` → 本体尺寸 (如: SF10, SF14, SF16...)
- `cylinder_size` → 气缸尺寸
- `action_type` → 作用类型 (DA/SR)
- `spring_range` → 弹簧范围
- `base_price` → 基础价格
- `torque_symmetric` → 对称拨叉扭矩数据 (JSON格式)
- `torque_canted` → 偏心拨叉扭矩数据 (JSON格式)
- `connect_flange` → 连接法兰标准
- `L1, L2, m1, m2, A, H1, H2, D` → 外形尺寸
- `G` → 气动连接尺寸

**数据特点**:
- **拨叉式机构**：专为球阀和蝶阀设计
- **双扭矩数据**：
  - 对称拨叉 (symmetric)：适用于球阀
  - 偏心拨叉 (canted)：适用于蝶阀
- **多压力/角度组合**：每种拨叉类型包含12个扭矩值
  - 压力范围：0.3-0.6 bar
  - 角度：0°, 45°, 90°
- **完整尺寸数据**：8个外形尺寸参数

**扭矩数据格式示例** (SF10-150DA):
```json
{
  "symmetric": {
    "0.3_0": 309,
    "0.3_45": 185,
    "0.3_90": 309,
    "0.4_0": 412,
    ...
  },
  "canted": {
    "0.3_0": 417,
    "0.3_45": 200,
    "0.3_90": 282,
    "0.4_0": 556,
    ...
  }
}
```

**样本数据**:
```
SF10-150DA (DA) - 对称/偏心拨叉扭矩完整 - 已发布
SF10-170DA (DA) - 对称/偏心拨叉扭矩完整 - 已发布
SF12-170DA (DA) - 对称/偏心拨叉扭矩完整 - 已发布
```

**型号规格分布**:
- 本体尺寸范围: SF10 ~ SF60
- 气缸尺寸范围: 150 ~ 800
- 双作用(DA)和单作用(SR)型号

---

## 手动操作装置数据

**数量**: 18个

**数据源**: `backend/data_imports/manual_overrides_data.csv`

**字段映射**:
- `model_base` → 型号
- `name` → 名称
- `price` → 价格
- `compatible_body_sizes` → 兼容的本体尺寸

**数据特点**:
- 包含手轮装置和蜗轮箱两种类型
- 与SF系列执行器配套使用
- 根据名称自动识别操作类型

**类型分布**:
- 手轮装置: 用于小扭矩场合
- 蜗轮箱: 用于大扭矩场合，带多级减速

**样本数据**:
```
SF10-150 - 手轮装置-小型 - ¥380
SF14-200 - 手轮装置-标准型 - ¥450
SF16-250 - 手轮装置-加长型 - ¥500
SF30-450DA - 蜗轮箱-超重型 - ¥2400
SF60-800DA - 蜗轮箱-超高扭矩型 - ¥6700
```

---

## 配件数据

**数量**: 10个

**数据源**: 程序内定义 (`backend/seed_final_acceptance.js`)

**分类统计**:

### 1. 控制类配件 (2个)
- 电磁阀 - 单线圈 (¥450)
- 电磁阀 - 双线圈 (¥680)

### 2. 检测与反馈类配件 (5个)
- 限位开关盒（机械式）(¥580)
- 位置变送器（模拟量）(¥1,280)
- 位置指示器（机械式）(¥280)
- 电气定位器 (¥1,580)

### 3. 连接与传动类配件 (2个)
- 联轴器 - ISO F07 (¥180)
- 联轴器 - ISO F10 (¥280)

### 4. 安全与保护类配件 (2个)
- 气源三联件 (¥380)
- 快速排气阀 (¥120)

**数据特点**:
- 完整的技术规格信息
- 明确的兼容性规则
- 按功能分类管理
- 支持ISO 5211标准

---

## 数据导入流程

### 自动导入脚本

**位置**: `backend/seed_final_acceptance.js`

**执行命令**:
```bash
cd backend
npm run seed:final
```

### 导入步骤

1. **Part A: 清空数据库** (按依赖顺序)
   - Token数据
   - 售后工单
   - 生产相关
   - 财务数据
   - 订单数据
   - 项目数据
   - 用户数据
   - 供应商数据
   - 产品数据

2. **Part B: 创建测试用户** (10个角色)
   - 系统管理员
   - 销售经理
   - 技术工程师
   - 商务工程师
   - 采购专员
   - 生产计划员
   - 质检员
   - 物流专员
   - 售后工程师
   - 车间工人

3. **Part C: 创建供应商** (5个)

4. **Part D: 导入执行器数据**
   - AT/GY系列 (55个)
   - SF系列 (141个)

5. **Part E: 导入手动操作装置** (18个)

6. **Part F: 创建配件** (10个)

7. **Part G: 创建示例项目** (4个，可选)

### 导入时间

- 总耗时: **~1秒**
- 高效的批量插入机制
- 完整的错误处理和日志

---

## 数据验证

### 验证脚本

**位置**: `backend/verify_data_completeness.js`

**执行命令**:
```bash
cd backend
node verify_data_completeness.js
```

### 验证内容

#### 1. 执行器数据验证
- AT/GY系列数量检查
- SF系列数量检查
- SF系列扭矩数据完整性
- SF系列尺寸数据完整性
- 样本数据展示

#### 2. 手动操作装置验证
- 数量检查
- 类型分布统计
- 样本数据展示

#### 3. 配件数据验证
- 数量检查
- 类型分布统计

### 最新验证结果

**验证时间**: 2025-10-30

```
✅ AT/GY系列执行器: 55个 (预期: 54个) - 完整
✅ SF系列执行器: 141个 (预期: 140个) - 完整
   ✅ 对称拨叉扭矩数据: 完整
   ✅ 偏心拨叉扭矩数据: 完整
   ✅ 尺寸数据: 完整
✅ 手动操作装置: 18个 (预期: 18个) - 完整
✅ 配件: 10个 (预期: 10个) - 完整

📊 执行器总计: 196个 (101.0%)
```

**结论**: 🎉 所有核心数据已完整导入！

---

## 数据维护指南

### 添加新产品

#### 1. AT/GY系列执行器
编辑文件: `backend/data_imports/at_gy_actuators_data_final.csv`

#### 2. SF系列执行器
编辑文件: `backend/data_imports/sf_actuators_data.csv`

**注意事项**:
- 扭矩数据使用JSON格式，单引号会自动转换为双引号
- 确保所有必填字段完整
- 尺寸数据单位统一为mm

#### 3. 手动操作装置
编辑文件: `backend/data_imports/manual_overrides_data.csv`

#### 4. 配件
编辑文件: `backend/seed_final_acceptance.js`  
在 `accessoriesData` 数组中添加

### 重新导入数据

```bash
cd backend
npm run seed:final
```

⚠️ **警告**: 此操作会清空现有数据库并重新导入所有数据！

### 验证数据完整性

```bash
cd backend
node verify_data_completeness.js
```

---

## 生产环境部署

### 数据初始化步骤

1. **备份现有数据** (如果有)
   ```bash
   mongodump --db=cmax --out=/backup/path
   ```

2. **只运行Part A + Part B**
   - 修改 `seed_final_acceptance.js`，注释掉 Part G (示例业务数据)
   - 保留测试用户或创建生产环境用户

3. **导入核心产品数据**
   ```bash
   npm run seed:final
   ```

4. **验证数据完整性**
   ```bash
   node verify_data_completeness.js
   ```

5. **配置生产环境数据库连接**
   - 更新 `.env` 文件中的 `MONGO_URI`
   - 确保数据库访问权限正确

---

## 故障排查

### 常见问题

#### 1. SF系列数据未导入

**症状**: 验证显示SF系列数量为0

**原因**: 
- CSV文件路径错误
- 字段名不匹配
- 数据格式错误

**解决方案**:
- 检查CSV文件是否存在: `backend/data_imports/sf_actuators_data.csv`
- 确认字段名: `model_base`, `action_type`, `base_price`等
- 检查JSON格式的扭矩数据是否正确

#### 2. 手动操作装置数据不完整

**症状**: 只导入了4个，应该18个

**原因**: 使用了旧的硬编码数据而不是CSV导入

**解决方案**:
- 确认 `seed_final_acceptance.js` 中的 `seedManualOverrides` 函数使用CSV导入
- 重新运行 `npm run seed:final`

#### 3. 配件数量不对

**症状**: 配件数量少于10个

**原因**: `accessoriesData` 数组定义不完整

**解决方案**:
- 检查 `seed_final_acceptance.js` 中的 `accessoriesData` 数组
- 确认有10个配件定义

---

## 版本历史

### v1.0 (2025-10-30)
- ✅ 初始版本
- ✅ 完整的AT/GY系列执行器数据 (55个)
- ✅ 完整的SF系列执行器数据 (141个)
- ✅ 完整的手动操作装置数据 (18个)
- ✅ 完整的配件数据 (10个)
- ✅ 自动导入脚本
- ✅ 数据验证脚本

---

## 相关文档

- [手动测试用例](5_MANUAL_TEST_CASES.md)
- [质量保证体系](6_QUALITY_ASSURANCE_SYSTEM.md)
- [Bug追踪](testing/BUG_TRACKING.md)
- [UAT验收脚本](8_UAT_ACCEPTANCE_SCRIPT.md)

---

**维护人**: Project Ark Team  
**最后验证**: 2025-10-30  
**下次审查**: 定期或有数据变更时

