# Project Ark - 测试文档使用指南

**版本**: v1.0.0  
**更新日期**: 2025-10-30

---

## 📚 文档概览

本测试文档体系包含以下文件：

```
docs/testing/
├── README.md                    ← 你正在看的文档（使用指南）
├── MANUAL_TEST_CASES.md         ← 手动测试用例清单（模板）
└── BUG_TRACKING.md              ← Bug跟踪记录表
```

---

## 🎯 核心理念

这套测试体系的设计理念是：

1. **系统化**: 将手动测试从随意的、依赖个人经验的活动，转变为系统化的、可追溯的工程实践
2. **可重复**: 每次测试都基于干净、一致的初始环境，确保结果可重复
3. **持续改进**: 发现的问题和解决方案会沉淀为测试用例，防止同类问题再次出现
4. **质量把关**: 明确的发布标准，确保测试通过的版本和线上版本表现一致

---

## 🔄 完整测试流程

### 阶段1: 测试准备（5分钟）

```bash
# 1. 复制测试用例模板
cd /Users/hexiaoxiao/Desktop/Model\ Selection\ System/docs/testing
cp MANUAL_TEST_CASES.md TEST_RUN_2025-10-30.md

# 2. 清理并初始化数据库
cd ../../backend
npm run seed:final

# 3. 启动测试环境
cd ..
bash 演示环境启动.sh
```

**重要**: 
- 每次测试前必须运行 `npm run seed:final`，确保从干净的初始数据开始
- 保持 `MANUAL_TEST_CASES.md` 模板文件干净，不要在上面直接填写测试结果
- 使用复制出来的 `TEST_RUN_YYYY-MM-DD.md` 文件记录测试结果

---

### 阶段2: 执行测试（2-4小时）

**测试顺序建议**:

1. **先测P0高优先级模块**（必须100%通过）
   - A. 用户认证与权限
   - B. 智能选型引擎
   - G. 产品数据管理

2. **再测P1中优先级模块**（通过率≥95%）
   - C. 项目全流程
   - D. BOM与报价
   - E. 合同与生产
   - I. 性能与稳定性

3. **最后测P2低优先级模块**（通过率≥90%）
   - F. 质量与物流
   - H. 系统管理
   - J. 兼容性测试

**测试执行要点**:

```
对于每个测试用例：
    ↓
1. 仔细阅读"测试场景"和"预期结果"
    ↓
2. 按照描述的步骤操作系统
    ↓
3. 观察实际结果是否符合预期
    ↓
4. 在"测试结果"列标记：
   - [x] Pass - 完全符合预期
   - [x] Fail - 不符合预期或出错
    ↓
5. 如果失败，立即跳转到"阶段3: Bug记录"
```

**示例**:

```markdown
| 编号 | 测试场景 | 预期结果 | 测试结果 | 备注/Bug ID |
| :--- | :--- | :--- | :--- | :--- |
| A-01 | **登录** | 销售经理登录成功 | [x] Pass | |
| B-06 | **价格动态计算** | 勾选配件后总价自动累加 | [x] Fail | BUG-002 |
```

---

### 阶段3: Bug记录（发现即记录）

**重要**: 一旦发现Bug，立即记录，不要等到测试结束！

#### 步骤1: 在BUG_TRACKING.md中新增一行

打开 `BUG_TRACKING.md`，在表格中添加新行：

```markdown
| ID | 发现日期 | 问题描述 | 复现步骤 | 严重程度 | 测试用例 | 负责人 | 状态 | 解决方案/备注 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **BUG-003** | 2025-10-30 | 项目名称包含特殊字符时保存失败 | 1. 创建新项目<br>2. 名称输入"测试&项目"<br>3. 点击保存 | P1 (High) | C-01 | 待分配 | **Open** | 错误提示："项目名称包含非法字符" |
```

#### 步骤2: 评估严重程度

| 级别 | 判断标准 | 响应时间 |
| :--- | :--- | :--- |
| **P0** | 系统崩溃、核心功能完全不可用、数据丢失 | 立即处理 |
| **P1** | 重要功能受阻、计算结果错误 | 1个工作日 |
| **P2** | 功能可用但有明显问题 | 3个工作日 |
| **P3** | 小问题、界面瑕疵 | 下个版本 |

#### 步骤3: 回到测试用例，关联Bug ID

```markdown
| B-06 | **价格动态计算** | ... | [x] Fail | **BUG-002** |
```

#### 步骤4: 截图保存（推荐）

- 将错误截图保存为 `BUG-XXX-screenshot.png`
- 放在 `docs/testing/screenshots/` 目录下
- 在Bug记录中备注截图文件名

---

### 阶段4: Bug修复与验证

#### 开发者修复Bug

1. **认领Bug**: 在 `BUG_TRACKING.md` 中将"负责人"改为自己的名字
2. **更新状态**: 将状态改为 `In Progress`
3. **修复问题**: 完成代码修改
4. **提交代码**: 提交到Git，记录commit hash
5. **更新Bug记录**:
   ```markdown
   | BUG-002 | ... | 开发者B | **Fixed** | 已修复价格计算逻辑，增加温度选项附加费用。提交: commit abc123def. |
   ```

#### QA回归验证

1. **拉取最新代码**: `git pull`
2. **重新初始化**: `npm run seed:final`
3. **重新测试该用例**: 按照原来的步骤再测一遍
4. **更新Bug状态**:
   - 通过 → `Closed`
   - 失败 → `Reopened`（开发者需要重新修复）

---

### 阶段5: 测试总结（15分钟）

完成所有测试后，填写 `TEST_RUN_YYYY-MM-DD.md` 文件末尾的**测试总结模板**：

```markdown
### 测试覆盖率统计

| 模块 | 总用例数 | 已执行 | 通过 | 失败 | 跳过 | 通过率 |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: |
| A. 用户认证与权限 | 5 | 5 | 5 | 0 | 0 | 100% |
| B. 智能选型引擎 | 8 | 8 | 7 | 1 | 0 | 87.5% |
| ... | ... | ... | ... | ... | ... | ... |
| **总计** | **59** | **59** | **56** | **3** | **0** | **94.9%** |

### 测试结论

**整体评估**: [x] 可以发布

**主要问题**:
1. BUG-002 (P1): 价格计算错误 - 已修复并验证通过
2. BUG-005 (P3): 移动端界面显示问题 - 计划下个版本修复

**改进建议**:
1. 增加价格计算的单元测试
2. 建议增加移动端测试设备

**签字确认**:
- 测试负责人: 张三 日期: 2025-10-30
- 开发负责人: 李四 日期: 2025-10-30
- 项目经理: 王五 日期: 2025-10-30
```

---

### 阶段6: 发布决策

#### 发布检查清单

在发布新版本前，必须确认：

- [ ] **所有P0级别Bug已Closed**（修复率100%）
- [ ] **所有P1级别Bug已Closed或降级为P2**（修复率≥95%）
- [ ] **P2级别Bug修复率≥80%**
- [ ] **所有Fixed状态的Bug已完成回归验证**
- [ ] **没有Reopened状态的Bug**
- [ ] **测试总结已完成并签字确认**

#### 发布/不发布决策树

```
所有P0 Bug已Closed？
    ├─ 是 → 所有P1 Bug已Closed或降级？
    │       ├─ 是 → ✅ 可以发布
    │       └─ 否 → P1修复率≥95%？
    │               ├─ 是 → ✅ 可以发布（注明已知问题）
    │               └─ 否 → ❌ 暂不发布，继续修复
    └─ 否 → ❌ 绝对不能发布
```

---

## 🛡️ 这套流程如何解决您的问题？

### 问题1: "合理修改并保存"

**解决方案**: 
- 所有发现的问题都被记录在 `BUG_TRACKING.md` 中
- "解决方案/备注" 列详细记录了修复方法
- 这些记录成为团队的知识资产

**示例**:
```markdown
| BUG-001 | ... | **Closed** | 已在前端UI增加判断逻辑：`if (actuator.handwheel)` 才渲染该选项。 |
```

---

### 问题2: "防止下次测试出现同样问题"

**解决方案**: 
- `MANUAL_TEST_CASES.md` 是一个不断增长的"知识库"
- 每次发现新的边缘情况，修复后应该在测试用例中增加对应的测试项

**流程**:
```
发现Bug (例如：项目名称包含特殊字符时崩溃)
    ↓
修复Bug
    ↓
在 MANUAL_TEST_CASES.md 中增加新用例：
    | C-08 | **项目名称特殊字符** | 项目名称包含 &*() 等字符时，能正常保存或显示友好提示 | [ ] Pass / [ ] Fail | |
    ↓
下次测试时，这个场景就会被覆盖
```

---

### 问题3: "防止上线后跟测试不一样"

**解决方案**: 
- 每次测试前运行 `npm run seed:final`，确保从干净、一致的环境开始
- 这最大限度地模拟了在全新服务器上部署的情况
- 只要测试通过，上线后的表现就会和测试时高度一致

**关键原则**:
```
测试环境 = 生产环境
    ↓
1. 相同的数据库初始化脚本
2. 相同的代码版本
3. 相同的配置文件
    ↓
测试通过 = 上线可靠
```

---

## 📊 测试质量指标

### 覆盖率目标

| 模块优先级 | 测试覆盖率目标 | 通过率目标 |
| :--- | :---: | :---: |
| P0 高优先级 | 100% | 100% |
| P1 中优先级 | 100% | ≥95% |
| P2 低优先级 | ≥90% | ≥90% |

### Bug修复率目标

| Bug严重程度 | 修复率目标 | 响应时间 |
| :--- | :---: | :--- |
| P0 Critical | 100% | 4小时内 |
| P1 High | 100% | 1个工作日内 |
| P2 Medium | ≥80% | 3个工作日内 |
| P3 Low | ≥50% | 下个版本 |

---

## 🎓 最佳实践

### DO（推荐做法）

✅ **每次测试前都运行 `npm run seed:final`**  
✅ **复制模板文件进行测试，保持模板干净**  
✅ **发现Bug立即记录，不要拖延**  
✅ **截图保存关键操作和错误现场**  
✅ **Bug修复后必须回归验证**  
✅ **持续更新测试用例清单，增加新场景**  
✅ **团队定期回顾Bug趋势，持续改进**

### DON'T（避免做法）

❌ **不要跳过数据初始化步骤**  
❌ **不要在脏数据上进行测试**  
❌ **不要跳过任何测试用例**  
❌ **不要等到测试结束才记录Bug**  
❌ **不要在P0 Bug未修复时发布**  
❌ **不要忽视小问题（可能是大问题的征兆）**  
❌ **不要孤立工作，及时沟通**

---

## 🔧 工具与脚本

### 快速命令

```bash
# 1. 清理并初始化数据库
cd backend && npm run seed:final && cd ..

# 2. 启动测试环境
bash 演示环境启动.sh

# 3. 停止测试环境
bash 停止演示环境.sh

# 4. 查看后端日志
tail -f backend/server.log

# 5. 查看前端日志
tail -f frontend/test_frontend.log
```

### 测试用例快速复制

```bash
# 在 docs/testing 目录下执行
TODAY=$(date +%Y-%m-%d)
cp MANUAL_TEST_CASES.md TEST_RUN_$TODAY.md
echo "已创建测试文件: TEST_RUN_$TODAY.md"
```

---

## 📖 相关文档

- **[MANUAL_TEST_CASES.md](./MANUAL_TEST_CASES.md)** - 手动测试用例清单（模板）
- **[BUG_TRACKING.md](./BUG_TRACKING.md)** - Bug跟踪记录表
- **[../../FINAL_ACCEPTANCE_GUIDE.md](../../FINAL_ACCEPTANCE_GUIDE.md)** - 系统验收指南
- **[../4_DEMO_WALKTHROUGH.md](../4_DEMO_WALKTHROUGH.md)** - 系统演示剧本

---

## 🤝 团队协作

### 角色与职责

| 角色 | 职责 |
| :--- | :--- |
| **QA负责人** | 组织测试、分配任务、审核测试结果、发布决策 |
| **测试人员** | 执行测试用例、记录Bug、回归验证 |
| **开发负责人** | 分配Bug、审核修复方案、代码审查 |
| **开发人员** | 修复Bug、更新Bug状态、协助验证 |
| **项目经理** | 最终发布决策、协调资源、风险控制 |

### 沟通机制

- **每日站会**: 汇报测试进度、阻塞问题
- **Bug评审会**: 每天或每周评审所有Open和Reopened的Bug
- **发布前评审**: 完整过一遍测试结果和Bug列表，决定是否发布

---

## ❓ 常见问题

### Q1: 测试需要多长时间？

**A**: 首次完整测试约需要 **3-4小时**。随着熟练度提升，可缩短到 **2小时**。建议每次发布前至少留出半天时间进行测试。

### Q2: 如果测试中途发现P0 Bug怎么办？

**A**: 
1. 立即停止测试
2. 通知开发团队紧急修复
3. 修复后重新运行 `npm run seed:final`
4. 从头开始测试（确保修复没有引入新问题）

### Q3: 可以部分测试吗？

**A**: 
- **不推荐**。完整测试才能确保系统整体质量
- 如果时间紧急，至少要测试所有P0模块（100%覆盖）和P1模块（关键用例）

### Q4: 测试用例太多，能不能简化？

**A**: 
- 测试用例是根据实际业务流程设计的，不建议删减
- 可以优化测试顺序，先测核心流程
- 使用自动化测试（Cypress）覆盖部分重复性测试

### Q5: Bug修复后一定要回归测试吗？

**A**: 
- **必须！** 这是防止"修好一个问题，引入三个新问题"的唯一手段
- 至少要重新测试相关的测试用例
- 如果是核心模块的Bug，建议完整回归测试

---

## 📞 支持与反馈

- **文档问题**: 联系QA团队
- **流程改进建议**: 欢迎提出，持续优化
- **紧急Bug**: 使用P0快速响应流程

---

**文档维护者**: QA Team  
**最后更新**: 2025-10-30  
**版本**: v1.0.0

