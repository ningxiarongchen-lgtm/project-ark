# æµ‹è¯•ç¯å¢ƒé…ç½®æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¿«é€Ÿé…ç½®å’Œå¯åŠ¨æµ‹è¯•ç¯å¢ƒï¼Œä»¥ä¾¿è¿è¡Œ E2E è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚

---

## ğŸ“‹ **ç¬¬ä¸€æ­¥ï¼šé…ç½®æµ‹è¯•æ•°æ®åº“**

### 1.1 ç¼–è¾‘ `.env` æ–‡ä»¶

åœ¨åç«¯æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ä¸­æ·»åŠ æµ‹è¯•æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼š

```bash
# ç”Ÿäº§/å¼€å‘æ•°æ®åº“ï¼ˆä¿æŒä¸å˜ï¼‰
MONGODB_URI=mongodb+srv://your-username:your-password@cluster.mongodb.net/project_ark?retryWrites=true&w=majority

# æµ‹è¯•æ•°æ®åº“ï¼ˆæ–°å¢æ­¤è¡Œï¼‰
MONGO_URI_TEST=mongodb+srv://your-username:your-password@cluster.mongodb.net/project_ark_test?retryWrites=true&w=majority
```

> **ğŸ’¡ æç¤ºï¼š** 
> - æµ‹è¯•æ•°æ®åº“åº”è¯¥æ˜¯ä¸€ä¸ª**å®Œå…¨ç‹¬ç«‹**çš„æ•°æ®åº“ï¼Œé¿å…å½±å“ç”Ÿäº§æ•°æ®
> - å¦‚æœæ‚¨ä½¿ç”¨æœ¬åœ° MongoDBï¼Œå¯ä»¥ä½¿ç”¨ï¼š`MONGO_URI_TEST=mongodb://localhost:27017/project_ark_test`
> - å¦‚æœæœªé…ç½® `MONGO_URI_TEST`ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨ç”Ÿäº§æ•°æ®åº“ååæ·»åŠ  `_test` åç¼€

### 1.2 éªŒè¯é…ç½®

ç¡®ä¿ `.env` æ–‡ä»¶å·²æ­£ç¡®åŠ è½½ï¼š

```bash
# åœ¨åç«¯ç›®å½•æ‰§è¡Œ
cat .env | grep MONGO_URI
```

---

## ğŸš€ **ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæµ‹è¯•ç”¨æˆ·**

è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ‰€æœ‰è§’è‰²çš„æµ‹è¯•è´¦æˆ·ï¼š

```bash
npm run seed:test-users
```

**é¢„æœŸè¾“å‡ºï¼š**
```
âœ… æµ‹è¯•æ•°æ®åº“è¿æ¥æˆåŠŸ
ğŸ“ æ•°æ®åº“: project_ark_test
ğŸš€ å¼€å§‹åˆ›å»ºæµ‹è¯•ç”¨æˆ·...
âœ… æˆåŠŸåˆ›å»º 10 ä¸ªæµ‹è¯•ç”¨æˆ·ï¼

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                          æµ‹è¯•ç”¨æˆ·è´¦æˆ·åˆ—è¡¨                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ å§“å               â”‚ æ‰‹æœºå·        â”‚ å¯†ç          â”‚ è§’è‰²                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ æµ‹è¯•ç®¡ç†å‘˜         â”‚ 13800000001   â”‚ test123456   â”‚ Administrator       â•‘
â•‘ æµ‹è¯•é”€å”®ç»ç†       â”‚ 13800000002   â”‚ test123456   â”‚ Sales Manager       â•‘
â•‘ æµ‹è¯•é”€å”®å·¥ç¨‹å¸ˆ     â”‚ 13800000003   â”‚ test123456   â”‚ Sales Engineer      â•‘
â•‘ æµ‹è¯•æŠ€æœ¯å·¥ç¨‹å¸ˆ     â”‚ 13800000004   â”‚ test123456   â”‚ Technical Engineer  â•‘
â•‘ æµ‹è¯•é‡‡è´­ä¸“å‘˜       â”‚ 13800000005   â”‚ test123456   â”‚ Procurement...      â•‘
â•‘ æµ‹è¯•ç”Ÿäº§è®¡åˆ’å‘˜     â”‚ 13800000006   â”‚ test123456   â”‚ Production Planner  â•‘
â•‘ æµ‹è¯•å”®åå·¥ç¨‹å¸ˆ     â”‚ 13800000007   â”‚ test123456   â”‚ After-sales...      â•‘
â•‘ ...                â”‚ ...           â”‚ ...          â”‚ ...                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸƒ **ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æµ‹è¯•ç¯å¢ƒåç«¯**

åœ¨ä¸€ä¸ª**æ–°çš„ç»ˆç«¯çª—å£**ä¸­å¯åŠ¨è¿æ¥åˆ°æµ‹è¯•æ•°æ®åº“çš„åç«¯æœåŠ¡ï¼š

```bash
npm run start:test
```

**é¢„æœŸè¾“å‡ºï¼š**
```
ğŸ§ª è¿è¡Œåœ¨æµ‹è¯•ç¯å¢ƒ
âœ… MongoDB Connected: cluster0.xxxxx.mongodb.net
ğŸ“ Database: project_ark_test
ğŸ”Œ Socket.IO initialized

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               ğŸš€ PROJECT ARK BACKEND                   â•‘
â•‘   Environment: test                                    â•‘
â•‘   Server running on port 5001                          â•‘
â•‘   API: http://localhost:5001                          â•‘
â•‘   WebSocket: ws://localhost:5001                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

> **âš ï¸ é‡è¦ï¼š** 
> - ä¿æŒæ­¤ç»ˆç«¯çª—å£è¿è¡Œï¼Œä¸è¦å…³é—­
> - åç«¯å°†ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨é‡å¯ï¼ˆnodemonï¼‰
> - æ‰€æœ‰ API è¯·æ±‚å°†è®¿é—®æµ‹è¯•æ•°æ®åº“ï¼Œä¸ä¼šå½±å“ç”Ÿäº§æ•°æ®

---

## ğŸ§ª **ç¬¬å››æ­¥ï¼šè¿è¡Œ E2E æµ‹è¯•**

### é€‰é¡¹ Aï¼šä½¿ç”¨ Cypress äº¤äº’å¼ç•Œé¢

```bash
cd ../frontend
npm run cypress:open
```

### é€‰é¡¹ Bï¼šä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œæµ‹è¯•

```bash
cd ../frontend
npm run cypress:run
```

### é€‰é¡¹ Cï¼šæ‰‹åŠ¨æµ‹è¯•

1. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼š
   ```bash
   cd ../frontend
   npm run dev
   ```

2. åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š`http://localhost:5173`

3. ä½¿ç”¨æµ‹è¯•è´¦æˆ·ç™»å½•ï¼š
   - **æ‰‹æœºå·**: `13800000001`ï¼ˆç®¡ç†å‘˜ï¼‰
   - **å¯†ç **: `test123456`

---

## ğŸ“Š **æµ‹è¯•è´¦æˆ·åˆ—è¡¨**

| è§’è‰² | æ‰‹æœºå· | å¯†ç  | ç”¨é€” |
|------|--------|------|------|
| Administrator | 13800000001 | test123456 | å…¨å±€ç®¡ç†ã€ç”¨æˆ·ç®¡ç† |
| Sales Manager | 13800000002 | test123456 | é¡¹ç›®ç®¡ç†ã€åˆåŒç­¾è®¢ |
| Sales Engineer | 13800000003 | test123456 | å®¢æˆ·æ²Ÿé€šã€æŠ¥ä»· |
| Technical Engineer | 13800000004 | test123456 | æŠ€æœ¯é€‰å‹ã€BOM |
| Procurement Specialist | 13800000005 | test123456 | ä¾›åº”å•†ç®¡ç†ã€é‡‡è´­ |
| Production Planner | 13800000006 | test123456 | ç”Ÿäº§æ’æœŸã€APS |
| After-sales Engineer | 13800000007 | test123456 | å”®åå·¥å•ã€ç»´ä¿® |
| Commercial Engineer | 13800000008 | test123456 | å•†åŠ¡å®¡æ ¸ |
| Quality Inspector | 13800000009 | test123456 | è´¨é‡æ£€éªŒ |
| Logistics Specialist | 13800000010 | test123456 | ç‰©æµç®¡ç† |

---

## ğŸ”„ **é‡ç½®æµ‹è¯•ç¯å¢ƒ**

å¦‚æœéœ€è¦æ¸…ç©ºæµ‹è¯•æ•°æ®å¹¶é‡æ–°å¼€å§‹ï¼š

```bash
# 1. åœæ­¢æµ‹è¯•åç«¯ï¼ˆCtrl+Cï¼‰

# 2. é‡æ–°åˆ›å»ºæµ‹è¯•ç”¨æˆ·
npm run seed:test-users

# 3. ï¼ˆå¯é€‰ï¼‰å¡«å……æµ‹è¯•æ•°æ®
NODE_ENV=test node seed.js

# 4. é‡å¯æµ‹è¯•åç«¯
npm run start:test
```

---

## ğŸ› ï¸ **å¯ç”¨çš„ NPM è„šæœ¬**

```bash
# å¯åŠ¨æµ‹è¯•ç¯å¢ƒåç«¯
npm run start:test

# åˆ›å»ºæµ‹è¯•ç”¨æˆ·
npm run seed:test-users

# è¿è¡Œ Jest å•å…ƒæµ‹è¯•ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
npm run test
npm run test:watch
npm run test:coverage

# æ™®é€šå¼€å‘ç¯å¢ƒï¼ˆä½¿ç”¨ç”Ÿäº§æ•°æ®åº“ï¼‰
npm run dev
npm start
```

---

## â“ **å¸¸è§é—®é¢˜**

### Q1: æµ‹è¯•æ•°æ®ä¼šå½±å“ç”Ÿäº§æ•°æ®å—ï¼Ÿ
**A**: ä¸ä¼šã€‚æµ‹è¯•ç¯å¢ƒä½¿ç”¨å®Œå…¨ç‹¬ç«‹çš„æ•°æ®åº“ï¼ˆ`project_ark_test`ï¼‰ï¼Œä¸ç”Ÿäº§æ•°æ®åº“å®Œå…¨éš”ç¦»ã€‚

### Q2: å¦‚ä½•åˆ‡æ¢å›ç”Ÿäº§ç¯å¢ƒï¼Ÿ
**A**: åœæ­¢æµ‹è¯•åç«¯ï¼Œè¿è¡Œ `npm run dev` æˆ– `npm start` å³å¯ã€‚

### Q3: æµ‹è¯•ç”¨æˆ·çš„å¯†ç å¯ä»¥ä¿®æ”¹å—ï¼Ÿ
**A**: å¯ä»¥ã€‚ç¼–è¾‘ `seed_test_users.js` æ–‡ä»¶ä¸­çš„ `testUsers` æ•°ç»„ï¼Œä¿®æ”¹ `password` å­—æ®µï¼Œç„¶åé‡æ–°è¿è¡Œ `npm run seed:test-users`ã€‚

### Q4: å¯ä»¥æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨æˆ·å—ï¼Ÿ
**A**: å¯ä»¥ã€‚åœ¨ `seed_test_users.js` çš„ `testUsers` æ•°ç»„ä¸­æ·»åŠ æ–°ç”¨æˆ·å¯¹è±¡ï¼Œç¡®ä¿æ‰‹æœºå·å”¯ä¸€å³å¯ã€‚

---

## ğŸ“ **è·å–å¸®åŠ©**

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ `.env` æ–‡ä»¶æ˜¯å¦æ­£ç¡®é…ç½®
2. ç¡®è®¤ MongoDB æ•°æ®åº“è¿æ¥æ­£å¸¸
3. æŸ¥çœ‹åç«¯æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
4. æ£€æŸ¥æµ‹è¯•æ•°æ®åº“ä¸­æ˜¯å¦æˆåŠŸåˆ›å»ºäº†ç”¨æˆ·

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸ‰**

