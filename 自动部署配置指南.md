# ğŸš€ è‡ªåŠ¨éƒ¨ç½²é…ç½®æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ é…ç½®å‰åç«¯è‡ªåŠ¨éƒ¨ç½²ï¼Œæ¯æ¬¡æ¨é€ä»£ç åˆ° GitHub åè‡ªåŠ¨éƒ¨ç½²åˆ° Cloudflare Pages å’Œ Renderã€‚

## ğŸ“‹ ç›®å½•

1. [å‰ç«¯éƒ¨ç½² - Cloudflare Pages](#1-å‰ç«¯éƒ¨ç½²---cloudflare-pages)
2. [åç«¯éƒ¨ç½² - Render](#2-åç«¯éƒ¨ç½²---render)
3. [é…ç½® GitHub Secrets](#3-é…ç½®-github-secrets)
4. [æµ‹è¯•è‡ªåŠ¨éƒ¨ç½²](#4-æµ‹è¯•è‡ªåŠ¨éƒ¨ç½²)
5. [å¸¸è§é—®é¢˜](#5-å¸¸è§é—®é¢˜)

---

## 1. å‰ç«¯éƒ¨ç½² - Cloudflare Pages

### æ­¥éª¤ 1.1: ç™»å½• Cloudflare

1. è®¿é—® [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. ç™»å½•ä½ çš„ Cloudflare è´¦å·

### æ­¥éª¤ 1.2: åˆ›å»º Pages é¡¹ç›®

1. åœ¨å·¦ä¾§èœå•é€‰æ‹© **Workers & Pages**
2. ç‚¹å‡» **Create application** â†’ **Pages** â†’ **Connect to Git**
3. æˆæƒ GitHub è®¿é—®æƒé™
4. é€‰æ‹©ä»“åº“ï¼š`Model Selection System`
5. é…ç½®æ„å»ºè®¾ç½®ï¼š
   - **é¡¹ç›®åç§°**: `model-selection-frontend`
   - **ç”Ÿäº§åˆ†æ”¯**: `main`
   - **æ¡†æ¶é¢„è®¾**: `Vite`
   - **æ„å»ºå‘½ä»¤**: `cd frontend && npm install && npm run build`
   - **æ„å»ºè¾“å‡ºç›®å½•**: `frontend/dist`
   - **æ ¹ç›®å½•**: `/`

### æ­¥éª¤ 1.3: é…ç½®ç¯å¢ƒå˜é‡ï¼ˆåœ¨ Cloudflare Pagesï¼‰

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```
NODE_ENV=production
VITE_API_URL=https://your-backend.onrender.com
```

### æ­¥éª¤ 1.4: è·å– Cloudflare API Token

1. è®¿é—® [Cloudflare API Tokens](https://dash.cloudflare.com/profile/api-tokens)
2. ç‚¹å‡» **Create Token**
3. ä½¿ç”¨ **Edit Cloudflare Workers** æ¨¡æ¿
4. é…ç½®æƒé™ï¼š
   - **Account** - Cloudflare Pages: Edit
   - **Zone** - å¦‚æœæœ‰è‡ªå®šä¹‰åŸŸåï¼Œæ·»åŠ ç›¸åº”æƒé™
5. ç‚¹å‡» **Continue to summary** â†’ **Create Token**
6. **å¤åˆ¶å¹¶ä¿å­˜ Token**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰

### æ­¥éª¤ 1.5: è·å– Cloudflare Account ID

1. åœ¨ Cloudflare Dashboard ä¸»é¡µ
2. å³ä¾§å¯ä»¥çœ‹åˆ° **Account ID**
3. ç‚¹å‡»å¤åˆ¶

---

## 2. åç«¯éƒ¨ç½² - Render

### æ­¥éª¤ 2.1: ç™»å½• Render

1. è®¿é—® [Render Dashboard](https://dashboard.render.com/)
2. ä½¿ç”¨ GitHub è´¦å·ç™»å½•

### æ­¥éª¤ 2.2: åˆ›å»º Web Service

1. ç‚¹å‡» **New +** â†’ **Web Service**
2. è¿æ¥ GitHub ä»“åº“ï¼š`Model Selection System`
3. é…ç½®æœåŠ¡ï¼š
   - **Name**: `model-selection-backend`
   - **Region**: `Singapore` (äºšæ´²ç”¨æˆ·æ¨è)
   - **Branch**: `main`
   - **Runtime**: `Node`
   - **Build Command**: `cd backend && npm install`
   - **Start Command**: `cd backend && npm start`
   - **Plan**: `Free` (æˆ–é€‰æ‹©ä»˜è´¹æ–¹æ¡ˆ)

### æ­¥éª¤ 2.3: é…ç½®ç¯å¢ƒå˜é‡ï¼ˆåœ¨ Renderï¼‰

åœ¨ Render æœåŠ¡çš„ **Environment** æ ‡ç­¾é¡µæ·»åŠ ï¼š

```
NODE_ENV=production
PORT=10000
MONGODB_URI=your_mongodb_connection_string
JWT_SECRET=your_jwt_secret_key
CORS_ORIGIN=https://your-frontend.pages.dev
```

**é‡è¦**: 
- `MONGODB_URI`: ä½¿ç”¨ MongoDB Atlas æˆ–å…¶ä»–äº‘æ•°æ®åº“
- `JWT_SECRET`: ç”Ÿæˆå¼ºå¯†ç ï¼ˆè‡³å°‘ 32 å­—ç¬¦ï¼‰
- `CORS_ORIGIN`: ä½¿ç”¨ä½ çš„ Cloudflare Pages åŸŸå

### æ­¥éª¤ 2.4: è·å– Render Deploy Hook

1. åœ¨ Render æœåŠ¡é¡µé¢ï¼Œç‚¹å‡» **Settings**
2. æ»šåŠ¨åˆ° **Deploy Hook** éƒ¨åˆ†
3. ç‚¹å‡» **Create Deploy Hook**
4. å¤åˆ¶ç”Ÿæˆçš„ URLï¼ˆæ ¼å¼å¦‚ï¼š`https://api.render.com/deploy/srv-xxxxx?key=yyyyy`ï¼‰

---

## 3. é…ç½® GitHub Secrets

### æ­¥éª¤ 3.1: è®¿é—® GitHub ä»“åº“è®¾ç½®

1. æ‰“å¼€ GitHub ä»“åº“ï¼š`Model Selection System`
2. ç‚¹å‡» **Settings** â†’ **Secrets and variables** â†’ **Actions**
3. ç‚¹å‡» **New repository secret**

### æ­¥éª¤ 3.2: æ·»åŠ ä»¥ä¸‹ Secrets

#### Cloudflare ç›¸å…³ï¼š

| Secret Name | Value | è¯´æ˜ |
|------------|-------|------|
| `CLOUDFLARE_API_TOKEN` | ä½ çš„ Cloudflare API Token | ä»æ­¥éª¤ 1.4 è·å– |
| `CLOUDFLARE_ACCOUNT_ID` | ä½ çš„ Account ID | ä»æ­¥éª¤ 1.5 è·å– |

#### Render ç›¸å…³ï¼š

| Secret Name | Value | è¯´æ˜ |
|------------|-------|------|
| `RENDER_DEPLOY_HOOK` | Deploy Hook URL | ä»æ­¥éª¤ 2.4 è·å– |

### æ·»åŠ æ–¹æ³•ï¼š
1. Name: è¾“å…¥ Secret åç§°ï¼ˆå¦‚ `CLOUDFLARE_API_TOKEN`ï¼‰
2. Secret: ç²˜è´´å¯¹åº”çš„å€¼
3. ç‚¹å‡» **Add secret**
4. é‡å¤ä»¥ä¸Šæ­¥éª¤æ·»åŠ æ‰€æœ‰ Secrets

---

## 4. æµ‹è¯•è‡ªåŠ¨éƒ¨ç½²

### æµ‹è¯•å‰ç«¯éƒ¨ç½²

```bash
# ä¿®æ”¹å‰ç«¯æ–‡ä»¶
echo "// Test change" >> frontend/src/App.jsx

# æäº¤å¹¶æ¨é€
git add frontend/src/App.jsx
git commit -m "test: trigger frontend deployment"
git push origin main
```

**æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€**ï¼š
- GitHub: ä»“åº“ â†’ **Actions** æ ‡ç­¾é¡µ
- Cloudflare: Dashboard â†’ **Workers & Pages** â†’ ä½ çš„é¡¹ç›®

### æµ‹è¯•åç«¯éƒ¨ç½²

```bash
# ä¿®æ”¹åç«¯æ–‡ä»¶
echo "// Test change" >> backend/server.js

# æäº¤å¹¶æ¨é€
git add backend/server.js
git commit -m "test: trigger backend deployment"
git push origin main
```

**æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€**ï¼š
- GitHub: ä»“åº“ â†’ **Actions** æ ‡ç­¾é¡µ
- Render: Dashboard â†’ ä½ çš„æœåŠ¡ â†’ **Events** æ ‡ç­¾é¡µ

---

## 5. å¸¸è§é—®é¢˜

### Q1: å‰ç«¯éƒ¨ç½²å¤±è´¥ - "API Token invalid"

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `CLOUDFLARE_API_TOKEN` æ˜¯å¦æ­£ç¡®å¤åˆ¶
2. ç¡®ä¿ Token æœ‰ Cloudflare Pages Edit æƒé™
3. é‡æ–°ç”Ÿæˆ Token å¹¶æ›´æ–° GitHub Secret

### Q2: åç«¯éƒ¨ç½²å¤±è´¥ - "Build failed"

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `render.yaml` é…ç½®æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿ `backend/package.json` ä¸­çš„ä¾èµ–å®Œæ•´
3. æŸ¥çœ‹ Render éƒ¨ç½²æ—¥å¿—æŸ¥æ‰¾å…·ä½“é”™è¯¯

### Q3: éƒ¨ç½²æˆåŠŸä½†å‰ç«¯æ— æ³•è¿æ¥åç«¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥å‰ç«¯ç¯å¢ƒå˜é‡ `VITE_API_URL` æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿åç«¯ `CORS_ORIGIN` åŒ…å«å‰ç«¯åŸŸå
3. æ£€æŸ¥ Render æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
4. é‡æ–°æ„å»ºå‰ç«¯ï¼š`npm run build`

### Q4: MongoDB è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿ MongoDB Atlas å…è®¸ Render IP è®¿é—®ï¼ˆæˆ–å…è®¸æ‰€æœ‰ IPï¼‰
2. æ£€æŸ¥ `MONGODB_URI` æ ¼å¼æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®

### Q5: Render å…è´¹ç‰ˆæœåŠ¡ä¼‘çœ 

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ UptimeRobot ç­‰æœåŠ¡å®šæœŸ ping ä½ çš„åç«¯ URL
- æˆ–å‡çº§åˆ° Render ä»˜è´¹è®¡åˆ’

---

## 6. è‡ªåŠ¨éƒ¨ç½²å·¥ä½œæµç¨‹

### å®Œæ•´æµç¨‹å›¾ï¼š

```
å¼€å‘è€…æ¨é€ä»£ç åˆ° GitHub
        â†“
GitHub Actions è‡ªåŠ¨è§¦å‘
        â†“
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â†“       â†“
å‰ç«¯éƒ¨ç½²   åç«¯éƒ¨ç½²
    â†“       â†“
Cloudflare Render
  Pages
```

### è§¦å‘æ¡ä»¶ï¼š

**å‰ç«¯éƒ¨ç½²**ï¼š
- æ¨é€åˆ° `main` åˆ†æ”¯
- `frontend/` ç›®å½•æœ‰å˜æ›´
- æ‰‹åŠ¨è§¦å‘ï¼ˆActions é¡µé¢ï¼‰

**åç«¯éƒ¨ç½²**ï¼š
- æ¨é€åˆ° `main` åˆ†æ”¯
- `backend/` ç›®å½•æœ‰å˜æ›´
- æ‰‹åŠ¨è§¦å‘ï¼ˆActions é¡µé¢ï¼‰

---

## 7. æ‰‹åŠ¨è§¦å‘éƒ¨ç½²

### GitHub Actions æ‰‹åŠ¨è§¦å‘ï¼š

1. è®¿é—®ä»“åº“ â†’ **Actions**
2. é€‰æ‹©å¯¹åº”çš„ workflow
3. ç‚¹å‡» **Run workflow** â†’ é€‰æ‹©åˆ†æ”¯ â†’ **Run workflow**

### Cloudflare Pages æ‰‹åŠ¨è§¦å‘ï¼š

1. è®¿é—® Cloudflare Dashboard â†’ **Workers & Pages**
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. ç‚¹å‡» **Deployments** â†’ **Create deployment**
4. é€‰æ‹©åˆ†æ”¯å¹¶éƒ¨ç½²

### Render æ‰‹åŠ¨è§¦å‘ï¼š

1. è®¿é—® Render Dashboard â†’ ä½ çš„æœåŠ¡
2. ç‚¹å‡»å³ä¸Šè§’ **Manual Deploy** â†’ **Deploy latest commit**

---

## 8. ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹å‰ç«¯éƒ¨ç½²æ—¥å¿—ï¼š
- **GitHub Actions**: ä»“åº“ â†’ Actions â†’ é€‰æ‹©å¯¹åº”çš„è¿è¡Œ
- **Cloudflare Pages**: Dashboard â†’ é¡¹ç›® â†’ Deployments â†’ é€‰æ‹©éƒ¨ç½²è®°å½•

### æŸ¥çœ‹åç«¯éƒ¨ç½²æ—¥å¿—ï¼š
- **GitHub Actions**: ä»“åº“ â†’ Actions â†’ é€‰æ‹©å¯¹åº”çš„è¿è¡Œ
- **Render**: Dashboard â†’ æœåŠ¡ â†’ Logs æ ‡ç­¾é¡µ

### å®æ—¶æ—¥å¿—ï¼š
```bash
# Render æä¾›å®æ—¶æ—¥å¿—æŸ¥çœ‹
# åœ¨ Render Dashboard â†’ ä½ çš„æœåŠ¡ â†’ Logs
```

---

## 9. ç”Ÿäº§ç¯å¢ƒ URL

éƒ¨ç½²å®Œæˆåï¼Œä½ çš„åº”ç”¨å°†åœ¨ä»¥ä¸‹ URL è®¿é—®ï¼š

**å‰ç«¯**: 
- Cloudflare Pages: `https://model-selection-frontend.pages.dev`
- è‡ªå®šä¹‰åŸŸå: åœ¨ Cloudflare Pages è®¾ç½®ä¸­é…ç½®

**åç«¯**: 
- Render: `https://model-selection-backend.onrender.com`
- è‡ªå®šä¹‰åŸŸå: åœ¨ Render è®¾ç½®ä¸­é…ç½®

---

## 10. ä¸‹ä¸€æ­¥

âœ… é…ç½®å®Œæˆåï¼Œå»ºè®®ï¼š

1. **è®¾ç½®è‡ªå®šä¹‰åŸŸå**ï¼ˆå¯é€‰ï¼‰
2. **é…ç½® SSL è¯ä¹¦**ï¼ˆCloudflare å’Œ Render éƒ½ä¼šè‡ªåŠ¨é…ç½®ï¼‰
3. **è®¾ç½®ç›‘æ§å’Œå‘Šè­¦**ï¼ˆä½¿ç”¨ UptimeRobot ç­‰æœåŠ¡ï¼‰
4. **é…ç½® CDN**ï¼ˆCloudflare è‡ªå¸¦ CDNï¼‰
5. **å¤‡ä»½æ•°æ®åº“**ï¼ˆå®šæœŸå¤‡ä»½ MongoDBï¼‰

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ GitHub Actions æ—¥å¿—
2. æŸ¥çœ‹ Cloudflare Pages / Render éƒ¨ç½²æ—¥å¿—
3. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
4. ç¡®è®¤æ‰€æœ‰ Secrets éƒ½å·²æ­£ç¡®è®¾ç½®

---

## âš¡ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# æŸ¥çœ‹ GitHub Actions çŠ¶æ€
gh run list

# è§¦å‘å‰ç«¯éƒ¨ç½²
git add frontend/
git commit -m "feat: update frontend"
git push origin main

# è§¦å‘åç«¯éƒ¨ç½²
git add backend/
git commit -m "feat: update backend"
git push origin main

# åŒæ—¶è§¦å‘å‰åç«¯éƒ¨ç½²
git add .
git commit -m "feat: update full stack"
git push origin main
```

---

**é…ç½®å®Œæˆï¼** ğŸ‰

ç°åœ¨æ¯æ¬¡æ¨é€ä»£ç åˆ° GitHubï¼Œå‰åç«¯éƒ½ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

