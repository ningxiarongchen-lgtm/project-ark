# âœ… é€‰å‹é€»è¾‘éªŒè¯ä¸ä¿®å¤æŠ¥å‘Š

**æ—¥æœŸ**: 2025-11-06  
**æ£€æŸ¥äºº**: AI Assistant  
**çŠ¶æ€**: âœ… å·²ä¿®å¤å…³é”®é”™è¯¯

---

## ğŸš¨ å‘ç°çš„é—®é¢˜

### é—®é¢˜1: AT/GYç³»åˆ—é˜€é—¨ç±»å‹éªŒè¯é”™è¯¯ï¼ˆä¸¥é‡ï¼‰

**ä½ç½®**: `backend/controllers/selectionController.js` ç¬¬82-88è¡Œ

**é”™è¯¯æè¿°**:
- åç«¯éªŒè¯é€»è¾‘ä¸­ï¼ŒAT/GYç³»åˆ—ï¼ˆé½¿è½®é½¿æ¡å¼ï¼‰åªæ¥å—ï¼š`Gate Valve`ï¼ˆé—¸é˜€ï¼‰ã€`Globe Valve`ï¼ˆæˆªæ­¢é˜€ï¼‰ã€`Control Valve`ï¼ˆè°ƒèŠ‚é˜€ï¼‰
- å‰ç«¯ç•Œé¢ä¸­ï¼ŒAT/GYç³»åˆ—æ”¯æŒï¼š`Ball Valve`ï¼ˆçƒé˜€ï¼‰ã€`Butterfly Valve`ï¼ˆè¶é˜€ï¼‰
- **è¿™æ˜¯å®Œå…¨çŸ›ç›¾çš„ï¼**

**é—®é¢˜æ ¹æº**:
- é½¿è½®é½¿æ¡å¼æ‰§è¡Œå™¨æ˜¯**æ—‹è½¬å‹æ‰§è¡Œå™¨**ï¼Œè¡Œç¨‹90Â°ï¼Œé€‚ç”¨äº**çƒé˜€**å’Œ**è¶é˜€**
- é—¸é˜€ã€æˆªæ­¢é˜€æ˜¯**ç›´è¡Œç¨‹é˜€é—¨**ï¼Œéœ€è¦ç›´çº¿å¼æ‰§è¡Œå™¨ï¼Œä¸é€‚ç”¨äºæ—‹è½¬æ‰§è¡Œå™¨
- åç«¯çš„æ³¨é‡Šå’ŒéªŒè¯é€»è¾‘å®Œå…¨é”™è¯¯

**å½±å“**:
- ğŸ”´ **é˜»å¡æ€§é”™è¯¯**: æŠ€æœ¯å·¥ç¨‹å¸ˆé€‰æ‹©AT/GYç³»åˆ—æ—¶ï¼Œé€‰æ‹©çƒé˜€æˆ–è¶é˜€ä¼šè¢«åç«¯æ‹’ç»
- ğŸ”´ å‰åç«¯é€»è¾‘ä¸ä¸€è‡´ï¼Œå¯¼è‡´é€‰å‹åŠŸèƒ½å®Œå…¨æ— æ³•ä½¿ç”¨

### ä¿®å¤æ–¹æ¡ˆ

```javascript
// âŒ ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
} else if (mechanism === 'Rack & Pinion') {
  // AT/GYç³»åˆ—ï¼ˆé½¿è½®é½¿æ¡å¼ï¼‰ï¼šé—¸é˜€ã€æˆªæ­¢é˜€ã€ç›´è¡Œç¨‹è°ƒèŠ‚é˜€
  if (actualValveType && !['Gate Valve', 'Globe Valve', 'Control Valve'].includes(actualValveType)) {
    return res.status(400).json({
      success: false,
      message: 'AT/GYç³»åˆ—æ‰§è¡Œå™¨çš„é˜€é—¨ç±»å‹å¿…é¡»æ˜¯ "Gate Valve"ï¼ˆé—¸é˜€ï¼‰ã€"Globe Valve"ï¼ˆæˆªæ­¢é˜€ï¼‰æˆ– "Control Valve"ï¼ˆç›´è¡Œç¨‹è°ƒèŠ‚é˜€ï¼‰'
    });
  }
}

// âœ… ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
} else if (mechanism === 'Rack & Pinion') {
  // AT/GYç³»åˆ—ï¼ˆé½¿è½®é½¿æ¡å¼ï¼‰ï¼šçƒé˜€ã€è¶é˜€ï¼ˆæ—‹è½¬å‹é˜€é—¨ï¼Œè¡Œç¨‹90Â°ï¼‰
  if (!actualValveType) {
    return res.status(400).json({
      success: false,
      message: 'è¯·æä¾›é˜€é—¨ç±»å‹ï¼ˆvalveTypeï¼‰: "Ball Valve"ï¼ˆçƒé˜€ï¼‰æˆ– "Butterfly Valve"ï¼ˆè¶é˜€ï¼‰'
    });
  }
  if (!['Ball Valve', 'Butterfly Valve'].includes(actualValveType)) {
    return res.status(400).json({
      success: false,
      message: 'AT/GYç³»åˆ—æ‰§è¡Œå™¨çš„é˜€é—¨ç±»å‹å¿…é¡»æ˜¯ "Ball Valve"ï¼ˆçƒé˜€ï¼‰æˆ– "Butterfly Valve"ï¼ˆè¶é˜€ï¼‰- æ—‹è½¬å‹é˜€é—¨'
    });
  }
}
```

---

## âœ… éªŒè¯é€šè¿‡çš„é€»è¾‘

### 1. æ‰­çŸ©è®¡ç®—é€»è¾‘ âœ“

#### åŒä½œç”¨æ‰§è¡Œå™¨ (DA)
- **è¾“å…¥å‚æ•°**: `required_torque` (ä¸€ä¸ªå€¼)
- **è®¡ç®—æ–¹å¼**: ç›´æ¥ä¸æ‰§è¡Œå™¨æ‰­çŸ©æ•°æ®å¯¹æ¯”
- **SFç³»åˆ—**: æ ¹æ®é˜€é—¨ç±»å‹é€‰æ‹©`torque_symmetric`ï¼ˆçƒé˜€ï¼‰æˆ–`torque_canted`ï¼ˆè¶é˜€ï¼‰
- **AT/GYç³»åˆ—**: ä»`torque_data`å¯¹è±¡ä¸­æ ¹æ®å‹åŠ›é”®ï¼ˆå¦‚`"0.4MPa"`ï¼‰è·å–æ‰­çŸ©å€¼

**é€»è¾‘æ­£ç¡®** âœ…

#### å•ä½œç”¨æ‰§è¡Œå™¨ (SR)
- **è¾“å…¥å‚æ•°**: 
  - `requiredOpeningTorque` - å¼€å¯æ‰­çŸ©
  - `requiredClosingTorque` - å…³é—­æ‰­çŸ©
  - `failSafePosition` - æ•…éšœå®‰å…¨ä½ç½®ï¼ˆå¿…éœ€ï¼‰

- **æ‰­çŸ©æ•°æ®ç»“æ„**:
  ```javascript
  torqueData: {
    springTorque: {
      SST: xxx,  // å¼¹ç°§å¤ä½èµ·ç‚¹æ‰­çŸ©
      SRT: xxx,  // å¼¹ç°§å¤ä½è¿è¡Œæ‰­çŸ©
      SET: xxx   // å¼¹ç°§å¤ä½ç»ˆç‚¹æ‰­çŸ©
    },
    airTorque: {
      "0.4MPa": {
        AST: xxx,  // æ°”æºåŠ¨ä½œèµ·ç‚¹æ‰­çŸ©
        ART: xxx,  // æ°”æºåŠ¨ä½œè¿è¡Œæ‰­çŸ©
        AET: xxx   // æ°”æºåŠ¨ä½œç»ˆç‚¹æ‰­çŸ©
      }
    }
  }
  ```

**é€»è¾‘æ­£ç¡®** âœ…

### 2. æ•…éšœå®‰å…¨ä½ç½®é€»è¾‘ âœ“

#### Fail Close (STC) - æ•…éšœå…³é—­
- **å·¥ä½œåŸç†**: å¼¹ç°§å…³é˜€ï¼Œæ°”æºå¼€é˜€
- **éªŒè¯æ¡ä»¶**:
  1. `SET >= requiredClosingTorque Ã— safetyFactor` (å¼¹ç°§èƒ½å…³é—­é˜€é—¨)
  2. `AST >= requiredOpeningTorque Ã— safetyFactor` (æ°”æºèƒ½å¼€å¯é˜€é—¨)

**é€»è¾‘æ­£ç¡®** âœ…

#### Fail Open (STO) - æ•…éšœå¼€å¯
- **å·¥ä½œåŸç†**: å¼¹ç°§å¼€é˜€ï¼Œæ°”æºå…³é˜€
- **éªŒè¯æ¡ä»¶**:
  1. `SST >= requiredOpeningTorque Ã— safetyFactor` (å¼¹ç°§èƒ½å¼€å¯é˜€é—¨)
  2. `AET >= requiredClosingTorque Ã— safetyFactor` (æ°”æºèƒ½å…³é—­é˜€é—¨)

**é€»è¾‘æ­£ç¡®** âœ…

### 3. å®‰å…¨ç³»æ•°åº”ç”¨ âœ“

- **é»˜è®¤å€¼**: 1.3
- **åº”ç”¨æ–¹å¼**: 
  - åŒä½œç”¨: `requiredTorque = valve_torque Ã— safetyFactor`
  - å•ä½œç”¨: åˆ†åˆ«å¯¹å¼€å¯å’Œå…³é—­æ‰­çŸ©åº”ç”¨å®‰å…¨ç³»æ•°

**é€»è¾‘æ­£ç¡®** âœ…

### 4. é˜€é—¨ç±»å‹ä¸è½­æ¶ç±»å‹åŒ¹é… âœ“

#### SFç³»åˆ—ï¼ˆæ‹¨å‰å¼ï¼‰
- **çƒé˜€ (Ball Valve)** â†’ å¯¹ç§°æ‹¨å‰ (`Symmetric`) â†’ å‹å·ä¸å¸¦`/C`
- **è¶é˜€ (Butterfly Valve)** â†’ åå¿ƒæ‹¨å‰ (`Canted`) â†’ å‹å·å¸¦`/C`

**é€»è¾‘æ­£ç¡®** âœ…

#### AT/GYç³»åˆ—ï¼ˆé½¿è½®é½¿æ¡å¼ï¼‰
- **çƒé˜€ (Ball Valve)** â†’ æ—‹è½¬90Â° â†’ æ ‡å‡†å‹å·
- **è¶é˜€ (Butterfly Valve)** â†’ æ—‹è½¬90Â° â†’ æ ‡å‡†å‹å·

**é€»è¾‘æ­£ç¡®** âœ… (ä¿®å¤å)

### 5. å‹å·å‘½åè§„åˆ™ âœ“

#### SFç³»åˆ—
- åŒä½œç”¨: `SF10-150DA` (çƒé˜€) æˆ– `SF10-150DA/C` (è¶é˜€)
- å•ä½œç”¨: `SF10-150SR3-STC` (æ•…éšœå…³) æˆ– `SF10-150SR3-STO` (æ•…éšœå¼€)
- æ¸©åº¦ä»£ç : `SF10-150DA-T1` (ä½æ¸©)

#### AT/GYç³»åˆ—
- åŒä½œç”¨: `AT-DA52` æˆ– `GY-52`
- å•ä½œç”¨: `AT-SR52K8-STC` (æ•…éšœå…³) æˆ– `AT-SR52K8-STO` (æ•…éšœå¼€)
- æ¸©åº¦ä»£ç : `AT-DA52-T1` (ä½æ¸©)

**é€»è¾‘æ­£ç¡®** âœ…

### 6. ä»·æ ¼è®¡ç®—é€»è¾‘ âœ“

#### SFç³»åˆ—
- ä½¿ç”¨`calculatePrice()`æ™ºèƒ½å®šä»·å‡½æ•°
- æ¸©åº¦ä»£ç é`No code`æ—¶ï¼Œä»·æ ¼ä¸Šæµ®5%
- æ”¯æŒæ‰‹åŠ¨æ“ä½œè£…ç½®ä»·æ ¼å åŠ 

#### AT/GYç³»åˆ—
- æ ¹æ®`temperature_type`é€‰æ‹©å¯¹åº”ä»·æ ¼:
  - `normal` â†’ `base_price_normal`
  - `low` â†’ `base_price_low`
  - `high` â†’ `base_price_high`
- æ”¯æŒæ‰‹è½®ä»·æ ¼å åŠ ï¼ˆ`manual_override_price`ï¼‰

**é€»è¾‘æ­£ç¡®** âœ…

---

## ğŸ“Š æ‰­çŸ©åŒ¹é…æµç¨‹éªŒè¯

### åŒä½œç”¨ (DA) æµç¨‹
```
ç”¨æˆ·è¾“å…¥ required_torque (100 Nm)
        â†“
åº”ç”¨å®‰å…¨ç³»æ•° Ã— 1.3 = 130 Nm
        â†“
æŸ¥æ‰¾æ‰§è¡Œå™¨: actual_torque >= 130 Nm
        â†“
SFç³»åˆ—: æ ¹æ®é˜€é—¨ç±»å‹é€‰æ‹©å¯¹ç§°/åå¿ƒæ‹¨å‰æ‰­çŸ©
AT/GYç³»åˆ—: æ ¹æ®å‹åŠ›é”®è·å–æ‰­çŸ©å€¼
        â†“
è¿”å›æ»¡è¶³æ¡ä»¶çš„æ‰§è¡Œå™¨åˆ—è¡¨
```

**æµç¨‹æ­£ç¡®** âœ…

### å•ä½œç”¨ (SR) æµç¨‹
```
ç”¨æˆ·è¾“å…¥:
- requiredOpeningTorque (80 Nm)
- requiredClosingTorque (100 Nm)  
- failSafePosition (Fail Close)
        â†“
Fail CloseéªŒè¯:
  âœ“ SET >= 100 Ã— 1.3 = 130 Nm (å¼¹ç°§èƒ½å…³é˜€)
  âœ“ AST >= 80 Ã— 1.3 = 104 Nm (æ°”æºèƒ½å¼€é˜€)
        â†“
è¿”å›å‹å·: XXX-STC
```

**æµç¨‹æ­£ç¡®** âœ…

---

## ğŸ§ª å»ºè®®çš„æµ‹è¯•åœºæ™¯

### æµ‹è¯•1: SFç³»åˆ—åŒä½œç”¨çƒé˜€é€‰å‹
```javascript
{
  mechanism: 'Scotch Yoke',
  valve_type: 'Ball Valve',
  action_type_preference: 'DA',
  required_torque: 300,
  working_pressure: 0.4,
  working_angle: 90
}
```
**é¢„æœŸ**: è¿”å›SFç³»åˆ—DAå‹å·ï¼Œä¸å¸¦`/C`ï¼Œä½¿ç”¨å¯¹ç§°æ‹¨å‰æ‰­çŸ©

### æµ‹è¯•2: SFç³»åˆ—å•ä½œç”¨è¶é˜€é€‰å‹ï¼ˆæ•…éšœå…³ï¼‰
```javascript
{
  mechanism: 'Scotch Yoke',
  valve_type: 'Butterfly Valve',
  action_type_preference: 'SR',
  requiredOpeningTorque: 200,
  requiredClosingTorque: 250,
  failSafePosition: 'Fail Close',
  working_pressure: 0.5
}
```
**é¢„æœŸ**: è¿”å›SFç³»åˆ—SRå‹å·ï¼Œå¸¦`/C-STC`ï¼Œä½¿ç”¨åå¿ƒæ‹¨å‰æ‰­çŸ©

### æµ‹è¯•3: ATç³»åˆ—åŒä½œç”¨çƒé˜€é€‰å‹
```javascript
{
  mechanism: 'Rack & Pinion',
  valve_type: 'Ball Valve',
  action_type_preference: 'DA',
  material_type: 'Aluminum Alloy',
  required_torque: 50,
  working_pressure: 0.4,
  temperature_type: 'normal'
}
```
**é¢„æœŸ**: è¿”å›AT-DAç³»åˆ—å‹å·ï¼Œä½¿ç”¨å¸¸æ¸©ä»·æ ¼

### æµ‹è¯•4: GYç³»åˆ—å•ä½œç”¨çƒé˜€é€‰å‹ï¼ˆæ•…éšœå¼€ï¼‰
```javascript
{
  mechanism: 'Rack & Pinion',
  valve_type: 'Ball Valve',
  action_type_preference: 'SR',
  material_type: 'Stainless Steel',
  requiredOpeningTorque: 100,
  requiredClosingTorque: 120,
  failSafePosition: 'Fail Open',
  working_pressure: 0.6
}
```
**é¢„æœŸ**: è¿”å›GY-SRç³»åˆ—å‹å·ï¼Œå¸¦`-STO`åç¼€

---

## ğŸ“ ä¿®å¤æ€»ç»“

### ä¿®å¤å†…å®¹
1. âœ… ä¿®å¤AT/GYç³»åˆ—é˜€é—¨ç±»å‹éªŒè¯é€»è¾‘ï¼ˆä»é—¸é˜€/æˆªæ­¢é˜€æ”¹ä¸ºçƒé˜€/è¶é˜€ï¼‰
2. âœ… ç»Ÿä¸€å‰åç«¯é˜€é—¨ç±»å‹å®šä¹‰
3. âœ… æ›´æ–°éªŒè¯é”™è¯¯æç¤ºä¿¡æ¯

### éªŒè¯é€šè¿‡çš„åŠŸèƒ½
1. âœ… æ‰­çŸ©è®¡ç®—é€»è¾‘ï¼ˆåŒä½œç”¨ã€å•ä½œç”¨ï¼‰
2. âœ… æ•…éšœå®‰å…¨ä½ç½®é€»è¾‘ï¼ˆFail Closeã€Fail Openï¼‰
3. âœ… å®‰å…¨ç³»æ•°åº”ç”¨
4. âœ… é˜€é—¨ç±»å‹ä¸è½­æ¶ç±»å‹åŒ¹é…
5. âœ… å‹å·å‘½åè§„åˆ™
6. âœ… ä»·æ ¼è®¡ç®—é€»è¾‘
7. âœ… æ¸©åº¦ä»£ç å’Œæè´¨é€‰æ‹©

### é£é™©è¯„ä¼°
- **é£é™©ç­‰çº§**: æ— ï¼ˆå·²ä¿®å¤å…³é”®é”™è¯¯ï¼‰
- **å»ºè®®**: éƒ¨ç½²åè¿›è¡Œå®Œæ•´çš„å›å½’æµ‹è¯•

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. âœ… å·²ä¿®å¤ä»£ç 
2. â³ éœ€è¦æäº¤åˆ°Git
3. â³ éœ€è¦éƒ¨ç½²åˆ°Cloudflare Pages
4. â³ å»ºè®®è¿›è¡ŒåŠŸèƒ½æµ‹è¯•

**ä¿®å¤çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: â³ å¾…æµ‹è¯•  
**éƒ¨ç½²çŠ¶æ€**: â³ å¾…éƒ¨ç½²

