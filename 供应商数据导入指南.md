# 供应商数据导入指南

## 📋 概述

本指南将帮助您准备和导入供应商数据到系统中。提供了Excel模板、导入脚本和详细的使用说明。

---

## 📁 文件位置

- **Excel模板**: `backend/templates/suppliers_import_template.csv`
- **导入脚本**: `backend/import_suppliers.js`
- **供应商模型**: `backend/models/Supplier.js`

---

## 📊 数据字段说明

### 必填字段

| 字段名 | 说明 | 示例 |
|--------|------|------|
| **name** | 供应商名称 | 北京XX阀门有限公司 |

### 可选字段

| 字段名 | 说明 | 示例 | 默认值 |
|--------|------|------|--------|
| contact_person | 联系人姓名 | 张三 | - |
| phone | 联系电话 | 010-12345678 或 13800138000 | - |
| email | 电子邮箱 | zhangsan@example.com | - |
| address | 公司地址 | 北京市朝阳区XX路XX号 | - |
| business_scope | 业务范围 | 阀门执行器、配件、传感器 | - |
| rating | 供应商评级 (1-5) | 5 | 3 |
| status | 状态 | active, inactive, blacklisted | active |
| notes | 备注信息 | 质量可靠，价格合理 | - |

---

## 📝 字段详细说明

### 1. name（供应商名称）
- **必填**: 是
- **类型**: 文本
- **说明**: 供应商的公司名称或简称
- **示例**: 
  - 北京XX阀门制造有限公司
  - 上海YY自动化设备公司
  - ZZ国际贸易

### 2. contact_person（联系人）
- **必填**: 否
- **类型**: 文本
- **说明**: 主要联系人姓名
- **示例**: 张三、李经理、王总

### 3. phone（联系电话）
- **必填**: 否
- **类型**: 文本
- **说明**: 固定电话或手机号码
- **格式**: 无特定要求，建议使用标准格式
- **示例**: 
  - 010-12345678
  - 13800138000
  - 021-87654321

### 4. email（电子邮箱）
- **必填**: 否
- **类型**: 文本（邮箱格式）
- **说明**: 供应商联系邮箱
- **验证**: 必须符合邮箱格式（xxx@xxx.xxx）
- **示例**: 
  - contact@supplier.com
  - sales@company.com.cn
  - zhangsan@example.com

### 5. address（公司地址）
- **必填**: 否
- **类型**: 文本
- **说明**: 供应商公司地址
- **示例**: 
  - 北京市朝阳区建国路88号SOHO现代城A座1501室
  - 上海市浦东新区张江高科技园区

### 6. business_scope（业务范围）
- **必填**: 否
- **类型**: 文本
- **说明**: 供应商的主营业务或产品范围
- **示例**: 
  - 阀门执行器、气动元件
  - 密封件、传感器、控制系统
  - 阀门配件、维修服务

### 7. rating（供应商评级）
- **必填**: 否
- **类型**: 整数 (1-5)
- **说明**: 对供应商的综合评价
- **默认值**: 3
- **评级标准**:
  - **5星**: 优秀 - 质量优异，服务一流，价格合理
  - **4星**: 良好 - 质量稳定，服务及时
  - **3星**: 一般 - 基本满足需求
  - **2星**: 较差 - 存在一些问题
  - **1星**: 差 - 不推荐使用
- **示例**: 5, 4, 3

### 8. status（状态）
- **必填**: 否
- **类型**: 枚举值
- **默认值**: active
- **可选值**:
  - **active**: 活跃 - 正在合作的供应商
  - **inactive**: 停用 - 暂时停止合作
  - **blacklisted**: 黑名单 - 禁止合作
- **示例**: active

### 9. notes（备注）
- **必填**: 否
- **类型**: 文本
- **说明**: 关于供应商的其他备注信息
- **示例**: 
  - 质量可靠，价格合理，交货及时
  - 需要提前7天下单
  - 主要供应AT系列执行器

---

## 🚀 使用步骤

### 步骤 1: 下载Excel模板

模板位置: `backend/templates/suppliers_import_template.csv`

**方式一**: 直接打开编辑
```bash
open backend/templates/suppliers_import_template.csv
```

**方式二**: 复制模板
```bash
cp backend/templates/suppliers_import_template.csv my_suppliers.csv
```

### 步骤 2: 填写供应商数据

1. 使用Excel、WPS或其他表格软件打开CSV文件
2. 删除模板中的示例数据（前3行）
3. 填写您的真实供应商数据
4. 确保**name（供应商名称）**字段不为空
5. 检查**email**字段格式是否正确
6. 确保**rating**字段为1-5的整数
7. 确保**status**字段为 active、inactive 或 blacklisted
8. 保存文件（保持CSV格式）

### 步骤 3: 运行导入脚本

**基本导入** (跳过重复数据):
```bash
cd backend
node import_suppliers.js my_suppliers.csv
```

**更新已存在数据**:
```bash
node import_suppliers.js my_suppliers.csv --update
```

**清空后重新导入**:
```bash
node import_suppliers.js my_suppliers.csv --clear
```

**使用默认模板导入**:
```bash
node import_suppliers.js
```

### 步骤 4: 查看导入结果

导入完成后，脚本会显示详细的统计信息：
- 总读取数据量
- 成功新增数量
- 成功更新数量
- 跳过重复数量
- 导入失败数量
- 验证错误数量

---

## 📋 导入示例

### 示例数据

```csv
name,contact_person,phone,email,address,business_scope,rating,status,notes
北京XX阀门制造有限公司,张经理,010-12345678,zhang@xx-valve.com,北京市朝阳区建国路88号,阀门执行器、气动元件,5,active,质量优异，价格合理，交货及时
上海YY自动化设备公司,李工,13800138001,li@yy-auto.com,上海市浦东新区张江高科技园区,控制系统、传感器,4,active,技术实力强
深圳ZZ国际贸易,王总,0755-88888888,wang@zz-trade.com,深圳市南山区科技园,进口阀门配件,3,inactive,价格偏高，暂停合作
广州AA密封科技,刘工,020-66666666,liu@aa-seal.com,广州市天河区珠江新城,密封件、O型圈,4,active,密封件质量好
天津BB机械,赵经理,022-55555555,zhao@bb-mech.com,天津市滨海新区,阀门维修、改造,3,active,维修服务及时
```

### 导入输出示例

```
╔═══════════════════════════════════════════════╗
║         供应商数据批量导入工具               ║
╚═══════════════════════════════════════════════╝

✅ MongoDB 已连接
📄 读取文件: my_suppliers.csv

📊 读取完成: 共 5 条有效数据

💾 开始导入数据...

  ✅ 新增: 北京XX阀门制造有限公司
  ✅ 新增: 上海YY自动化设备公司
  ✅ 新增: 深圳ZZ国际贸易
  ✅ 新增: 广州AA密封科技
  ✅ 新增: 天津BB机械

╔═══════════════════════════════════════════════╗
║              导入结果统计                    ║
╠═══════════════════════════════════════════════╣
║  总读取数据: 5                               ║
║  成功新增: 5                                 ║
╚═══════════════════════════════════════════════╝

📊 数据库统计:
  总供应商数: 5
  活跃供应商: 4
  停用供应商: 1

✅ 导入完成！

👋 数据库连接已关闭
```

---

## ⚠️ 常见问题

### 问题 1: 邮箱格式错误

**错误信息**:
```
行 3 (XX供应商):
  ❌ 邮箱格式不正确
```

**解决方法**: 确保邮箱格式为 `xxx@xxx.xxx`

---

### 问题 2: 评级超出范围

**错误信息**:
```
行 4 (YY供应商):
  ❌ 评级必须是1-5之间的整数
```

**解决方法**: 将rating字段修改为1、2、3、4或5

---

### 问题 3: 状态值错误

**错误信息**:
```
行 5 (ZZ供应商):
  ❌ 状态必须是 active, inactive 或 blacklisted
```

**解决方法**: 将status字段修改为 active、inactive 或 blacklisted

---

### 问题 4: 供应商名称为空

**错误信息**:
```
行 6 ():
  ❌ 供应商名称为必填项
```

**解决方法**: 填写供应商名称

---

### 问题 5: 重复的供应商名称

**输出信息**:
```
⏭️  跳过: XX供应商 (已存在)
```

**解决方法**: 
- 如需更新: 使用 `--update` 参数
- 如需重新导入: 使用 `--clear` 参数
- 如需跳过: 默认行为，无需操作

---

## 🔧 命令行参数

### 基本用法
```bash
node import_suppliers.js [CSV文件路径] [选项]
```

### 可用选项

| 参数 | 说明 |
|------|------|
| `--update` | 更新已存在的供应商（默认跳过重复） |
| `--clear` | 导入前清空所有供应商数据 |
| `--no-skip` | 不跳过重复数据（会报错） |
| `--help, -h` | 显示帮助信息 |

### 使用示例

**使用默认模板**:
```bash
node import_suppliers.js
```

**指定CSV文件**:
```bash
node import_suppliers.js data/suppliers.csv
```

**更新已存在数据**:
```bash
node import_suppliers.js data/suppliers.csv --update
```

**清空后重新导入**:
```bash
node import_suppliers.js data/suppliers.csv --clear
```

**查看帮助**:
```bash
node import_suppliers.js --help
```

---

## 📊 数据验证规则

导入脚本会自动验证以下内容：

1. ✅ **供应商名称不为空**
2. ✅ **邮箱格式正确** (如果提供)
3. ✅ **评级在1-5之间** (如果提供)
4. ✅ **状态值合法** (active/inactive/blacklisted)

验证失败的数据会被跳过，并在控制台显示详细的错误信息。

---

## 💡 最佳实践

### 1. 数据准备
- 在Excel中准备数据时，建议先保存为`.xlsx`格式
- 确认数据无误后，再"另存为"`.csv`格式
- UTF-8编码可以确保中文正确显示

### 2. 批量导入
- 首次导入建议先用几条测试数据验证
- 确认无误后再导入全部数据
- 导入前建议备份现有数据

### 3. 数据更新
- 使用`--update`参数可以更新已存在的供应商
- 更新前确认数据准确性
- 重要数据更新建议先测试

### 4. 数据维护
- 定期更新供应商评级
- 及时更新联系方式
- 不再合作的供应商标记为inactive或blacklisted

---

## 🔍 后续操作

导入成功后，您可以：

1. **在管理后台查看供应商**:
   - 访问: `http://localhost:5173/admin`
   - 进入"供应商管理"模块

2. **在供应商管理页面查看**:
   - 访问: `http://localhost:5173/suppliers`
   - 查看、编辑、删除供应商

3. **在系统中使用供应商数据**:
   - 创建报价时选择供应商
   - 生成采购订单时关联供应商
   - 查看供应商历史记录

---

## 📞 技术支持

如果在导入过程中遇到问题：

1. 检查CSV文件格式是否正确
2. 查看控制台错误信息
3. 参考本文档的"常见问题"部分
4. 检查MongoDB连接是否正常
5. 确认数据库权限是否足够

---

## 📚 相关文档

- [供应商管理API文档](./供应商管理API文档.md)
- [供应商管理系统实施总结](./供应商管理系统实施总结.md)
- [完整API文档](./完整API文档.md)

---

**最后更新**: 2025年10月27日  
**版本**: v1.0.0


