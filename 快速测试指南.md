# ğŸš€ å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ä¸€é”®æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰

### æ­¥éª¤ 1: å¯åŠ¨åç«¯æœåŠ¡å™¨

æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œï¼š
```bash
cd "/Users/hexiaoxiao/Desktop/Model Selection System/backend"
npm run dev
```

**çœ‹åˆ°è¿™ä¸ªè¯´æ˜æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ**:
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   C-MAX Actuator Selection System - Backend API       â•‘
â•‘   Server running on port 5001                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MongoDB Connected: localhost
```

### æ­¥éª¤ 2: åˆ›å»ºæµ‹è¯•æ•°æ®

**æ‰“å¼€æ–°çš„ç»ˆç«¯çª—å£**ï¼Œè¿è¡Œï¼š
```bash
cd "/Users/hexiaoxiao/Desktop/Model Selection System/backend"

# åˆ›å»ºç”¨æˆ·è´¦å·
npm run seed

# åˆ›å»ºæ‰§è¡Œå™¨å’Œæ‰‹åŠ¨æ“ä½œè£…ç½®æ•°æ®
npm run seed-new
```

### æ­¥éª¤ 3: è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•

åœ¨åŒä¸€ä¸ªç»ˆç«¯è¿è¡Œï¼š
```bash
./test-api.sh
```

**âœ… å¦‚æœçœ‹åˆ° "æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼" è¯´æ˜ç³»ç»Ÿå·¥ä½œæ­£å¸¸ï¼**

---

## æ‰‹åŠ¨æµ‹è¯•ï¼ˆä½¿ç”¨ curlï¼‰

### 1. ç™»å½•è·å– Token

```bash
curl -X POST http://localhost:5001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@cmax.com",
    "password": "admin123"
  }'
```

**å¤åˆ¶è¿”å›çš„ tokenï¼Œåœ¨åç»­è¯·æ±‚ä¸­ä½¿ç”¨ï¼**

### 2. æŸ¥çœ‹æ‰€æœ‰æ‰§è¡Œå™¨

```bash
# æ›¿æ¢ YOUR_TOKEN ä¸ºä¸Šä¸€æ­¥è·å–çš„ token
curl -X GET http://localhost:5001/api/actuators \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### 3. æ™ºèƒ½æ‰­çŸ©æŸ¥æ‰¾ ğŸ”

```bash
curl -X POST http://localhost:5001/api/actuators/find-by-torque \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "required_torque": 500,
    "pressure": 0.4,
    "angle": 0,
    "yoke_type": "symmetric"
  }'
```

**ç³»ç»Ÿä¼šè‡ªåŠ¨æ¨èæœ€åˆé€‚çš„æ‰§è¡Œå™¨å‹å·ï¼**

### 4. åˆ›å»ºé¡¹ç›®

```bash
curl -X POST http://localhost:5001/api/new-projects \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "project_name": "æˆ‘çš„æµ‹è¯•é¡¹ç›®",
    "client_name": "æµ‹è¯•å®¢æˆ·å…¬å¸"
  }'
```

**ä¿å­˜è¿”å›çš„é¡¹ç›® IDï¼**

### 5. ä¸€é”®è‡ªåŠ¨é€‰å‹ ğŸ¤–

```bash
# æ›¿æ¢ PROJECT_ID ä¸ºä¸Šä¸€æ­¥è¿”å›çš„é¡¹ç›® ID
curl -X POST http://localhost:5001/api/new-projects/PROJECT_ID/auto-select \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "tag_number": "V-001",
    "required_torque": 600,
    "working_pressure": 0.5,
    "working_angle": 0,
    "yoke_type": "symmetric",
    "needs_manual_override": true
  }'
```

**ç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©æ‰§è¡Œå™¨å’Œæ‰‹åŠ¨æ“ä½œè£…ç½®ï¼Œå¹¶è®¡ç®—æ€»ä»·ï¼**

---

## ä½¿ç”¨ Postman æµ‹è¯•ï¼ˆæ¨èï¼‰

### è®¾ç½®ç¯å¢ƒå˜é‡

1. åˆ›å»ºæ–°çš„ç¯å¢ƒ "C-MAX Local"
2. æ·»åŠ å˜é‡ï¼š
   - `base_url` = `http://localhost:5001`
   - `token` = (ç™»å½•åè·å–)

### å¯¼å…¥æµ‹è¯•é›†åˆ

1. æ–°å»º Collection: "C-MAX API Tests"
2. åœ¨ Collection çš„ Authorization ä¸­é€‰æ‹© "Bearer Token"
3. Token å€¼ä½¿ç”¨: `{{token}}`

### æ·»åŠ è¯·æ±‚

#### 1. ç™»å½•
- Method: POST
- URL: `{{base_url}}/api/auth/login`
- Body (JSON):
```json
{
  "email": "admin@cmax.com",
  "password": "admin123"
}
```
- Tests (è‡ªåŠ¨ä¿å­˜ token):
```javascript
if (pm.response.code === 200) {
    const response = pm.response.json();
    pm.environment.set("token", response.token);
}
```

#### 2. è·å–æ‰§è¡Œå™¨
- Method: GET
- URL: `{{base_url}}/api/actuators`
- Authorization: Inherit from parent

#### 3. æ‰­çŸ©æŸ¥æ‰¾
- Method: POST
- URL: `{{base_url}}/api/actuators/find-by-torque`
- Body (JSON):
```json
{
  "required_torque": 500,
  "pressure": 0.4,
  "angle": 0,
  "yoke_type": "symmetric"
}
```

---

## å¸¸è§æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: å°å‹é˜€é—¨é€‰å‹
**éœ€æ±‚**: 300Nm æ‰­çŸ©ï¼Œ0.3 MPa å‹åŠ›

```bash
{
  "required_torque": 300,
  "pressure": 0.3,
  "angle": 0,
  "yoke_type": "symmetric"
}
```

**é¢„æœŸç»“æœ**: SF10-150DA (å®é™…æ‰­çŸ©: 309Nm)

### åœºæ™¯ 2: ä¸­å‹é˜€é—¨é€‰å‹
**éœ€æ±‚**: 1000Nm æ‰­çŸ©ï¼Œ0.5 MPa å‹åŠ›

```bash
{
  "required_torque": 1000,
  "pressure": 0.5,
  "angle": 0,
  "yoke_type": "symmetric"
}
```

**é¢„æœŸç»“æœ**: SF14-400DA (å®é™…æ‰­çŸ©: 1430Nm)

### åœºæ™¯ 3: å¤§å‹é˜€é—¨é€‰å‹ï¼ˆå€¾æ–œè½­æ¶ï¼‰
**éœ€æ±‚**: 2000Nm æ‰­çŸ©ï¼Œ0.5 MPa å‹åŠ›ï¼Œå€¾æ–œè½­æ¶

```bash
{
  "required_torque": 2000,
  "pressure": 0.5,
  "angle": 0,
  "yoke_type": "canted"
}
```

**é¢„æœŸç»“æœ**: SF16-600DA (å®é™…æ‰­çŸ©: 2316Nm)

---

## æµ‹è¯•æ•°æ®è¯´æ˜

### å¯ç”¨çš„æ‰§è¡Œå™¨å‹å·

| å‹å· | æœ¬ä½“å°ºå¯¸ | ä½œç”¨ç±»å‹ | ä»·æ ¼ | é€‚ç”¨åœºæ™¯ |
|------|---------|---------|------|---------|
| SF10-150DA | SF10 | åŒä½œç”¨ | Â¥5,000 | å°å‹é˜€é—¨ |
| SF12-250SR | SF12 | å¼¹ç°§å¤ä½ | Â¥6,500 | ä¸­å‹é˜€é—¨ |
| SF14-400DA | SF14 | åŒä½œç”¨ | Â¥8,500 | ä¸­å¤§å‹é˜€é—¨ |
| SF16-600DA | SF16 | åŒä½œç”¨ | Â¥12,000 | å¤§å‹é˜€é—¨ |
| SF20-1000DA | SF20 | åŒä½œç”¨ | Â¥18,000 | è¶…å¤§å‹é˜€é—¨ |

### å¯ç”¨çš„æ‰‹åŠ¨æ“ä½œè£…ç½®

| å‹å· | åç§° | ä»·æ ¼ | å…¼å®¹å°ºå¯¸ |
|------|------|------|---------|
| HG | æ‰‹è½®è£…ç½®(æ ‡å‡†) | Â¥800 | SF10, SF12, SF14 |
| HW | æ‰‹è½®è£…ç½®(åŠ é•¿) | Â¥1,200 | SF14, SF16, SF20 |
| HL | æ‰‹æŸ„è£…ç½® | Â¥600 | SF10, SF12 |
| HC | é“¾è½®è£…ç½® | Â¥1,500 | SF12, SF14, SF16 |
| HWG | èœ—è½®ç®± | Â¥2,500 | SF16, SF20 |

### æµ‹è¯•è´¦å·

| è§’è‰² | é‚®ç®± | å¯†ç  |
|------|------|------|
| ç®¡ç†å‘˜ | admin@cmax.com | admin123 |
| å·¥ç¨‹å¸ˆ | john@cmax.com | engineer123 |
| é”€å”®ç»ç† | sarah@cmax.com | sales123 |

---

## æ‰­çŸ©æ•°æ®é”®æ ¼å¼è¯´æ˜

**å‹åŠ›å’Œè§’åº¦ç»„åˆ**:
- é”®æ ¼å¼: `{å‹åŠ›}_{è§’åº¦}`
- ç¤ºä¾‹: `0_4_0` è¡¨ç¤º 0.4 MPa å‹åŠ›ï¼Œ0Â° è§’åº¦
- ç¤ºä¾‹: `0_5_15` è¡¨ç¤º 0.5 MPa å‹åŠ›ï¼Œ15Â° è§’åº¦

**å¯ç”¨çš„å‹åŠ›å€¼**: 0.3, 0.4, 0.5, 0.6 (MPa)  
**å¯ç”¨çš„è§’åº¦å€¼**: 0, 15 (åº¦)

---

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: è¿æ¥è¢«æ‹’ç»
**é”™è¯¯**: `curl: (7) Failed to connect`

**è§£å†³**:
```bash
# æ£€æŸ¥åç«¯æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
ps aux | grep node

# å¦‚æœæ²¡æœ‰è¿è¡Œï¼Œå¯åŠ¨å®ƒ
cd backend && npm run dev
```

### é—®é¢˜ 2: 401 Unauthorized
**é”™è¯¯**: `{"message": "Not authorized, no token"}`

**è§£å†³**: ç¡®ä¿åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«æ­£ç¡®çš„ token
```bash
-H "Authorization: Bearer YOUR_TOKEN"
```

### é—®é¢˜ 3: MongoDB è¿æ¥å¤±è´¥
**é”™è¯¯**: `MongoNetworkError`

**è§£å†³**:
```bash
# å¯åŠ¨ MongoDB
brew services start mongodb-community

# æ£€æŸ¥ MongoDB çŠ¶æ€
brew services list | grep mongodb
```

### é—®é¢˜ 4: æœªæ‰¾åˆ°æ»¡è¶³è¦æ±‚çš„æ‰§è¡Œå™¨
**é”™è¯¯**: `{"message": "æœªæ‰¾åˆ°æ»¡è¶³è¦æ±‚çš„æ‰§è¡Œå™¨"}`

**åŸå› **: 
- æ‰­çŸ©è¦æ±‚è¶…è¿‡æ‰€æœ‰å¯ç”¨æ‰§è¡Œå™¨
- å‹åŠ›/è§’åº¦ç»„åˆæ²¡æœ‰æ•°æ®

**è§£å†³**: è°ƒæ•´æŸ¥è¯¢å‚æ•°æˆ–æ·»åŠ æ›´å¤šæ‰§è¡Œå™¨æ•°æ®

---

## ğŸ“š æ›´å¤šèµ„æº

- **å®Œæ•´ API æ–‡æ¡£**: æŸ¥çœ‹ `æ–°APIæ–‡æ¡£.md`
- **è¯¦ç»†æµ‹è¯•æŒ‡å—**: æŸ¥çœ‹ `APIæµ‹è¯•æŒ‡å—.md`
- **æµ‹è¯•ç»“æœæŠ¥å‘Š**: æŸ¥çœ‹ `æµ‹è¯•ç»“æœæŠ¥å‘Š.md`

---

## ğŸ¯ å¿«é€Ÿæµ‹è¯•æ¸…å•

- [ ] åç«¯æœåŠ¡å™¨å·²å¯åŠ¨ (port 5001)
- [ ] MongoDB å·²è¿è¡Œ
- [ ] å·²åˆ›å»ºç”¨æˆ·æ•°æ® (`npm run seed`)
- [ ] å·²åˆ›å»ºæ‰§è¡Œå™¨æ•°æ® (`npm run seed-new`)
- [ ] èƒ½æˆåŠŸç™»å½•è·å– token
- [ ] èƒ½è·å–æ‰§è¡Œå™¨åˆ—è¡¨
- [ ] èƒ½è¿›è¡Œæ‰­çŸ©æŸ¥æ‰¾
- [ ] èƒ½åˆ›å»ºé¡¹ç›®
- [ ] èƒ½ä½¿ç”¨è‡ªåŠ¨é€‰å‹åŠŸèƒ½
- [ ] è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬é€šè¿‡ (`./test-api.sh`)

**å…¨éƒ¨å®Œæˆï¼Ÿæ­å–œï¼ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼** ğŸ‰


