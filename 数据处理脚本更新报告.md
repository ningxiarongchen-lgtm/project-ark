# æ•°æ®å¤„ç†è„šæœ¬æ›´æ–°æŠ¥å‘Š

## æ›´æ–°æ—¶é—´
2025-10-28

## æ›´æ–°ç›®æ ‡
æ ¹æ®æ–°çš„å®šä»·æ¨¡å‹æ¶æ„ï¼Œæ›´æ–°æ‰€æœ‰æ•°æ®å¯¼å…¥å’Œè¿ç§»è„šæœ¬ï¼Œä½¿å…¶èƒ½å¤Ÿæ­£ç¡®å¤„ç†å›ºå®šä»·æ ¼æ¨¡å¼ï¼ˆfixedï¼‰å’Œé˜¶æ¢¯ä»·æ ¼æ¨¡å¼ï¼ˆtieredï¼‰ã€‚

---

## ä¸€ã€æ•°æ®å¯¼å…¥è„šæœ¬æ›´æ–°

### 1. seed.js âœ… ï¼ˆå·²å®Œæˆï¼‰

**çŠ¶æ€**: å·²ç»åŒ…å«å®Œæ•´çš„å®šä»·æ¨¡å¼æ™ºèƒ½åˆ¤æ–­é€»è¾‘ï¼Œæ— éœ€ä¿®æ”¹

**æ ¸å¿ƒé€»è¾‘** (ç¬¬98-136è¡Œ):
- âœ… æ£€æŸ¥ Excel ä¸­æ˜¯å¦æä¾›äº†é˜¶æ¢¯ä»·æ ¼åˆ—ï¼ˆqty_1, price_1 ç­‰ï¼‰
- âœ… å¦‚æœæœ‰é˜¶æ¢¯ä»·æ ¼ â†’ è®¾ç½® `pricing_model = 'tiered'`ï¼Œè§£æåˆ° `price_tiers` æ•°ç»„
- âœ… å¦‚æœåªæœ‰å•ä¸€ä»·æ ¼ â†’ è®¾ç½® `pricing_model = 'fixed'`ï¼Œä»·æ ¼å­˜å…¥ `base_price`
- âœ… å¦‚æœé˜¶æ¢¯ä»·æ ¼è§£æå¤±è´¥ â†’ è‡ªåŠ¨å›é€€åˆ°å›ºå®šä»·æ ¼æ¨¡å¼

**æ”¯æŒçš„ CSV åˆ—æ ¼å¼**:
```
# å›ºå®šä»·æ ¼æ¨¡å¼
base_price æˆ– price

# é˜¶æ¢¯ä»·æ ¼æ¨¡å¼
qty_1, price_1, price_type_1, notes_1
qty_2, price_2, price_type_2, notes_2
...
```

---

### 2. seed_at_gy.js âœ… ï¼ˆå·²æ›´æ–°ï¼‰

**æ›´æ–°å†…å®¹**:
- âœ… æ·»åŠ äº†å®Œæ•´çš„å®šä»·æ¨¡å¼æ™ºèƒ½åˆ¤æ–­é€»è¾‘ï¼ˆç¬¬103-141è¡Œï¼‰
- âœ… æ”¯æŒä» CSV è§£æé˜¶æ¢¯ä»·æ ¼æ•°æ®
- âœ… æ ¹æ®æ˜¯å¦æœ‰å¤šä¸ªä»·æ ¼åˆ—è‡ªåŠ¨è®¾ç½® `pricing_model`
- âœ… å¦‚æœæœ‰é˜¶æ¢¯ä»·æ ¼åˆ™è§£æåˆ° `price_tiers`ï¼Œå¦åˆ™å­˜å…¥ `base_price`

**å¤„ç†æµç¨‹**:
1. è¯»å– CSV æ–‡ä»¶ `at_gy_actuators_data.csv`
2. æ£€æŸ¥æ˜¯å¦æœ‰é˜¶æ¢¯ä»·æ ¼åˆ—ï¼ˆqty_X, price_Xï¼‰
3. å¦‚æœæœ‰ï¼š
   - è®¾ç½® `pricing_model = 'tiered'`
   - è§£ææ‰€æœ‰ä»·æ ¼æ¡£ä½åˆ° `price_tiers` æ•°ç»„
   - å¦‚æœè§£æå¤±è´¥ï¼Œå›é€€åˆ°å›ºå®šä»·æ ¼æ¨¡å¼
4. å¦‚æœæ²¡æœ‰ï¼š
   - è®¾ç½® `pricing_model = 'fixed'`
   - ä»·æ ¼å­˜å…¥ `base_price`

**æ”¯æŒçš„ä»·æ ¼å­—æ®µ**:
- `qty_1` ~ `qty_5` æˆ– `min_quantity_1` ~ `min_quantity_5`
- `price_1` ~ `price_5` æˆ– `unit_price_1` ~ `unit_price_5`
- `price_type_1` ~ `price_type_5` (å¯é€‰)
- `notes_1` ~ `notes_5` (å¯é€‰)

---

### 3. seed_at_gy_final.js âœ… ï¼ˆå·²æ›´æ–°ï¼‰

**æ›´æ–°å†…å®¹**:
- âœ… æ·»åŠ äº†é«˜çº§å®šä»·æ¨¡å¼æ™ºèƒ½åˆ¤æ–­é€»è¾‘ï¼ˆç¬¬189-267è¡Œï¼‰
- âœ… æ”¯æŒå¤šç§ä»·æ ¼æ ¼å¼ï¼ˆé˜¶æ¢¯ä»·æ ¼ã€ä½/æ ‡å‡†/é«˜ä»·æ ¼ï¼‰
- âœ… ä¿ç•™äº†å‘åå…¼å®¹çš„ `pricing` å¯¹è±¡
- âœ… åŒæ—¶ç»´æŠ¤ `base_price` å’Œ `price_tiers`

**ç‰¹æ®Šå¤„ç†**:
1. **é˜¶æ¢¯ä»·æ ¼ä¼˜å…ˆ**: å¦‚æœ CSV ä¸­æœ‰ `qty_X` å’Œ `price_X` åˆ—ï¼Œä¼˜å…ˆè§£æä¸ºé˜¶æ¢¯ä»·æ ¼
2. **ä»·æ ¼èŒƒå›´è½¬æ¢**: å¦‚æœæœ‰ `base_price_low`ã€`base_price_normal`ã€`base_price_high`ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºé˜¶æ¢¯ä»·æ ¼ï¼š
   ```javascript
   price_tiers: [
     { min_quantity: 10, unit_price: basePriceLow, price_type: 'low' },
     { min_quantity: 1, unit_price: basePriceNormal, price_type: 'normal' },
     { min_quantity: 1, unit_price: basePriceHigh, price_type: 'high' }
   ]
   ```
3. **ä¿ç•™ base_price**: å³ä½¿è®¾ç½®äº†é˜¶æ¢¯ä»·æ ¼ï¼Œä¹Ÿä¼šä¿ç•™ `base_price` å­—æ®µï¼ˆä½¿ç”¨æ ‡å‡†ä»·æ ¼ï¼‰
4. **å‘åå…¼å®¹**: ä¿å­˜é¢å¤–çš„ä»·æ ¼ä¿¡æ¯åˆ° `pricing` å¯¹è±¡ï¼ŒåŒ…å«ï¼š
   - base_price_normal
   - base_price_low
   - base_price_high
   - manual_override_model
   - manual_override_price
   - seal_kit_price

**åˆ¤æ–­é€»è¾‘**:
```javascript
// å¦‚æœæ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶ï¼Œè§†ä¸ºé˜¶æ¢¯å®šä»·ï¼š
- æœ‰ qty_X å’Œ price_X åˆ—
- åŒæ—¶æœ‰ basePriceLow å’Œ basePriceHigh
```

---

### 4. seed_mock_suppliers.js â„¹ï¸ ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

**è¯´æ˜**: æ­¤è„šæœ¬ä»…ç”¨äºå¯¼å…¥ä¾›åº”å•†åŸºæœ¬ä¿¡æ¯ï¼Œä¸æ¶‰åŠäº§å“å®šä»·ï¼Œæ— éœ€ä¿®æ”¹ã€‚

---

### 5. seed_test_ticket.js â„¹ï¸ ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

**è¯´æ˜**: æ­¤è„šæœ¬ç”¨äºåˆ›å»ºæµ‹è¯•å”®åå·¥å•ï¼Œä¸æ¶‰åŠäº§å“å®šä»·ï¼Œæ— éœ€ä¿®æ”¹ã€‚

---

### 6. import_suppliers.js â„¹ï¸ ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

**è¯´æ˜**: æ­¤è„šæœ¬ç”¨äºæ‰¹é‡å¯¼å…¥ä¾›åº”å•†æ•°æ®ï¼Œä¸æ¶‰åŠäº§å“å®šä»·ï¼Œæ— éœ€ä¿®æ”¹ã€‚

---

## äºŒã€æ•°æ®è¿ç§»è„šæœ¬æ›´æ–°

### migration_price_tiers.js âœ… ï¼ˆå·²æ­£ç¡®å®ç°ï¼‰

**å½“å‰çŠ¶æ€**: å·²æŒ‰ç…§æ–°éœ€æ±‚æ­£ç¡®å®ç°ï¼Œæ— éœ€ä¿®æ”¹

**æ ¸å¿ƒé€»è¾‘**:
1. âœ… éå†æ‰€æœ‰æ‰§è¡Œå™¨å’Œé…ä»¶æ–‡æ¡£
2. âœ… **ä¿ç•™** `base_price` å­—æ®µï¼ˆä¸åˆ é™¤ï¼‰
3. âœ… **æ–°å¢** `pricing_model` å­—æ®µï¼š
   - å¦‚æœæ–‡æ¡£æœ‰ `price_tiers` ä¸”é•¿åº¦ > 0 â†’ è®¾ç½®ä¸º `'tiered'`
   - å¦‚æœæœ‰ `base_price_low` æˆ– `base_price_high` â†’ è®¾ç½®ä¸º `'tiered'`
   - å¦åˆ™ â†’ è®¾ç½®ä¸º `'fixed'`ï¼ˆé»˜è®¤ï¼‰
4. âœ… å¦‚æœæ˜¯å›ºå®šä»·æ ¼æ¨¡å¼ä¸”ç¼ºå°‘ `base_price`ï¼Œä»å…¶ä»–å­—æ®µæå–ä»·æ ¼

**å®šä»·æ¨¡å¼åˆ¤æ–­å‡½æ•°** (ç¬¬144-158è¡Œ):
```javascript
function determinePricingModel(doc) {
  // æ£€æŸ¥æ˜¯å¦å·²æœ‰ price_tiers ä¸”åŒ…å«å¤šä¸ªæ¡£ä½
  if (doc.price_tiers && Array.isArray(doc.price_tiers) && doc.price_tiers.length > 0) {
    return 'tiered';
  }
  
  // æ£€æŸ¥æ˜¯å¦æœ‰å¤šä¸ªä»·æ ¼å­—æ®µï¼ˆlow/highï¼‰ï¼Œæš—ç¤ºå¯èƒ½éœ€è¦é˜¶æ¢¯å®šä»·
  if (doc.pricing?.base_price_low || doc.pricing?.base_price_high) {
    return 'tiered';
  }
  
  // é»˜è®¤ä¸ºå›ºå®šä»·æ ¼æ¨¡å¼
  return 'fixed';
}
```

**æ‰§è¡Œç»“æœ**:
- âœ… æ‰€æœ‰ç°æœ‰ SF ç³»åˆ—äº§å“å°†è¢«æ ‡è®°ä¸º `pricing_model: 'fixed'`
- âœ… ä¿ç•™åŸæœ‰çš„ `base_price` å­—æ®µ
- âœ… å¦‚æœæœ‰ AT/GY äº§å“æœ‰å¤šä¸ªä»·æ ¼æ¡£ä½ï¼Œå°†è¢«æ ‡è®°ä¸º `'tiered'`

**è¿è¡Œå‘½ä»¤**:
```bash
cd backend
node migration_price_tiers.js
```

**è¾“å‡ºç¤ºä¾‹**:
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  å®šä»·æ¨¡å¼å­—æ®µè¿ç§»è„šæœ¬ v2.0.0
  Pricing Model Migration Script
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è¿ç§»å†…å®¹ï¼š
  âœ“ ä¸ºæ‰€æœ‰æ‰§è¡Œå™¨æ·»åŠ  pricing_model å­—æ®µï¼ˆé»˜è®¤: fixedï¼‰
  âœ“ ä¸ºæ‰€æœ‰é…ä»¶æ·»åŠ  pricing_model å­—æ®µï¼ˆé»˜è®¤: fixedï¼‰
  âœ“ ä¿ç•™åŸæœ‰çš„ base_price/price å­—æ®µ
  âœ“ å¦‚æœæ–‡æ¡£å·²æœ‰ price_tiersï¼Œè®¾ç½®ä¸º tiered æ¨¡å¼

ğŸ“Š è¿ç§»å®Œæˆç»Ÿè®¡

ã€æ‰§è¡Œå™¨ Actuatorsã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ€»æ–‡æ¡£æ•°:            50 ä¸ª          â”‚
â”‚ âœ“ æˆåŠŸè¿ç§»:          50 ä¸ª          â”‚
â”‚ âŠ˜ å·²æœ‰å®šä»·æ¨¡å¼:       0 ä¸ª          â”‚
â”‚ ? æ— ä»·æ ¼å­—æ®µ:         0 ä¸ª          â”‚
â”‚ âœ— å¤±è´¥:               0 ä¸ª          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ‰§è¡Œå™¨ - å›ºå®šä»·æ ¼æ¨¡å¼: 50 ä¸ª
æ‰§è¡Œå™¨ - é˜¶æ¢¯ä»·æ ¼æ¨¡å¼: 0 ä¸ª
```

---

## ä¸‰ã€æ•°æ®æ¨¡å‹è¦æ±‚

### Actuator æ¨¡å‹å¿…éœ€å­—æ®µ

```javascript
{
  // åŸºæœ¬ä¿¡æ¯
  model_base: String,        // å‹å·
  series: String,            // ç³»åˆ— (SF/AT/GY)
  
  // å®šä»·ä¿¡æ¯ï¼ˆæ–°æ¶æ„ï¼‰
  pricing_model: {           // â­ æ–°å¢å­—æ®µ
    type: String,
    enum: ['fixed', 'tiered'],
    default: 'fixed'
  },
  
  base_price: Number,        // åŸºç¡€ä»·æ ¼ï¼ˆå¿…é¡»ä¿ç•™ï¼‰
  
  price_tiers: [{            // é˜¶æ¢¯ä»·æ ¼ï¼ˆå¯é€‰ï¼‰
    min_quantity: Number,
    unit_price: Number,
    price_type: String,
    notes: String
  }],
  
  // å…¶ä»–å­—æ®µ...
}
```

---

## å››ã€ä½¿ç”¨æŒ‡å—

### 1. å¯¼å…¥å›ºå®šä»·æ ¼äº§å“ï¼ˆå¦‚ SF ç³»åˆ—ï¼‰

**CSV æ ¼å¼**:
```csv
model_base,series,action_type,base_price
SF025,SF,DA,1200
SF040,SF,SR,1500
```

**ç»“æœ**:
```javascript
{
  model_base: "SF025",
  series: "SF",
  pricing_model: "fixed",  // è‡ªåŠ¨è®¾ç½®
  base_price: 1200
}
```

---

### 2. å¯¼å…¥é˜¶æ¢¯ä»·æ ¼äº§å“ï¼ˆå¦‚ AT/GY ç³»åˆ—ï¼‰

**CSV æ ¼å¼**:
```csv
model_base,series,qty_1,price_1,qty_2,price_2,qty_3,price_3
AT-SR52K8,AT,1,2500,10,2300,50,2100
```

**ç»“æœ**:
```javascript
{
  model_base: "AT-SR52K8",
  series: "AT",
  pricing_model: "tiered",  // è‡ªåŠ¨è®¾ç½®
  base_price: 2500,         // ä½¿ç”¨ç¬¬ä¸€æ¡£ä»·æ ¼
  price_tiers: [
    { min_quantity: 1, unit_price: 2500, price_type: 'normal' },
    { min_quantity: 10, unit_price: 2300, price_type: 'normal' },
    { min_quantity: 50, unit_price: 2100, price_type: 'normal' }
  ]
}
```

---

### 3. å¯¼å…¥å¤šä»·æ ¼æ¡£ä½äº§å“

**CSV æ ¼å¼**:
```csv
model_base,series,base_price_low,base_price_normal,base_price_high
GY-63,GY,3500,4000,4500
```

**ç»“æœ**:
```javascript
{
  model_base: "GY-63",
  series: "GY",
  pricing_model: "tiered",  // è‡ªåŠ¨è¯†åˆ«ä¸ºé˜¶æ¢¯å®šä»·
  base_price: 4000,         // ä½¿ç”¨æ ‡å‡†ä»·æ ¼
  price_tiers: [
    { min_quantity: 10, unit_price: 3500, price_type: 'low', notes: 'å¤§æ‰¹é‡ä¼˜æƒ ä»·' },
    { min_quantity: 1, unit_price: 4000, price_type: 'normal', notes: 'æ ‡å‡†ä»·æ ¼' },
    { min_quantity: 1, unit_price: 4500, price_type: 'high', notes: 'å°æ‰¹é‡ä»·æ ¼' }
  ],
  pricing: {  // ä¿ç•™åŸå§‹ä»·æ ¼ä¿¡æ¯ï¼ˆå‘åå…¼å®¹ï¼‰
    base_price_normal: 4000,
    base_price_low: 3500,
    base_price_high: 4500
  }
}
```

---

## äº”ã€è¿è¡Œè„šæœ¬

### 1. å¯¼å…¥ SF ç³»åˆ—æ•°æ®
```bash
cd backend
node seed.js
```

### 2. å¯¼å…¥ AT/GY ç³»åˆ—æ•°æ®ï¼ˆåŸºç¡€ç‰ˆï¼‰
```bash
cd backend
node seed_at_gy.js
```

### 3. å¯¼å…¥ AT/GY ç³»åˆ—æ•°æ®ï¼ˆæœ€ç»ˆç‰ˆï¼Œå«å®Œæ•´ä»·æ ¼ï¼‰
```bash
cd backend
node seed_at_gy_final.js
```

### 4. è¿ç§»ç°æœ‰æ•°æ®
```bash
cd backend
node migration_price_tiers.js
```

---

## å…­ã€éªŒè¯æ¸…å•

### âœ… æ•°æ®å¯¼å…¥éªŒè¯

- [ ] SF ç³»åˆ—äº§å“çš„ `pricing_model` ä¸º `'fixed'`
- [ ] SF ç³»åˆ—äº§å“çš„ `base_price` å·²æ­£ç¡®è®¾ç½®
- [ ] AT/GY å•ä»·äº§å“çš„ `pricing_model` ä¸º `'fixed'`
- [ ] AT/GY é˜¶æ¢¯ä»·æ ¼äº§å“çš„ `pricing_model` ä¸º `'tiered'`
- [ ] AT/GY é˜¶æ¢¯ä»·æ ¼äº§å“çš„ `price_tiers` æ•°ç»„å·²æ­£ç¡®è§£æ
- [ ] AT/GY é˜¶æ¢¯ä»·æ ¼äº§å“çš„ `base_price` å·²ä¿ç•™ï¼ˆä½¿ç”¨æ ‡å‡†ä»·æ ¼ï¼‰

### âœ… æ•°æ®è¿ç§»éªŒè¯

- [ ] æ‰€æœ‰ç°æœ‰æ–‡æ¡£éƒ½æ·»åŠ äº† `pricing_model` å­—æ®µ
- [ ] åŸæœ‰çš„ `base_price` å­—æ®µå·²ä¿ç•™
- [ ] SF ç³»åˆ—äº§å“æ ‡è®°ä¸º `'fixed'` æ¨¡å¼
- [ ] æœ‰ `price_tiers` çš„äº§å“æ ‡è®°ä¸º `'tiered'` æ¨¡å¼
- [ ] è¿ç§»è¿‡ç¨‹æ— æ•°æ®ä¸¢å¤±

### âœ… API å…¼å®¹æ€§éªŒè¯

- [ ] ä»·æ ¼è®¡ç®— API æ­£ç¡®è¯†åˆ« `pricing_model`
- [ ] å›ºå®šä»·æ ¼äº§å“è¿”å› `base_price`
- [ ] é˜¶æ¢¯ä»·æ ¼äº§å“æ ¹æ®æ•°é‡è¿”å›æ­£ç¡®ä»·æ ¼
- [ ] å‘åå…¼å®¹åŸæœ‰çš„ `pricing` å¯¹è±¡

---

## ä¸ƒã€æ³¨æ„äº‹é¡¹

### âš ï¸ é‡è¦æç¤º

1. **ä¿ç•™ base_price**: å³ä½¿æ˜¯é˜¶æ¢¯å®šä»·ï¼Œä¹Ÿå¿…é¡»ä¿ç•™ `base_price` å­—æ®µï¼Œç”¨äºå¿«é€Ÿä»·æ ¼æŸ¥è¯¢
2. **å‘åå…¼å®¹**: `seed_at_gy_final.js` ä¿ç•™äº† `pricing` å¯¹è±¡ï¼Œç¡®ä¿æ—§ä»£ç ä»èƒ½æ­£å¸¸å·¥ä½œ
3. **è‡ªåŠ¨å›é€€**: å¦‚æœé˜¶æ¢¯ä»·æ ¼è§£æå¤±è´¥ï¼Œè‡ªåŠ¨å›é€€åˆ°å›ºå®šä»·æ ¼æ¨¡å¼
4. **æ•°æ®éªŒè¯**: æ‰€æœ‰è„šæœ¬éƒ½åŒ…å«æ•°æ®éªŒè¯é€»è¾‘ï¼Œç¡®ä¿å¯¼å…¥æ•°æ®çš„å®Œæ•´æ€§

### ğŸ”§ æ•…éšœæ’é™¤

**é—®é¢˜**: å¯¼å…¥å `pricing_model` å­—æ®µç¼ºå¤±
- **åŸå› **: è„šæœ¬ç‰ˆæœ¬è¿‡æ—§
- **è§£å†³**: ä½¿ç”¨æ›´æ–°åçš„è„šæœ¬é‡æ–°å¯¼å…¥

**é—®é¢˜**: é˜¶æ¢¯ä»·æ ¼æœªæ­£ç¡®è§£æ
- **åŸå› **: CSV åˆ—åä¸åŒ¹é…
- **è§£å†³**: æ£€æŸ¥ CSV æ˜¯å¦æœ‰ `qty_X` å’Œ `price_X` åˆ—

**é—®é¢˜**: `base_price` å­—æ®µè¢«åˆ é™¤
- **åŸå› **: ä½¿ç”¨äº†æ—§ç‰ˆè¿ç§»è„šæœ¬
- **è§£å†³**: ä½¿ç”¨ `migration_price_tiers.js v2.0.0` é‡æ–°è¿ç§»

---

## å…«ã€æ€»ç»“

### âœ… å·²å®Œæˆ

1. âœ… æ›´æ–° `seed_at_gy.js` - æ·»åŠ å®šä»·æ¨¡å¼åˆ¤æ–­é€»è¾‘
2. âœ… æ›´æ–° `seed_at_gy_final.js` - æ·»åŠ é«˜çº§å®šä»·æ¨¡å¼åˆ¤æ–­é€»è¾‘
3. âœ… éªŒè¯ `seed.js` - å·²æœ‰å®Œæ•´çš„å®šä»·æ¨¡å¼åˆ¤æ–­é€»è¾‘
4. âœ… éªŒè¯ `migration_price_tiers.js` - å·²æ­£ç¡®å®ç°æ–°éœ€æ±‚
5. âœ… åˆ›å»ºè¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£å’ŒéªŒè¯æ¸…å•

### ğŸ¯ å…³é”®æ”¹è¿›

- **æ™ºèƒ½åˆ¤æ–­**: è„šæœ¬è‡ªåŠ¨æ ¹æ® Excel æ•°æ®åˆ¤æ–­å®šä»·æ¨¡å¼
- **çµæ´»å…¼å®¹**: æ”¯æŒå¤šç§ CSV æ ¼å¼ï¼ˆqty_X/price_X, low/normal/highï¼‰
- **æ•°æ®å®Œæ•´**: åŒæ—¶ä¿ç•™ `base_price` å’Œ `price_tiers`
- **è‡ªåŠ¨å›é€€**: è§£æå¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°å›ºå®šä»·æ ¼æ¨¡å¼
- **å‘åå…¼å®¹**: ä¿ç•™åŸæœ‰çš„ `pricing` å¯¹è±¡

### ğŸ“Š å½±å“èŒƒå›´

- **æ•°æ®å¯¼å…¥**: 3ä¸ªè„šæœ¬ï¼ˆseed.js, seed_at_gy.js, seed_at_gy_final.jsï¼‰
- **æ•°æ®è¿ç§»**: 1ä¸ªè„šæœ¬ï¼ˆmigration_price_tiers.jsï¼‰
- **æ•°æ®æ¨¡å‹**: Actuator æ¨¡å‹æ–°å¢ `pricing_model` å­—æ®µ
- **API**: ä»·æ ¼è®¡ç®—é€»è¾‘éœ€æ ¹æ® `pricing_model` è°ƒæ•´

---

## ä¹ã€ä¸‹ä¸€æ­¥æ“ä½œå»ºè®®

1. **è¿è¡Œè¿ç§»è„šæœ¬**: ä¸ºç°æœ‰æ•°æ®æ·»åŠ  `pricing_model` å­—æ®µ
   ```bash
   node backend/migration_price_tiers.js
   ```

2. **é‡æ–°å¯¼å…¥æ•°æ®**: å¦‚æœéœ€è¦å…¨æ–°å¯¼å…¥
   ```bash
   node backend/seed.js           # SFç³»åˆ—
   node backend/seed_at_gy_final.js  # AT/GYç³»åˆ—
   ```

3. **éªŒè¯æ•°æ®**: æ£€æŸ¥æ•°æ®åº“ä¸­çš„ `pricing_model` å­—æ®µ
   ```javascript
   // MongoDB Shell
   db.actuators.find({ pricing_model: { $exists: false } }).count()  // åº”ä¸º 0
   db.actuators.find({ pricing_model: 'fixed' }).count()
   db.actuators.find({ pricing_model: 'tiered' }).count()
   ```

4. **æµ‹è¯• API**: éªŒè¯ä»·æ ¼è®¡ç®—æ¥å£æ˜¯å¦æ­£ç¡®
   ```bash
   # æµ‹è¯•å›ºå®šä»·æ ¼äº§å“
   curl http://localhost:3000/api/actuators/price?model=SF025&quantity=5
   
   # æµ‹è¯•é˜¶æ¢¯ä»·æ ¼äº§å“
   curl http://localhost:3000/api/actuators/price?model=AT-SR52K8&quantity=50
   ```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¥æœŸ**: 2025-10-28  
**ç»´æŠ¤è€…**: C-MAX æŠ€æœ¯å›¢é˜Ÿ

