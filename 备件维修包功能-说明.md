# 备件维修包价格显示功能

## 📋 功能概述

在智慧选型页面添加了备件维修包价格的显示功能，用户在选择执行器时可以同时查看该执行器对应的备件维修包价格信息。

**更新时间**: 2025-10-30  
**功能状态**: ✅ 已完成

---

## 🎯 功能说明

### 1. 显示位置

备件维修包价格在两个地方显示：

#### A. 推荐结果列表
- 在每个推荐执行器卡片中显示
- 位置：扭矩信息和"选择此型号"按钮之间
- 样式：浅蓝色背景区域，带💼图标

#### B. 配置汇总Modal
- 在选型配置汇总页面显示
- 位置：执行器基本信息（型号、价格、扭矩）之后
- 样式：列表形式展示所有备件

### 2. 显示内容

备件维修包包含两类信息：

#### ① 密封套件 (seal_kit_price)
- 最常用的备件
- 价格以绿色高亮显示
- 示例：`密封套件：¥2,500`

#### ② 其他备件 (other_parts)
- 可包含多个备件项
- 每个备件显示名称和价格
- 示例：
  ```
  • 活塞密封圈：¥800
  • 轴承套件：¥1,200
  • 弹簧组件：¥1,500
  ```

### 3. 显示逻辑

- **有备件数据时**: 显示淡蓝色背景区域，列出所有备件
- **无备件数据时**: 不显示备件区域（不占用空间）
- **推荐列表**: 最多显示2个其他备件，超过则显示"...及其他X个备件"
- **配置汇总**: 显示所有备件项，无数量限制

---

## 💾 数据结构

### Actuator Model 中的 spare_parts 字段

```javascript
spare_parts: {
  // 密封套件价格
  seal_kit_price: {
    type: Number,
    min: [0, '价格不能为负数']
  },
  // 其他备件
  other_parts: [{
    part_name: String,       // 备件名称
    part_number: String,     // 备件编号
    price: {                 // 备件价格
      type: Number,
      min: [0, '价格不能为负数']
    }
  }]
}
```

### 数据示例

```json
{
  "model_base": "AT063-DA",
  "price": 15000,
  "spare_parts": {
    "seal_kit_price": 2500,
    "other_parts": [
      {
        "part_name": "活塞密封圈",
        "part_number": "AT063-SEAL-01",
        "price": 800
      },
      {
        "part_name": "轴承套件",
        "part_number": "AT063-BEAR-01",
        "price": 1200
      },
      {
        "part_name": "弹簧组件",
        "part_number": "AT063-SPR-K8",
        "price": 1500
      }
    ]
  }
}
```

---

## 🎨 UI展示效果

### 推荐列表中的显示

```
┌─────────────────────────────────────┐
│ 1. AT063-DA        [推荐] ¥15,000  │
│                                     │
│ 实际扭矩：65 Nm                     │
│ 扭矩裕度：30.0%  [████████░░]      │
│ 机身: 063 | 类型: DA | 交期: 7天   │
│                                     │
│ ┌─ 💼 备件维修包 ───────────────┐  │
│ │ 密封套件：¥2,500              │  │
│ │ 活塞密封圈：¥800              │  │
│ │ 轴承套件：¥1,200              │  │
│ │ ...及其他 1 个备件             │  │
│ └───────────────────────────────┘  │
│                                     │
│         [ 选择此型号 ]              │
└─────────────────────────────────────┘
```

### 配置汇总Modal中的显示

```
┌─ 选型配置汇总 ────────────────────┐
│                                    │
│ 执行器型号：AT063-DA               │
│ 价格：¥15,000                      │
│ 扭矩：65 Nm                        │
│                                    │
│ ─────────────────────────────────  │
│                                    │
│ 💼 备件维修包：                    │
│ • 密封套件：¥2,500                 │
│ • 活塞密封圈：¥800                 │
│ • 轴承套件：¥1,200                 │
│ • 弹簧组件：¥1,500                 │
│                                    │
│ ─────────────────────────────────  │
│                                    │
│ 手动操作装置：...                   │
│ ...                                │
└────────────────────────────────────┘
```

---

## 📝 代码实现

### 前端显示代码 (SelectionEngine.jsx)

#### 推荐列表显示
```jsx
{/* 备件维修包价格 */}
{item.spare_parts && (item.spare_parts.seal_kit_price || (item.spare_parts.other_parts && item.spare_parts.other_parts.length > 0)) && (
  <div style={{ 
    backgroundColor: '#f0f5ff', 
    padding: '8px', 
    borderRadius: '4px',
    marginTop: '8px'
  }}>
    <Text type="secondary" style={{ fontSize: 12 }}>
      💼 备件维修包：
    </Text>
    {item.spare_parts.seal_kit_price && (
      <div style={{ marginTop: 4 }}>
        <Text style={{ fontSize: 12 }}>
          密封套件：<Text strong style={{ color: '#52c41a' }}>¥{item.spare_parts.seal_kit_price.toLocaleString()}</Text>
        </Text>
      </div>
    )}
    {/* 其他备件显示（最多2个）*/}
    ...
  </div>
)}
```

#### 配置汇总显示
```jsx
{/* 备件维修包信息 */}
{selectedActuator.spare_parts && (...) && (
  <>
    <Divider style={{ margin: '8px 0' }} />
    <div>
      <Text type="secondary">💼 备件维修包：</Text>
    </div>
    {selectedActuator.spare_parts.seal_kit_price && (
      <div>
        <Text style={{ fontSize: 13 }}>
          • 密封套件：<Text strong style={{ color: '#52c41a' }}>¥{selectedActuator.spare_parts.seal_kit_price.toLocaleString()}</Text>
        </Text>
      </div>
    )}
    {/* 显示所有其他备件 */}
    ...
  </>
)}
```

---

## 🔧 数据维护

### 如何添加备件数据

#### 方法1: 通过数据管理界面
1. 进入"数据管理" → "执行器管理"
2. 选择要编辑的执行器
3. 找到"备件信息"栏
4. 添加密封套件价格和其他备件信息

#### 方法2: 通过数据库直接更新
```javascript
// MongoDB更新示例
db.actuators.updateOne(
  { model_base: "AT063-DA" },
  {
    $set: {
      spare_parts: {
        seal_kit_price: 2500,
        other_parts: [
          {
            part_name: "活塞密封圈",
            part_number: "AT063-SEAL-01",
            price: 800
          },
          {
            part_name: "轴承套件",
            part_number: "AT063-BEAR-01",
            price: 1200
          }
        ]
      }
    }
  }
)
```

#### 方法3: 通过Excel批量导入
在执行器Excel模板中添加备件列：
- `seal_kit_price` - 密封套件价格
- `spare_parts` - 其他备件（JSON格式）

---

## 📊 适用范围

### 所有执行器类型都支持
- ✅ SF系列（拨叉式）
- ✅ AT系列（齿轮齿条式）
- ✅ GY系列（齿轮齿条式）

### 建议维护的备件信息

#### SF系列常见备件
- 密封套件（O-ring Kit）
- 轭架轴承（Yoke Bearing）
- 活塞密封（Piston Seal）
- 端盖密封（End Cap Seal）

#### AT/GY系列常见备件
- 密封套件（Seal Kit）
- 齿轮组件（Gear Set）
- 轴承套件（Bearing Kit）
- 活塞密封圈（Piston Ring）
- 弹簧组件（Spring Set，仅SR型）

---

## ✅ 验证清单

### 前端显示
- [x] 推荐列表中显示备件信息
- [x] 配置汇总Modal中显示备件信息
- [x] 无备件数据时不显示备件区域
- [x] 价格格式化显示（千分位）
- [x] 推荐列表中最多显示2个其他备件
- [x] 配置汇总中显示所有备件

### 数据完整性
- [ ] 检查现有执行器是否有备件数据
- [ ] 补充缺失的备件信息
- [ ] 验证备件价格准确性
- [ ] 确保备件编号规范统一

### 用户体验
- [x] 备件区域样式清晰醒目
- [x] 价格使用绿色高亮
- [x] 💼图标增强可识别性
- [x] 信息层次分明

---

## 🚀 下一步工作

### 数据录入
1. 收集所有执行器的备件信息
2. 整理备件价格表
3. 批量导入或手动录入备件数据

### 功能增强（可选）
1. 添加备件详情查看功能
2. 支持备件库存查询
3. 添加备件订购功能
4. 生成备件清单报表

---

## 📞 技术支持

如有问题或需要帮助，请联系技术团队。

**最后更新**: 2025-10-30  
**版本**: 1.0.0  
**状态**: ✅ 已上线

