# ğŸ“‹ æ‰§è¡Œå™¨æ‰¹é‡å¯¼å…¥åŠŸèƒ½ - æŠ€æœ¯å®ç°æ–‡æ¡£

## ä¸€ã€ç³»ç»Ÿæ¶æ„

### æ•´ä½“æµç¨‹

```
ç”¨æˆ·ç•Œé¢ â†’ APIè¯·æ±‚ â†’ åç«¯å¤„ç† â†’ æ•°æ®åº“æ›´æ–°
   â†“          â†“          â†“          â†“
ä¸‹è½½æ¨¡æ¿   æ–‡ä»¶ä¸Šä¼    è§£ææ ¡éªŒ   å…¨é‡æ›¿æ¢
           â†“          â†“          â†“
        éªŒè¯æ–‡ä»¶   ç”ŸæˆæŠ¥å‘Š   è¿”å›ç»“æœ
```

### æ ¸å¿ƒç»„ä»¶

1. **å‰ç«¯ç»„ä»¶** (`ActuatorManagementSimplified.jsx`)
   - ç”¨æˆ·ç•Œé¢å’Œäº¤äº’
   - æ–‡ä»¶ä¸Šä¼ ç®¡ç†
   - é”™è¯¯æŠ¥å‘Šä¸‹è½½

2. **åç«¯è·¯ç”±** (`actuatorManagementRoutes.js`)
   - `/template/unified` - ä¸‹è½½æ¨¡æ¿
   - `/import/unified` - å¯¼å…¥æ•°æ®

3. **æ§åˆ¶å™¨** (`actuatorManagementController.js`)
   - `downloadUnifiedTemplate` - æ¨¡æ¿ç”Ÿæˆ
   - `bulkImportUnifiedExcel` - æ•°æ®å¯¼å…¥

4. **Excelå¤„ç†å·¥å…·**
   - `actuatorExcelTemplate.js` - æ¨¡æ¿ç”Ÿæˆå™¨
   - `actuatorExcelProcessor.js` - æ•°æ®è§£æå’Œæ ¡éªŒ

5. **æ•°æ®æ¨¡å‹** (`Actuator.js`)
   - MongoDB Schemaå®šä¹‰

## äºŒã€æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 2.1 æ¨¡æ¿ç”Ÿæˆå™¨ (`actuatorExcelTemplate.js`)

**åŠŸèƒ½ï¼š** ç”ŸæˆåŒ…å«4ä¸ªå·¥ä½œè¡¨çš„Excelæ¨¡æ¿

**ä½¿ç”¨çš„åº“ï¼š** `exceljs`

**å·¥ä½œè¡¨ç»“æ„ï¼š**

#### Instructions å·¥ä½œè¡¨
- åŒ…å«è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜
- æ•°æ®è¦æ±‚è¯´æ˜
- ç³»åˆ—ç‰¹æ®Šè¯´æ˜
- æè´¨è¯´æ˜

#### SF_Data å·¥ä½œè¡¨
```javascript
åˆ—å®šä¹‰ï¼š
- Model (æ–‡æœ¬)
- Type (æ–‡æœ¬, ä¸‹æ‹‰éªŒè¯: SR/DA)
- Price (æ•°å­—)
- Air_Pressure_bar (æ•°å­—)
- SST_Nm (æ•°å­—)
- SET_Nm (æ•°å­—)
- AST_Nm (æ•°å­—)
- AET_Nm (æ•°å­—)
- DA_Torque_0deg_Nm (æ•°å­—)
- DA_Torque_90deg_Nm (æ•°å­—)
```

#### AT_Data å’Œ GY_Data å·¥ä½œè¡¨
```javascript
åˆ—å®šä¹‰ï¼š
- Model (æ–‡æœ¬)
- Type (æ–‡æœ¬, ä¸‹æ‹‰éªŒè¯: SR/DA)
- Price (æ•°å­—)
- Output_Torque_Nm (æ•°å­—)
```

**ç‰¹æ€§ï¼š**
- è¡¨å¤´å¸¦æ ·å¼ï¼ˆèƒŒæ™¯è‰²ã€å­—ä½“ï¼‰
- åˆ—å®½è‡ªåŠ¨è°ƒæ•´
- åŒ…å«ç¤ºä¾‹æ•°æ®
- Typeåˆ—å¸¦æ•°æ®éªŒè¯ï¼ˆä¸‹æ‹‰åˆ—è¡¨ï¼‰

### 2.2 Excelè§£æå™¨ (`actuatorExcelProcessor.js`)

#### ä¸»è¦å‡½æ•°

##### `parseActuatorExcel(buffer)`
**åŠŸèƒ½ï¼š** è§£æä¸Šä¼ çš„Excelæ–‡ä»¶

**æµç¨‹ï¼š**
1. åŠ è½½Excelæ–‡ä»¶
2. éªŒè¯å·¥ä½œè¡¨ç»“æ„ï¼ˆå¿…é¡»åŒ…å«SF_Dataã€AT_Dataã€GY_Dataï¼‰
3. é€ä¸ªå·¥ä½œè¡¨è¯»å–æ•°æ®
4. è·³è¿‡ç©ºè¡Œ
5. è¿”å›è§£æç»“æœ

**è¿”å›æ ¼å¼ï¼š**
```javascript
{
  success: true/false,
  error: "é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰",
  data: {
    SF: [...],
    AT: [...],
    GY: [...]
  }
}
```

##### `validateActuatorData(parsedData)`
**åŠŸèƒ½ï¼š** æ ¡éªŒæ‰€æœ‰æ•°æ®

**æ ¡éªŒé€»è¾‘ï¼š**
- è°ƒç”¨ç³»åˆ—ç‰¹å®šçš„æ ¡éªŒå‡½æ•°
- æ”¶é›†æ‰€æœ‰é”™è¯¯ä¿¡æ¯
- è¿”å›æ ¡éªŒç»“æœå’Œæœ‰æ•ˆæ•°æ®

**è¿”å›æ ¼å¼ï¼š**
```javascript
{
  success: true/false,
  errors: [
    {
      sheet: "å·¥ä½œè¡¨å",
      row: è¡Œå·,
      model: "å‹å·",
      errors: ["é”™è¯¯1", "é”™è¯¯2"]
    }
  ],
  validData: {
    SF: [...],
    AT: [...],
    GY: [...]
  }
}
```

##### `validateSFRow(row)`
**åŠŸèƒ½ï¼š** æ ¡éªŒSFç³»åˆ—å•è¡Œæ•°æ®

**æ ¡éªŒè§„åˆ™ï¼š**
```javascript
1. å¿…å¡«å­—æ®µï¼šModel, Type, Price, Air_Pressure_bar
2. Typeå¿…é¡»æ˜¯SRæˆ–DA
3. Type=SRæ—¶ï¼š
   - SST_Nm, SET_Nm, AST_Nm, AET_Nm å¿…å¡«
   - DAæ‰­çŸ©å­—æ®µå¿…é¡»ä¸ºç©º
4. Type=DAæ—¶ï¼š
   - DA_Torque_0deg_Nm, DA_Torque_90deg_Nm å¿…å¡«
   - SRæ‰­çŸ©å­—æ®µå¿…é¡»ä¸ºç©º
```

##### `validateATGYRow(row, series)`
**åŠŸèƒ½ï¼š** æ ¡éªŒAT/GYç³»åˆ—å•è¡Œæ•°æ®

**æ ¡éªŒè§„åˆ™ï¼š**
```javascript
1. å¿…å¡«å­—æ®µï¼šModel, Type, Price, Output_Torque_Nm
2. Typeå¿…é¡»æ˜¯SRæˆ–DA
3. æ‰€æœ‰æ•°å­—å­—æ®µå¿…é¡»æ˜¯æœ‰æ•ˆæ•°å­—
```

##### `generateErrorReport(originalBuffer, errors)`
**åŠŸèƒ½ï¼š** ç”Ÿæˆé”™è¯¯æŠ¥å‘ŠExcelæ–‡ä»¶

**å®ç°ï¼š**
1. åŠ è½½åŸå§‹Excelæ–‡ä»¶
2. ä¸ºæ¯ä¸ªå·¥ä½œè¡¨æ·»åŠ "é”™è¯¯è¯´æ˜"åˆ—
3. åœ¨æœ‰é”™è¯¯çš„è¡Œå¡«å†™é”™è¯¯ä¿¡æ¯
4. ä½¿ç”¨çº¢è‰²èƒŒæ™¯æ ‡æ³¨é”™è¯¯å•å…ƒæ ¼
5. è¿”å›æ–°çš„Excelæ–‡ä»¶Buffer

##### `transformToDbFormat(validData)`
**åŠŸèƒ½ï¼š** å°†Excelæ•°æ®è½¬æ¢ä¸ºæ•°æ®åº“æ ¼å¼

**è½¬æ¢é€»è¾‘ï¼š**

**SFç³»åˆ—ï¼š**
```javascript
{
  model_base: "SF14-300DA",
  series: "SF",
  action_type: "DA",
  base_price_normal: 5200,
  torque_data: {
    da_0deg: 309,
    da_90deg: 417
  },
  specifications: {
    pressure_range: { min: 6, max: 6 }
  },
  status: "å·²å‘å¸ƒ",
  is_active: true
}
```

**ATç³»åˆ—ï¼š**
```javascript
{
  model_base: "AT-050DA",
  series: "AT",
  action_type: "DA",
  base_price_normal: 3200,
  torque_data: {
    output_torque: 50
  },
  specifications: {
    materials: {
      body: "é“åˆé‡‘+ç¡¬è´¨æ°§åŒ–"  // è‡ªåŠ¨æ·»åŠ 
    }
  },
  status: "å·²å‘å¸ƒ",
  is_active: true
}
```

**GYç³»åˆ—ï¼š**
```javascript
{
  model_base: "GY-080DA",
  series: "GY",
  action_type: "DA",
  base_price_normal: 4200,
  torque_data: {
    output_torque: 80
  },
  specifications: {
    materials: {
      body: "ä¸é”ˆé’¢"  // è‡ªåŠ¨æ·»åŠ 
    }
  },
  status: "å·²å‘å¸ƒ",
  is_active: true
}
```

### 2.3 æ§åˆ¶å™¨ (`actuatorManagementController.js`)

#### `downloadUnifiedTemplate(req, res)`
**åŠŸèƒ½ï¼š** ç”Ÿæˆå¹¶ä¸‹è½½æ¨¡æ¿

**æµç¨‹ï¼š**
1. è°ƒç”¨æ¨¡æ¿ç”Ÿæˆå™¨
2. è®¾ç½®å“åº”å¤´ï¼ˆContent-Type, Content-Dispositionï¼‰
3. è¿”å›Excelæ–‡ä»¶

#### `bulkImportUnifiedExcel(req, res)`
**åŠŸèƒ½ï¼š** å¤„ç†Excelå¯¼å…¥ï¼ˆå…¨é‡æ›¿æ¢æ¨¡å¼ï¼‰

**æµç¨‹ï¼š**
```javascript
1. éªŒè¯æ–‡ä»¶ä¸Šä¼ 
2. è§£æExcelæ–‡ä»¶
   â”œâ”€ å¤±è´¥ â†’ è¿”å›é”™è¯¯ä¿¡æ¯
   â””â”€ æˆåŠŸ â†’ ç»§ç»­

3. æ ¡éªŒæ•°æ®
   â”œâ”€ æœ‰é”™è¯¯ â†’ ç”Ÿæˆé”™è¯¯æŠ¥å‘Š â†’ è¿”å›é”™è¯¯ä¿¡æ¯å’ŒæŠ¥å‘Š
   â””â”€ æ— é”™è¯¯ â†’ ç»§ç»­

4. è½¬æ¢æ•°æ®æ ¼å¼

5. å¼€å§‹æ•°æ®åº“äº‹åŠ¡
   â”œâ”€ åˆ é™¤æ‰€æœ‰ç°æœ‰æ‰§è¡Œå™¨æ•°æ®
   â”œâ”€ æ‰¹é‡æ’å…¥æ–°æ•°æ®
   â”œâ”€ æäº¤äº‹åŠ¡
   â””â”€ è¿”å›æˆåŠŸä¿¡æ¯

6. å¦‚æœå‡ºé”™ â†’ å›æ»šäº‹åŠ¡
```

**äº‹åŠ¡å¤„ç†ï¼š**
```javascript
const session = await Actuator.startSession();
session.startTransaction();

try {
  // åˆ é™¤æ—§æ•°æ®
  await Actuator.deleteMany({}, { session });
  
  // æ’å…¥æ–°æ•°æ®
  await Actuator.insertMany(dbRecords, { 
    session, 
    ordered: false 
  });
  
  await session.commitTransaction();
} catch (error) {
  await session.abortTransaction();
  throw error;
} finally {
  session.endSession();
}
```

### 2.4 å‰ç«¯ç»„ä»¶ (`ActuatorManagementSimplified.jsx`)

#### çŠ¶æ€ç®¡ç†

```javascript
const [currentStep, setCurrentStep] = useState(0);  // å½“å‰æ­¥éª¤
const [uploadFile, setUploadFile] = useState(null);  // ä¸Šä¼ çš„æ–‡ä»¶
const [uploading, setUploading] = useState(false);   // ä¸Šä¼ çŠ¶æ€
const [statistics, setStatistics] = useState(null);  // ç»Ÿè®¡ä¿¡æ¯
const [importResult, setImportResult] = useState(null);  // å¯¼å…¥ç»“æœ
const [errorModalVisible, setErrorModalVisible] = useState(false);  // é”™è¯¯Modal
const [errorReport, setErrorReport] = useState(null);  // é”™è¯¯æŠ¥å‘Š
```

#### ä¸»è¦åŠŸèƒ½

##### 1. ä¸‹è½½æ¨¡æ¿
```javascript
handleDownloadTemplate()
- è°ƒç”¨APIä¸‹è½½æ¨¡æ¿
- åˆ›å»ºBlob URL
- è§¦å‘æµè§ˆå™¨ä¸‹è½½
- åˆ‡æ¢åˆ°æ­¥éª¤1
```

##### 2. æ–‡ä»¶ä¸Šä¼ 
```javascript
uploadProps.beforeUpload(file)
- éªŒè¯æ–‡ä»¶ç±»å‹ï¼ˆ.xlsx, .xlsï¼‰
- éªŒè¯æ–‡ä»¶å¤§å°ï¼ˆ<10MBï¼‰
- ä¿å­˜æ–‡ä»¶åˆ°çŠ¶æ€
- åˆ‡æ¢åˆ°æ­¥éª¤2
- è¿”å›falseé˜»æ­¢è‡ªåŠ¨ä¸Šä¼ 
```

##### 3. å¼€å§‹å¯¼å…¥
```javascript
handleStartImport()
- åˆ›å»ºFormData
- è°ƒç”¨å¯¼å…¥API
- å¤„ç†å“åº”ï¼š
  - æˆåŠŸï¼šæ˜¾ç¤ºç»Ÿè®¡ï¼Œåˆ·æ–°æ•°æ®
  - å¤±è´¥ï¼šæ˜¾ç¤ºé”™è¯¯æŠ¥å‘Š
```

##### 4. ä¸‹è½½é”™è¯¯æŠ¥å‘Š
```javascript
handleDownloadErrorReport()
- å°†base64è½¬æ¢ä¸ºBlob
- åˆ›å»ºä¸‹è½½é“¾æ¥
- è§¦å‘ä¸‹è½½
```

#### UIæ­¥éª¤æµç¨‹

**æ­¥éª¤0ï¼šä¸‹è½½æ¨¡æ¿**
- æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
- æç¤ºä¿¡æ¯

**æ­¥éª¤1ï¼šå¡«å†™æ•°æ®**
- æ˜¾ç¤ºæ“ä½œæŒ‡å—
- æä¾›ä¸Šä¼ æŒ‰é’®

**æ­¥éª¤2ï¼šç¡®è®¤ä¸Šä¼ **
- æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
- è­¦å‘Šæç¤º
- ç¡®è®¤æŒ‰é’®

**æ­¥éª¤3ï¼šå®Œæˆå¯¼å…¥**
- æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
- å†æ¬¡å¯¼å…¥æŒ‰é’®

## ä¸‰ã€APIæ¥å£å®šä¹‰

### 3.1 ä¸‹è½½æ¨¡æ¿

**è¯·æ±‚ï¼š**
```
GET /api/data-management/actuators/template/unified
Authorization: Bearer {token}
```

**å“åº”ï¼š**
```
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
Content-Disposition: attachment; filename=C-MAX_Actuator_Data_Template.xlsx

[Excelæ–‡ä»¶äºŒè¿›åˆ¶æ•°æ®]
```

### 3.2 å¯¼å…¥æ•°æ®

**è¯·æ±‚ï¼š**
```
POST /api/data-management/actuators/import/unified
Authorization: Bearer {token}
Content-Type: multipart/form-data

FormData:
  file: [Excelæ–‡ä»¶]
```

**æˆåŠŸå“åº”ï¼š**
```javascript
{
  "success": true,
  "message": "æ•°æ®å¯¼å…¥æˆåŠŸï¼å…±æ›´æ–°SFç³»åˆ—10æ¡ï¼ŒATç³»åˆ—8æ¡ï¼ŒGYç³»åˆ—5æ¡è®°å½•ã€‚",
  "summary": {
    "totalImported": 23,
    "sfCount": 10,
    "atCount": 8,
    "gyCount": 5,
    "oldDataDeleted": 20
  }
}
```

**é”™è¯¯å“åº”ï¼ˆæ–‡ä»¶ç»“æ„é”™è¯¯ï¼‰ï¼š**
```javascript
{
  "success": false,
  "message": "æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œç¼ºå°‘å·¥ä½œè¡¨ï¼šSF_Dataã€‚è¯·ä¸‹è½½æœ€æ–°æ¨¡æ¿ã€‚"
}
```

**é”™è¯¯å“åº”ï¼ˆæ•°æ®æ ¡éªŒå¤±è´¥ï¼‰ï¼š**
```javascript
{
  "success": false,
  "message": "æ•°æ®æ ¡éªŒå¤±è´¥ï¼Œå‘ç° 3 ä¸ªé”™è¯¯ã€‚è¯·ä¸‹è½½é”™è¯¯æŠ¥å‘ŠæŸ¥çœ‹è¯¦æƒ…ã€‚",
  "hasErrors": true,
  "errorCount": 3,
  "errors": [
    {
      "sheet": "SF_Data",
      "row": 2,
      "model": "SF14-300SR",
      "errors": ["Typeä¸ºSRæ—¶ï¼ŒSST_Nmä¸èƒ½ä¸ºç©º"]
    }
  ],
  "errorReport": {
    "fileName": "Error_Report_1699350000000.xlsx",
    "data": "[base64ç¼–ç çš„Excelæ–‡ä»¶]"
  }
}
```

## å››ã€æ•°æ®åº“æ“ä½œ

### ä½¿ç”¨äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§

```javascript
// å¼€å§‹äº‹åŠ¡
const session = await Actuator.startSession();
session.startTransaction();

try {
  // 1. åˆ é™¤æ‰€æœ‰ç°æœ‰æ•°æ®
  const deleteResult = await Actuator.deleteMany({}, { session });
  
  // 2. æ’å…¥æ–°æ•°æ®ï¼ˆordered: false å…è®¸éƒ¨åˆ†å¤±è´¥ï¼‰
  const insertResult = await Actuator.insertMany(
    dbRecords, 
    { session, ordered: false }
  );
  
  // 3. æäº¤äº‹åŠ¡
  await session.commitTransaction();
  
  // è¿”å›æˆåŠŸ
  return { success: true, ... };
} catch (error) {
  // 4. å‡ºé”™å›æ»š
  await session.abortTransaction();
  throw error;
} finally {
  // 5. å…³é—­session
  session.endSession();
}
```

### æ•°æ®å®Œæ•´æ€§ä¿è¯

1. **äº‹åŠ¡æœºåˆ¶**ï¼šä½¿ç”¨MongoDBäº‹åŠ¡ï¼Œç¡®ä¿å…¨éƒ¨æˆåŠŸæˆ–å…¨éƒ¨å›æ»š
2. **å”¯ä¸€æ€§çº¦æŸ**ï¼šmodel_baseå­—æ®µåœ¨æ•°æ®åº“ä¸­è®¾ç½®ä¸ºunique
3. **æ•°æ®éªŒè¯**ï¼šå¯¼å…¥å‰è¿›è¡Œä¸¥æ ¼çš„æ•°æ®éªŒè¯
4. **é”™è¯¯å¤„ç†**ï¼šä»»ä½•é”™è¯¯éƒ½ä¼šå¯¼è‡´äº‹åŠ¡å›æ»šï¼Œä¸ä¼šäº§ç”Ÿéƒ¨åˆ†æ•°æ®

## äº”ã€é”™è¯¯å¤„ç†æœºåˆ¶

### 5.1 å‰ç«¯é”™è¯¯å¤„ç†

**æ–‡ä»¶éªŒè¯é”™è¯¯ï¼š**
- æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®
- æ–‡ä»¶å¤§å°è¶…é™

**ç½‘ç»œé”™è¯¯ï¼š**
- è¯·æ±‚è¶…æ—¶
- è¿æ¥å¤±è´¥

**ä¸šåŠ¡é”™è¯¯ï¼š**
- æ•°æ®æ ¡éªŒå¤±è´¥
- æœåŠ¡å™¨é”™è¯¯

### 5.2 åç«¯é”™è¯¯å¤„ç†

**æ–‡ä»¶å¤„ç†é”™è¯¯ï¼š**
- æ–‡ä»¶è§£æå¤±è´¥
- å·¥ä½œè¡¨ç»“æ„ä¸æ­£ç¡®

**æ•°æ®æ ¡éªŒé”™è¯¯ï¼š**
- å¿…å¡«å­—æ®µç¼ºå¤±
- æ•°æ®ç±»å‹ä¸åŒ¹é…
- ä¸šåŠ¡é€»è¾‘é”™è¯¯

**æ•°æ®åº“é”™è¯¯ï¼š**
- è¿æ¥å¤±è´¥
- äº‹åŠ¡å¤±è´¥
- å”¯ä¸€æ€§å†²çª

### 5.3 é”™è¯¯æŠ¥å‘Š

å½“æ•°æ®æ ¡éªŒå¤±è´¥æ—¶ï¼Œç³»ç»Ÿä¼šï¼š
1. ä¸­æ–­å¯¼å…¥æµç¨‹
2. åˆ›å»ºåŸå§‹æ–‡ä»¶çš„å‰¯æœ¬
3. æ·»åŠ "é”™è¯¯è¯´æ˜"åˆ—
4. æ ‡æ³¨æ‰€æœ‰é”™è¯¯è¡Œ
5. è¿”å›å¸¦é”™è¯¯è¯´æ˜çš„Excelæ–‡ä»¶

## å…­ã€æ€§èƒ½ä¼˜åŒ–

### 6.1 æ‰¹é‡æ“ä½œ

```javascript
// ä½¿ç”¨insertManyè€Œä¸æ˜¯å¤šæ¬¡insert
await Actuator.insertMany(dbRecords, { 
  session, 
  ordered: false  // å…è®¸éƒ¨åˆ†å¤±è´¥ç»§ç»­
});
```

### 6.2 æµå¼å¤„ç†

å¯¹äºå¤§æ–‡ä»¶ï¼Œä½¿ç”¨ExcelJSçš„æµå¼è¯»å–ï¼š
```javascript
// æœªæ¥ä¼˜åŒ–æ–¹å‘
const stream = workbook.xlsx.createInputStream();
stream.on('worksheet', (worksheet) => {
  worksheet.on('row', (row) => {
    // é€è¡Œå¤„ç†
  });
});
```

### 6.3 å‰ç«¯ä¼˜åŒ–

- ä½¿ç”¨NProgressæ˜¾ç¤ºè¿›åº¦
- é˜²æŠ–æ–‡ä»¶é€‰æ‹©
- å¼‚æ­¥åŠ è½½ç»Ÿè®¡ä¿¡æ¯

## ä¸ƒã€å®‰å…¨æ€§è€ƒè™‘

### 7.1 èº«ä»½éªŒè¯
- æ‰€æœ‰APIéƒ½éœ€è¦JWTè®¤è¯
- åªæœ‰ç®¡ç†å‘˜å¯ä»¥è®¿é—®

### 7.2 æ–‡ä»¶éªŒè¯
- é™åˆ¶æ–‡ä»¶ç±»å‹ï¼ˆ.xlsx, .xlsï¼‰
- é™åˆ¶æ–‡ä»¶å¤§å°ï¼ˆ10MBï¼‰
- éªŒè¯Excelç»“æ„

### 7.3 æ•°æ®éªŒè¯
- ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥
- ä¸šåŠ¡é€»è¾‘éªŒè¯
- SQLæ³¨å…¥é˜²æŠ¤ï¼ˆä½¿ç”¨ORMï¼‰

### 7.4 æ“ä½œå®¡è®¡
- è®°å½•æ‰€æœ‰å¯¼å…¥æ“ä½œ
- è®°å½•åˆ é™¤çš„æ•°æ®é‡
- è®°å½•å¯¼å…¥çš„æ•°æ®é‡

## å…«ã€æµ‹è¯•è¦ç‚¹

### 8.1 å•å…ƒæµ‹è¯•

**æ¨¡æ¿ç”Ÿæˆå™¨æµ‹è¯•ï¼š**
- éªŒè¯å·¥ä½œè¡¨æ•°é‡å’Œåç§°
- éªŒè¯åˆ—å®šä¹‰
- éªŒè¯æ•°æ®éªŒè¯è§„åˆ™

**Excelè§£æå™¨æµ‹è¯•ï¼š**
- æ­£å¸¸æ•°æ®è§£æ
- ç©ºè¡Œå¤„ç†
- é”™è¯¯æ•°æ®æ£€æµ‹

**æ•°æ®æ ¡éªŒæµ‹è¯•ï¼š**
- å„ç§é”™è¯¯åœºæ™¯
- è¾¹ç•Œæ¡ä»¶
- ç±»å‹éªŒè¯

### 8.2 é›†æˆæµ‹è¯•

**å®Œæ•´å¯¼å…¥æµç¨‹ï¼š**
- æ¨¡æ¿ä¸‹è½½ â†’ å¡«å†™ â†’ ä¸Šä¼  â†’ å¯¼å…¥
- é”™è¯¯å¤„ç†æµç¨‹
- äº‹åŠ¡å›æ»šæµ‹è¯•

### 8.3 å‹åŠ›æµ‹è¯•

- å¤§æ–‡ä»¶å¤„ç†ï¼ˆæ•°åƒè¡Œæ•°æ®ï¼‰
- å¹¶å‘ä¸Šä¼ 
- æ•°æ®åº“æ€§èƒ½

## ä¹ã€æœªæ¥ä¼˜åŒ–æ–¹å‘

### 9.1 åŠŸèƒ½å¢å¼º
- [ ] å¢é‡æ›´æ–°æ¨¡å¼ï¼ˆå¯é€‰æ‹©æ€§æ›´æ–°ï¼‰
- [ ] æ•°æ®é¢„è§ˆåŠŸèƒ½
- [ ] å¯¼å…¥å†å²è®°å½•
- [ ] å›æ»šåŠŸèƒ½
- [ ] æ¨¡æ¿è‡ªå®šä¹‰

### 9.2 æ€§èƒ½ä¼˜åŒ–
- [ ] æµå¼å¤„ç†å¤§æ–‡ä»¶
- [ ] åˆ†æ‰¹æ’å…¥æ•°æ®
- [ ] å¼‚æ­¥å¤„ç†
- [ ] ç¼“å­˜ä¼˜åŒ–

### 9.3 ç”¨æˆ·ä½“éªŒ
- [ ] å®æ—¶è¿›åº¦æ˜¾ç¤º
- [ ] æ›´è¯¦ç»†çš„é”™è¯¯æç¤º
- [ ] æ•°æ®å¯¹æ¯”åŠŸèƒ½
- [ ] æ‰¹é‡ç¼–è¾‘å·¥å…·

## åã€ä¾èµ–åŒ…

### åç«¯
```json
{
  "exceljs": "^4.3.0",
  "mongoose": "^7.0.0"
}
```

### å‰ç«¯
```json
{
  "antd": "^5.0.0",
  "axios": "^1.4.0",
  "react": "^18.2.0"
}
```

## åä¸€ã€æ–‡ä»¶ç»“æ„

```
backend/
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ actuatorManagementController.js  (æ§åˆ¶å™¨)
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ actuatorManagementRoutes.js      (è·¯ç”±)
â”œâ”€â”€ models/
â”‚   â””â”€â”€ Actuator.js                      (æ•°æ®æ¨¡å‹)
â””â”€â”€ utils/
    â”œâ”€â”€ actuatorExcelTemplate.js         (æ¨¡æ¿ç”Ÿæˆ)
    â””â”€â”€ actuatorExcelProcessor.js        (æ•°æ®å¤„ç†)

frontend/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ dataManagement/
â”‚       â””â”€â”€ ActuatorManagementSimplified.jsx  (ç®€åŒ–ç‰ˆç»„ä»¶)
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ DataManagement.jsx               (æ•°æ®ç®¡ç†é¡µé¢)
â””â”€â”€ services/
    â””â”€â”€ api.js                           (APIæœåŠ¡)
```

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2025-11-07  
**ç»´æŠ¤è€…**ï¼šç³»ç»Ÿå¼€å‘å›¢é˜Ÿ

