# ğŸ”§ é…ç½®ä¿®å¤æŒ‡å—

**å¼€å§‹æ—¶é—´**: 2025-11-06 15:35

---

## âœ… ç¬¬1æ­¥ï¼šæ›´æ–° GitHub Actions é…ç½®ï¼ˆå·²å®Œæˆï¼‰

å·²ä¿®å¤é…ç½®æ–‡ä»¶ï¼š
- âœ… `.github/workflows/cloudflare-pages.yml` - é¡¹ç›®åæ”¹ä¸º `smart-system`
- âœ… `.github/workflows/render-backend.yml` - é…ç½®æ­£ç¡®

---

## ğŸ”§ ç¬¬2æ­¥ï¼šå®Œæˆå¹³å°é…ç½®

### A. Cloudflare Pages é…ç½®

#### 2.1 æ£€æŸ¥é¡¹ç›®æ˜¯å¦å­˜åœ¨

1. **è®¿é—®**: https://dash.cloudflare.com/
2. **ç™»å½•**ä½ çš„è´¦å·
3. **å·¦ä¾§èœå•**: Workers & Pages
4. **æŸ¥æ‰¾**: `smart-system` é¡¹ç›®

#### 2.2 å¦‚æœé¡¹ç›®å­˜åœ¨

**æ£€æŸ¥é…ç½®**:
1. ç‚¹å‡» `smart-system` é¡¹ç›®
2. Settings â†’ Builds & deployments
3. ç¡®è®¤é…ç½®:
   ```
   Framework preset: Vite
   Build command: cd frontend && npm install && npm run build
   Build output directory: frontend/dist
   Root directory: / (æˆ–ç•™ç©º)
   ```

**æ£€æŸ¥ç¯å¢ƒå˜é‡**:
1. Settings â†’ Environment variables â†’ Production
2. ç¡®è®¤æœ‰ä»¥ä¸‹å˜é‡:
   ```
   NODE_ENV=production
   VITE_API_URL=https://project-ark.onrender.com
   ```

**å¦‚æœç¼ºå°‘ï¼Œç‚¹å‡» "Add variable" æ·»åŠ **

#### 2.3 å¦‚æœé¡¹ç›®ä¸å­˜åœ¨

**åˆ›å»ºæ–°é¡¹ç›®**:
1. ç‚¹å‡» **Create application** â†’ **Pages**
2. é€‰æ‹© **Connect to Git**
3. æˆæƒ GitHubï¼ˆå¦‚æœè¿˜æ²¡æˆæƒï¼‰
4. é€‰æ‹©ä»“åº“: `project-ark`
5. é…ç½®:
   ```
   Project name: smart-system
   Production branch: main
   Framework preset: Vite
   Build command: cd frontend && npm install && npm run build
   Build output directory: frontend/dist
   Root directory: / (ç•™ç©º)
   ```
6. ç¯å¢ƒå˜é‡:
   ```
   NODE_ENV=production
   VITE_API_URL=https://project-ark.onrender.com
   ```
7. ç‚¹å‡» **Save and Deploy**

#### 2.4 è·å– API Token å’Œ Account ID

**è·å– API Token**:
1. å³ä¸Šè§’å¤´åƒ â†’ **My Profile**
2. å·¦ä¾§ **API Tokens**
3. ç‚¹å‡» **Create Token**
4. ä½¿ç”¨æ¨¡æ¿: **Edit Cloudflare Workers**
5. é…ç½®:
   - Token name: `GitHub Actions`
   - Permissions: Account - Cloudflare Pages: Edit
6. ç‚¹å‡» **Continue to summary** â†’ **Create Token**
7. **å¤åˆ¶ Token**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰ğŸ“

**è·å– Account ID**:
1. è¿”å›ä¸»é¡µé¢
2. å³ä¾§æ å¯ä»¥çœ‹åˆ° **Account ID**
3. ç‚¹å‡»å¤åˆ¶ ğŸ“

---

### B. Render é…ç½®

#### 2.5 æ£€æŸ¥æœåŠ¡é…ç½®

1. **è®¿é—®**: https://dashboard.render.com/
2. **æ‰¾åˆ°**: `project-ark` æœåŠ¡
3. **ç‚¹å‡»**è¿›å…¥æœåŠ¡

#### 2.6 æ£€æŸ¥åŸºæœ¬é…ç½®

**Settings â†’ Build & Deploy**:
```
Build Command: cd backend && npm install
Start Command: cd backend && npm start
```

**å¦‚æœä¸æ­£ç¡®ï¼Œç‚¹å‡» Edit ä¿®æ”¹**

#### 2.7 æ£€æŸ¥ç¯å¢ƒå˜é‡

**Settings â†’ Environment**:

å¿…éœ€çš„ç¯å¢ƒå˜é‡ï¼š
```
NODE_ENV=production
PORT=10000
MONGODB_URI=ä½ çš„MongoDBè¿æ¥å­—ç¬¦ä¸²
JWT_SECRET=ä½ çš„JWTå¯†é’¥
CORS_ORIGIN=https://smart-system.pages.dev
```

**å¦‚æœç¼ºå°‘**:
1. ç‚¹å‡» **Add Environment Variable**
2. é€ä¸ªæ·»åŠ ä¸Šé¢çš„å˜é‡

**ç”Ÿæˆ JWT_SECRET**ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰:
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

#### 2.8 è·å– Deploy Hook

1. **Settings** â†’ **Deploy Hook**
2. ç‚¹å‡» **Create Deploy Hook**
3. Name: `GitHub Actions`
4. Branch: `main`
5. ç‚¹å‡» **Create**
6. **å¤åˆ¶ Hook URL** ğŸ“
   æ ¼å¼: `https://api.render.com/deploy/srv-xxxxx?key=yyyyy`

---

### C. GitHub Secrets é…ç½®

#### 2.9 æ·»åŠ  Secrets

1. **è®¿é—®**: https://github.com/ningxiarongchen-lgtm/project-ark/settings/secrets/actions
2. ç‚¹å‡» **New repository secret**
3. æ·»åŠ ä»¥ä¸‹3ä¸ª Secrets:

**Secret 1: CLOUDFLARE_API_TOKEN**
```
Name: CLOUDFLARE_API_TOKEN
Secret: ä»æ­¥éª¤ 2.4 è·å–çš„ API Token
```

**Secret 2: CLOUDFLARE_ACCOUNT_ID**
```
Name: CLOUDFLARE_ACCOUNT_ID
Secret: ä»æ­¥éª¤ 2.4 è·å–çš„ Account ID
```

**Secret 3: RENDER_DEPLOY_HOOK**
```
Name: RENDER_DEPLOY_HOOK
Secret: ä»æ­¥éª¤ 2.8 è·å–çš„ Deploy Hook URL
```

æ¯ä¸ªæ·»åŠ åç‚¹å‡» **Add secret**

---

## ğŸš€ ç¬¬3æ­¥ï¼šè§¦å‘éƒ¨ç½²

å®Œæˆä¸Šè¿°é…ç½®åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
cd "/Users/hexiaoxiao/Desktop/Model Selection System"

# æäº¤é…ç½®æ›´æ–°
git add .github/workflows/cloudflare-pages.yml
git add "ğŸ”§é…ç½®ä¿®å¤æŒ‡å—.md"
git commit -m "fix: update cloudflare project name and add configuration guide"
git push origin main
```

è¿™å°†è§¦å‘è‡ªåŠ¨éƒ¨ç½²ï¼

---

## â° ç¬¬4æ­¥ï¼šç­‰å¾…éƒ¨ç½²ï¼ˆ5-6åˆ†é’Ÿï¼‰

éƒ¨ç½²å¼€å§‹åï¼š

**æŸ¥çœ‹ GitHub Actions**:
- https://github.com/ningxiarongchen-lgtm/project-ark/actions
- åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå·¥ä½œæµè¿è¡Œ:
  - ğŸ”µ Deploy to Cloudflare Pages
  - ğŸ”µ Deploy to Render

**æŸ¥çœ‹ Cloudflare**:
- https://dash.cloudflare.com/
- Workers & Pages â†’ smart-system â†’ Deployments

**æŸ¥çœ‹ Render**:
- https://dashboard.render.com/
- project-ark æœåŠ¡ â†’ Events

---

## âœ… ç¬¬5æ­¥ï¼šéªŒè¯éƒ¨ç½²ï¼ˆ6åˆ†é’Ÿåï¼‰

```bash
cd "/Users/hexiaoxiao/Desktop/Model Selection System"

# è¿è¡ŒéªŒè¯è„šæœ¬
FRONTEND_URL="https://smart-system.pages.dev" \
BACKEND_URL="https://project-ark.onrender.com" \
./scripts/check-deployment.sh
```

æˆ–æ‰‹åŠ¨æµ‹è¯•ï¼š

```bash
# æµ‹è¯•å‰ç«¯
curl -I https://smart-system.pages.dev

# æµ‹è¯•åç«¯
curl https://project-ark.onrender.com/api/health
```

**æˆåŠŸæ ‡å¿—**:
- å‰ç«¯: HTTP 200 + æ˜¾ç¤ºç½‘é¡µ
- åç«¯: `{"status":"OK","message":"Project Ark Platform API is running"...}`

---

## ğŸ“‹ é…ç½®æ£€æŸ¥æ¸…å•

åœ¨ç»§ç»­ä¹‹å‰ï¼Œç¡®è®¤ï¼š

### Cloudflare Pages
- [ ] é¡¹ç›® `smart-system` å·²åˆ›å»º/å­˜åœ¨
- [ ] æ„å»ºå‘½ä»¤é…ç½®æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡å·²æ·»åŠ 
- [ ] API Token å·²è·å–
- [ ] Account ID å·²è·å–

### Render
- [ ] æœåŠ¡ `project-ark` å·²åˆ›å»º
- [ ] æ„å»ºå’Œå¯åŠ¨å‘½ä»¤æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®ï¼ˆç‰¹åˆ«æ˜¯ MongoDBï¼‰
- [ ] Deploy Hook å·²è·å–

### GitHub Secrets
- [ ] CLOUDFLARE_API_TOKEN å·²æ·»åŠ 
- [ ] CLOUDFLARE_ACCOUNT_ID å·²æ·»åŠ 
- [ ] RENDER_DEPLOY_HOOK å·²æ·»åŠ 

### å‡†å¤‡æ¨é€
- [ ] é…ç½®æ–‡ä»¶å·²æ›´æ–°
- [ ] å‡†å¤‡å¥½æ¨é€åˆ° GitHub

---

## ğŸ†˜ å¦‚æœé‡åˆ°é—®é¢˜

### é—®é¢˜ 1: Cloudflare éƒ¨ç½²å¤±è´¥

**æ£€æŸ¥**:
1. GitHub Actions æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
2. API Token æƒé™æ˜¯å¦è¶³å¤Ÿ
3. é¡¹ç›®åç§°æ˜¯å¦å®Œå…¨åŒ¹é…

**è§£å†³**:
- é‡æ–°ç”Ÿæˆ API Token
- ç¡®è®¤é¡¹ç›®åç§°
- æ‰‹åŠ¨åœ¨ Cloudflare è§¦å‘ä¸€æ¬¡éƒ¨ç½²æµ‹è¯•

### é—®é¢˜ 2: Render éƒ¨ç½²å¤±è´¥

**æ£€æŸ¥**:
1. Deploy Hook URL æ˜¯å¦å®Œæ•´
2. ç¯å¢ƒå˜é‡æ˜¯å¦éƒ½é…ç½®äº†
3. MongoDB è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®

**è§£å†³**:
- åœ¨ Render Dashboard æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—
- æµ‹è¯• MongoDB è¿æ¥
- æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡éƒ¨ç½²

### é—®é¢˜ 3: GitHub Actions æœªè¿è¡Œ

**æ£€æŸ¥**:
1. Secrets æ˜¯å¦éƒ½æ·»åŠ äº†
2. å·¥ä½œæµæ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯

**è§£å†³**:
- è®¿é—® GitHub Actions é¡µé¢
- ç‚¹å‡» "Run workflow" æ‰‹åŠ¨è§¦å‘

---

## ğŸ’¡ å¿«é€Ÿå‚è€ƒ

### éœ€è¦çš„ URLs

| å¹³å° | URL |
|------|-----|
| Cloudflare Dashboard | https://dash.cloudflare.com/ |
| Render Dashboard | https://dashboard.render.com/ |
| GitHub Actions | https://github.com/ningxiarongchen-lgtm/project-ark/actions |
| GitHub Secrets | https://github.com/ningxiarongchen-lgtm/project-ark/settings/secrets/actions |

### éœ€è¦çš„å€¼

| é…ç½®é¡¹ | ä»å“ªé‡Œè·å– | æ ¼å¼ç¤ºä¾‹ |
|--------|-----------|---------|
| CLOUDFLARE_API_TOKEN | Cloudflare Profile â†’ API Tokens | cfp_xxxxx |
| CLOUDFLARE_ACCOUNT_ID | Cloudflare Dashboard | abc123... |
| RENDER_DEPLOY_HOOK | Render Settings â†’ Deploy Hook | https://api.render.com/deploy/... |
| MONGODB_URI | MongoDB Atlas | mongodb+srv://... |
| JWT_SECRET | å‘½ä»¤ç”Ÿæˆ | 32ä½éšæœºå­—ç¬¦ä¸² |

---

## ğŸ¯ ä¸‹ä¸€æ­¥

**å®Œæˆå¹³å°é…ç½®åå‘Šè¯‰æˆ‘**ï¼š

1. "é…ç½®å®Œæˆ" - æˆ‘å¸®ä½ æäº¤å¹¶æ¨é€ï¼Œè§¦å‘éƒ¨ç½²
2. "é‡åˆ°é—®é¢˜" - å‘Šè¯‰æˆ‘å“ªä¸€æ­¥æœ‰é—®é¢˜ï¼Œæˆ‘å¸®ä½ è§£å†³
3. "éœ€è¦è¯¦ç»†è¯´æ˜" - æˆ‘æä¾›æŸä¸ªæ­¥éª¤çš„è¯¦ç»†æˆªå›¾è¯´æ˜

**å‡†å¤‡å¥½äº†å—ï¼Ÿ** ğŸ˜Š

