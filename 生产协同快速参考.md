# ç”Ÿäº§ååŒåŠŸèƒ½å¿«é€Ÿå‚è€ƒ ğŸ”§

## ğŸ“Œ æ ¸å¿ƒæ–‡ä»¶

### åç«¯
```
backend/
â”œâ”€â”€ models/ProductionOrder.js           # ç”Ÿäº§è®¢å•æ•°æ®æ¨¡å‹
â”œâ”€â”€ controllers/productionController.js # ç”Ÿäº§æ§åˆ¶å™¨
â””â”€â”€ routes/productionRoutes.js          # ç”Ÿäº§è·¯ç”±
```

### å‰ç«¯
```
frontend/src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ ProductionSchedule.jsx          # ç”Ÿäº§æ’æœŸé¡µ
â”‚   â””â”€â”€ OrderDetails.jsx                # è®¢å•è¯¦æƒ…é¡µ(æ–°å¢ç”Ÿäº§åŠŸèƒ½)
â””â”€â”€ services/api.js                     # APIæœåŠ¡(æ–°å¢productionAPI)
```

---

## ğŸ”— APIç«¯ç‚¹é€ŸæŸ¥

| åŠŸèƒ½ | æ–¹æ³• | ç«¯ç‚¹ |
|------|------|------|
| ä»è®¢å•åˆ›å»ºç”Ÿäº§ä»»åŠ¡ | POST | `/api/production/from-order/:salesOrderId` |
| è·å–ç”Ÿäº§è®¢å•åˆ—è¡¨ | GET | `/api/production?status=&priority=&page=&limit=` |
| è·å–ç”Ÿäº§è®¢å•è¯¦æƒ… | GET | `/api/production/:id` |
| æ›´æ–°ç”Ÿäº§è®¢å• | PUT | `/api/production/:id` |
| æ›´æ–°ç”Ÿäº§çŠ¶æ€ | PATCH | `/api/production/:id/status` |
| æ›´æ–°ç”Ÿäº§è¿›åº¦ | PATCH | `/api/production/:id/progress` |
| åˆ†é…èµ„æº | POST | `/api/production/:id/assign-resources` |
| åˆ é™¤ç”Ÿäº§è®¢å• | DELETE | `/api/production/:id` |
| è·å–ç»Ÿè®¡ | GET | `/api/production/statistics` |

---

## ğŸ“‹ ç”Ÿäº§çŠ¶æ€

```
Pending â†’ Scheduled â†’ In Production â†’ Completed
                            â†“
                         Paused
                            â†“
                        Delayed
                            â†“
                       Cancelled
```

**ä¼˜å…ˆçº§**: Low | Normal | High | Urgent

**ç‰©æ–™çŠ¶æ€**: Pending | In Production | Completed | On Hold

---

## ğŸ¯ ä½¿ç”¨æµç¨‹

### 1. ä»é”€å”®è®¢å•åˆ›å»ºç”Ÿäº§ä»»åŠ¡

```javascript
// å‰ç«¯è°ƒç”¨
import { productionAPI } from '../services/api'

const productionData = {
  plannedStartDate: "2025-10-28",
  plannedEndDate: "2025-11-27",
  priority: "High",
  productionLines: ["ç”Ÿäº§çº¿A", "ç”Ÿäº§çº¿B"],
  productionNotes: "æ³¨æ„è´¨é‡æ§åˆ¶",
  technicalRequirements: "æŒ‰æ ‡å‡†å·¥è‰º",
  specialInstructions: "ä¼˜å…ˆå¤„ç†"
}

const response = await productionAPI.createFromOrder(salesOrderId, productionData)
```

### 2. è·å–ç”Ÿäº§è®¢å•åˆ—è¡¨

```javascript
// å¸¦ç­›é€‰æ¡ä»¶
const params = {
  status: 'In Production',
  priority: 'High',
  page: 1,
  limit: 20,
  startDate: '2025-10-01',
  endDate: '2025-12-31'
}

const response = await productionAPI.getAll(params)
```

### 3. æ›´æ–°ç”Ÿäº§è¿›åº¦

```javascript
const progressData = {
  itemIndex: 0,  // ç‰©æ–™ç´¢å¼•
  producedQuantity: 7,
  qualifiedQuantity: 7,
  defectiveQuantity: 0
}

await productionAPI.updateProgress(productionId, progressData)
```

### 4. åˆ†é…ç”Ÿäº§èµ„æº

```javascript
const resourceData = {
  supervisorId: "userId123",
  operatorIds: ["userId456", "userId789"],
  productionLines: ["ç”Ÿäº§çº¿A", "ç”Ÿäº§çº¿B"],
  equipment: [
    { name: "è£…é…çº¿1", id: "EQ001" }
  ]
}

await productionAPI.assignResources(productionId, resourceData)
```

---

## âš ï¸ é‡è¦é™åˆ¶

1. **åªæœ‰å·²ç¡®è®¤æˆ–ç”Ÿäº§ä¸­çš„é”€å”®è®¢å•æ‰èƒ½åˆ›å»ºç”Ÿäº§ä»»åŠ¡**
2. **æ¯ä¸ªé”€å”®è®¢å•åªèƒ½åˆ›å»ºä¸€ä¸ªç”Ÿäº§è®¢å•**(é˜²æ­¢é‡å¤)
3. **åªèƒ½åˆ é™¤ `Pending` æˆ– `Cancelled` çŠ¶æ€çš„ç”Ÿäº§è®¢å•**
4. **è¿›åº¦æ›´æ–°ä¼šè‡ªåŠ¨è®¡ç®—åˆæ ¼ç‡å’Œå®ŒæˆçŠ¶æ€**

---

## ğŸ¨ UIç»„ä»¶é€ŸæŸ¥

### OrderDetails.jsx æ–°å¢æŒ‰é’®
```jsx
{/* åˆ›å»ºç”Ÿäº§ä»»åŠ¡æŒ‰é’® - æ©™è‰²æ¸å˜ */}
<Button 
  icon={<ToolOutlined />}
  disabled={!['Confirmed', 'In Production'].includes(order.status)}
>
  åˆ›å»ºç”Ÿäº§ä»»åŠ¡
</Button>
```

### ProductionSchedule.jsx æ ¸å¿ƒç»„ä»¶

**ç»Ÿè®¡å¡ç‰‡**:
- ç”Ÿäº§è®¢å•æ€»æ•°
- å¾…ç”Ÿäº§/ç”Ÿäº§ä¸­/å·²å®Œæˆæ•°é‡
- å¹³å‡å®Œæˆç‡
- å¹³å‡åˆæ ¼ç‡

**å…³é”®åˆ—**:
- ç”Ÿäº§è®¢å•å·(PO-YYYYMM-XXXX)
- è¿›åº¦æ¡(Progress)
- åˆæ ¼ç‡å¾½ç« (Badge)
- ä¼˜å…ˆçº§æ ‡ç­¾(Tag)
- çŠ¶æ€æ ‡ç­¾(å¸¦å›¾æ ‡)
- é€¾æœŸè­¦å‘Š

---

## ğŸ“Š æ•°æ®å­—æ®µé€ŸæŸ¥

### ProductionOrder æ ¸å¿ƒå­—æ®µ
```javascript
{
  productionOrderNumber: String,     // è‡ªåŠ¨ç”Ÿæˆ PO-YYYYMM-XXXX
  status: String,                    // ç”Ÿäº§çŠ¶æ€
  priority: String,                  // ä¼˜å…ˆçº§
  salesOrder: ObjectId,              // å…³è”é”€å”®è®¢å•
  orderSnapshot: Object,             // è®¢å•å¿«ç…§
  
  schedule: {
    plannedStartDate: Date,
    plannedEndDate: Date,
    actualStartDate: Date,
    actualCompletedDate: Date
  },
  
  productionItems: [{
    model_name: String,
    ordered_quantity: Number,
    produced_quantity: Number,
    qualified_quantity: Number,
    defective_quantity: Number,
    production_status: String,
    production_line: String
  }],
  
  resources: {
    production_lines: [String],
    supervisor: ObjectId,
    operators: [ObjectId],
    equipment: [Object]
  },
  
  progress: {
    overall_percentage: Number,      // 0-100
    total_quantity: Number,
    completed_quantity: Number,
    in_progress_quantity: Number
  },
  
  quality: {
    pass_rate: Number,              // 0-100
    inspector: ObjectId
  }
}
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæ— æ³•åˆ›å»ºç”Ÿäº§ä»»åŠ¡ï¼Ÿ
**A**: æ£€æŸ¥ä»¥ä¸‹æ¡ä»¶ï¼š
- é”€å”®è®¢å•çŠ¶æ€å¿…é¡»ä¸º `Confirmed` æˆ– `In Production`
- è¯¥é”€å”®è®¢å•è¿˜æ²¡æœ‰åˆ›å»ºè¿‡ç”Ÿäº§ä»»åŠ¡

### Q2: å¦‚ä½•æ›´æ–°ç”Ÿäº§è¿›åº¦ï¼Ÿ
**A**: 
- ä½¿ç”¨ PATCH `/api/production/:id/progress`
- æä¾›ç‰©æ–™ç´¢å¼•å’Œæ•°é‡æ•°æ®
- ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—è¿›åº¦ç™¾åˆ†æ¯”å’Œåˆæ ¼ç‡

### Q3: ç”Ÿäº§è¿›åº¦å¦‚ä½•è‡ªåŠ¨è®¡ç®—ï¼Ÿ
**A**: 
```javascript
è¿›åº¦ç™¾åˆ†æ¯” = (å·²å®Œæˆæ•°é‡ / æ€»è®¢å•æ•°é‡) Ã— 100
åˆæ ¼ç‡ = (åˆæ ¼æ•°é‡ / å·²ç”Ÿäº§æ•°é‡) Ã— 100
```

### Q4: ä»€ä¹ˆæ—¶å€™ç”Ÿäº§è®¢å•è‡ªåŠ¨å®Œæˆï¼Ÿ
**A**: 
- å½“æ‰€æœ‰ç‰©æ–™çš„ `qualified_quantity >= ordered_quantity` æ—¶
- ç³»ç»Ÿè‡ªåŠ¨å°†çŠ¶æ€æ›´æ–°ä¸º `Completed`
- è®°å½•å®é™…å®Œæˆæ—¶é—´

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•

### æµ‹è¯•æ­¥éª¤
```bash
# 1. å¯åŠ¨åç«¯
cd backend
npm start

# 2. å¯åŠ¨å‰ç«¯
cd frontend
npm run dev

# 3. åœ¨æµè§ˆå™¨ä¸­
# - ç™»å½•ç³»ç»Ÿ
# - è¿›å…¥"è®¢å•ç®¡ç†"
# - é€‰æ‹©ä¸€ä¸ªå·²ç¡®è®¤çš„è®¢å•
# - ç‚¹å‡»"åˆ›å»ºç”Ÿäº§ä»»åŠ¡"
# - å¡«å†™ç”Ÿäº§è®¡åˆ’å¹¶æäº¤
# - åœ¨"ç”Ÿäº§æ’æœŸ"æŸ¥çœ‹æ–°ä»»åŠ¡
# - æµ‹è¯•çŠ¶æ€æ›´æ–°å’Œè¿›åº¦æ›´æ–°
```

---

## ğŸ“ˆ è‡ªåŠ¨è®¡ç®—åŠŸèƒ½

### 1. è¿›åº¦è®¡ç®—
```javascript
// è‡ªåŠ¨è®¡ç®—
productionOrder.calculateProgress()

// è®¡ç®—å†…å®¹:
// - overall_percentage: æ€»ä½“å®Œæˆç™¾åˆ†æ¯”
// - total_quantity: æ‰€æœ‰ç‰©æ–™çš„æ€»æ•°é‡
// - completed_quantity: å·²å®Œæˆçš„æ€»æ•°é‡
// - in_progress_quantity: åœ¨äº§æ•°é‡
```

### 2. è´¨é‡è®¡ç®—
```javascript
// è‡ªåŠ¨è®¡ç®—
productionOrder.calculateQualityRate()

// è®¡ç®—å†…å®¹:
// - pass_rate: åˆæ ¼ç‡ç™¾åˆ†æ¯”
// - åŸºäºæ‰€æœ‰ç‰©æ–™çš„åˆæ ¼/ç”Ÿäº§æ•°é‡
```

### 3. æ—¥å¿—è®°å½•
```javascript
// è‡ªåŠ¨æ·»åŠ æ—¥å¿—
productionOrder.addLog(action, description, userId)

// è®°å½•çš„æ“ä½œ:
// - Created: åˆ›å»º
// - Status Changed: çŠ¶æ€å˜æ›´
// - Progress Updated: è¿›åº¦æ›´æ–°
// - Resources Assigned: èµ„æºåˆ†é…
// - Completed: å®Œæˆ
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ç”Ÿäº§è®¡åˆ’
- åˆç†è®¾ç½®è®¡åˆ’å¼€å§‹/ç»“æŸæ—¥æœŸ
- æ ¹æ®è®¢å•ç´§æ€¥ç¨‹åº¦è®¾ç½®ä¼˜å…ˆçº§
- é¢„å…ˆåˆ†é…ç”Ÿäº§çº¿å’Œäººå‘˜
- è®°å½•è¯¦ç»†çš„æŠ€æœ¯è¦æ±‚

### 2. è¿›åº¦è·Ÿè¸ª
- åŠæ—¶æ›´æ–°ç”Ÿäº§è¿›åº¦
- è®°å½•åˆæ ¼å’Œä¸åˆæ ¼æ•°é‡
- å…³æ³¨åˆæ ¼ç‡æŒ‡æ ‡
- å¤„ç†è´¨é‡é—®é¢˜

### 3. èµ„æºç®¡ç†
- åˆç†åˆ†é…ç”Ÿäº§çº¿
- æŒ‡å®šè´Ÿè´£äººå’Œæ“ä½œå‘˜
- è®°å½•ä½¿ç”¨çš„è®¾å¤‡
- ä¼˜åŒ–èµ„æºåˆ©ç”¨ç‡

### 4. çŠ¶æ€ç®¡ç†
- æŒ‰å®é™…æƒ…å†µæ›´æ–°çŠ¶æ€
- å»¶æœŸæ—¶è®°å½•åŸå› 
- æš‚åœæ—¶è¯´æ˜æƒ…å†µ
- å®ŒæˆååŠæ—¶æ ‡è®°

---

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½è‡ªåŠ¨åŒ–
- âœ… è¿›åº¦è‡ªåŠ¨è®¡ç®—
- âœ… è´¨é‡è‡ªåŠ¨ç»Ÿè®¡
- âœ… çŠ¶æ€è‡ªåŠ¨åˆ¤æ–­
- âœ… æ—¶é—´è‡ªåŠ¨è®°å½•

### 2. å¯è§†åŒ–å±•ç¤º
- ğŸ“Š è¿›åº¦æ¡æ˜¾ç¤º
- ğŸ·ï¸ å½©è‰²æ ‡ç­¾
- ğŸ“ˆ ç»Ÿè®¡å¡ç‰‡
- âš ï¸ é€¾æœŸè­¦å‘Š

### 3. å®Œæ•´è¿½æº¯
- ğŸ“ æ“ä½œæ—¥å¿—
- ğŸ‘¤ äººå‘˜è®°å½•
- â° æ—¶é—´æˆ³
- ğŸ” å®¡è®¡è¿½è¸ª

---

## ğŸ’¡ æç¤ºæŠ€å·§

### 1. ä¼˜å…ˆçº§ä½¿ç”¨
- **Urgent**: å®¢æˆ·ç´§æ€¥è®¢å•ã€ç‰¹æ®Šè¦æ±‚
- **High**: äº¤æœŸç´§ã€é‡è¦å®¢æˆ·
- **Normal**: å¸¸è§„è®¢å•
- **Low**: å¤‡è´§ã€è¯•äº§

### 2. çŠ¶æ€ç®¡ç†
- ç”Ÿäº§å¼€å§‹å‰å…ˆ **Scheduled** æ’æœŸ
- å¼€å§‹ç”Ÿäº§æ—¶æ›´æ–°ä¸º **In Production**
- é‡åˆ°é—®é¢˜æ—¶ä½¿ç”¨ **Paused** æˆ– **Delayed**
- æ‰€æœ‰ç‰©æ–™å®Œæˆåè‡ªåŠ¨ **Completed**

### 3. è¿›åº¦æ›´æ–°
- æ¯ç­æ¬¡ç»“æŸæ›´æ–°è¿›åº¦
- åŠæ—¶è®°å½•ä¸åˆæ ¼å“
- å…³æ³¨åˆæ ¼ç‡è¶‹åŠ¿
- å¼‚å¸¸æƒ…å†µç«‹å³å¤„ç†

---

## ğŸš€ æ‰©å±•æ–¹å‘

å¯æ‰©å±•çš„åŠŸèƒ½ï¼š
- âœ¨ ç”Ÿäº§è¯¦æƒ…é¡µ
- âœ¨ ç”˜ç‰¹å›¾æ’æœŸ
- âœ¨ ç”Ÿäº§çœ‹æ¿
- âœ¨ å·¥å•æ‰“å°
- âœ¨ ç‰©æ–™éœ€æ±‚è®¡åˆ’
- âœ¨ è®¾å¤‡ç®¡ç†
- âœ¨ IoTæ•°æ®é‡‡é›†

---

**æ›´æ–°æ—¶é—´**: 2025-10-27  
**ç‰ˆæœ¬**: v1.0.0

ğŸ’¡ **æç¤º**: è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿå‚è€ƒæ–‡æ¡£ã€‚è¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹ã€Šç”Ÿäº§ååŒåŠŸèƒ½å®ŒæˆæŠ¥å‘Š.mdã€‹


