# MESåˆ¶é€ æ‰§è¡Œç³»ç»Ÿå¼€å‘å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ¬¡å¼€å‘å®ç°äº†å®Œæ•´çš„MESï¼ˆManufacturing Execution Systemï¼‰åˆ¶é€ æ‰§è¡Œç³»ç»Ÿï¼ŒåŒ…æ‹¬å·¥ä½œä¸­å¿ƒç®¡ç†ã€å·¥è‰ºè·¯çº¿ç®¡ç†ã€å·¥å•è‡ªåŠ¨ç”Ÿæˆã€è½¦é—´ç»ˆç«¯ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

**å®Œæˆæ—¶é—´**: 2025-10-28  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶å¯ç”¨  
**Linting**: âœ… é›¶é”™è¯¯  
**æ–‡ä»¶æ•°é‡**: 16ä¸ªæ–‡ä»¶

---

## ğŸ¯ éœ€æ±‚å›é¡¾

ç”¨æˆ·è¦æ±‚å®ç°ä¸‰ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼š

1. **åç«¯æ¨¡å‹åˆ›å»º**: å·¥ä½œä¸­å¿ƒ(WorkCenter)ã€å·¥è‰ºè·¯çº¿(Routing)ã€å·¥å•(WorkOrder)æ¨¡å‹ï¼Œå¹¶é‡æ„ç”Ÿäº§è®¢å•æ”¯æŒå·¥å•åˆ†è§£
2. **æ ¸å¿ƒæœåŠ¡å‡½æ•°**: å®ç°ä»ç”Ÿäº§è®¢å•è‡ªåŠ¨ç”Ÿæˆå·¥å•çš„æ ¸å¿ƒé€»è¾‘
3. **å‰ç«¯ç•Œé¢**: é‡æ„ç”Ÿäº§æ’æœŸé¡µé¢æ˜¾ç¤ºå·¥å•ï¼Œåˆ›å»ºä¸“ä¸ºå¹³æ¿è®¾è®¡çš„è½¦é—´ç»ˆç«¯é¡µé¢

---

## âœ… å®Œæˆå†…å®¹

### ä¸€ã€åç«¯å¼€å‘

#### 1. æ•°æ®æ¨¡å‹

##### A. å·¥ä½œä¸­å¿ƒæ¨¡å‹ (WorkCenter.js)

**æ–‡ä»¶è·¯å¾„**: `backend/models/WorkCenter.js`

**æ ¸å¿ƒå­—æ®µ**:
```javascript
{
  code: String,                    // å·¥ä½œä¸­å¿ƒç¼–ç 
  name: String,                    // å·¥ä½œä¸­å¿ƒåç§°
  type: String,                    // ç±»å‹ï¼ˆè£…é…/æœºåŠ å·¥/æµ‹è¯•/åŒ…è£…/æ£€éªŒ/å…¶ä»–ï¼‰
  description: String,             // æè¿°
  workshop: String,                // æ‰€åœ¨è½¦é—´
  location: String,                // ä½ç½®
  
  capacity: {                      // äº§èƒ½ä¿¡æ¯
    standard_capacity: Number,     // æ ‡å‡†äº§èƒ½ï¼ˆæ¯å°æ—¶ï¼‰
    capacity_unit: String,         // äº§èƒ½å•ä½
    shifts_per_day: Number,        // å·¥ä½œç­æ¬¡æ•°
    hours_per_shift: Number        // æ¯ç­æ¬¡å·¥ä½œå°æ—¶æ•°
  },
  
  equipment: {                     // è®¾å¤‡ä¿¡æ¯
    main_equipment: [{
      name: String,
      model: String,
      quantity: Number
    }],
    status: String                 // è®¾å¤‡çŠ¶æ€ï¼ˆæ­£å¸¸/ç»´æŠ¤ä¸­/æ•…éšœ/åœç”¨ï¼‰
  },
  
  staffing: {                      // äººå‘˜é…ç½®
    required_operators: Number,    // æ‰€éœ€æ“ä½œå·¥æ•°é‡
    current_operators: Number,     // å½“å‰æ“ä½œå·¥æ•°é‡
    skill_requirements: [String]   // æŠ€èƒ½è¦æ±‚
  },
  
  supervisor: ObjectId,            // è´Ÿè´£äºº
  operators: [ObjectId],           // å…³è”æ“ä½œå·¥
  
  capable_operations: [{           // å¯å¤„ç†çš„å·¥åºç±»å‹
    operation_name: String,
    standard_time: Number,         // æ ‡å‡†å·¥æ—¶ï¼ˆåˆ†é’Ÿï¼‰
    setup_time: Number             // å‡†å¤‡æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  }],
  
  calendar: {                      // å·¥ä½œæ—¥å†
    working_days: [Number],        // å·¥ä½œæ—¥ï¼ˆ0-6ï¼‰
    holidays: [{
      date: Date,
      name: String
    }]
  },
  
  quality_metrics: {               // è´¨é‡æŒ‡æ ‡
    target_pass_rate: Number,      // åˆæ ¼ç‡ç›®æ ‡
    current_pass_rate: Number,     // å½“å‰åˆæ ¼ç‡
    rework_rate: Number            // è¿”å·¥ç‡
  },
  
  cost: {                          // æˆæœ¬ä¿¡æ¯
    hourly_rate: Number,           // å°æ—¶è´¹ç‡
    unit_cost: Number              // å•ä»¶æˆæœ¬
  }
}
```

**è™šæ‹Ÿå­—æ®µ**:
- `utilization_rate`: åˆ©ç”¨ç‡ï¼ˆå½“å‰äººå‘˜/æ‰€éœ€äººå‘˜ï¼‰
- `daily_capacity`: æ¯æ—¥äº§èƒ½

**å®ä¾‹æ–¹æ³•**:
- `canPerformOperation(operationName)`: æ£€æŸ¥æ˜¯å¦å¯æ‰§è¡ŒæŸå·¥åº
- `getOperationTime(operationName)`: è·å–å·¥åºæ ‡å‡†å·¥æ—¶
- `isWorkingDay(date)`: æ£€æŸ¥æ˜¯å¦å·¥ä½œæ—¥

**é™æ€æ–¹æ³•**:
- `findByOperation(operationName)`: æŸ¥æ‰¾å¯æ‰§è¡ŒæŸå·¥åºçš„å·¥ä½œä¸­å¿ƒ
- `getStatistics()`: è·å–ç»Ÿè®¡ä¿¡æ¯

##### B. å·¥è‰ºè·¯çº¿æ¨¡å‹ (Routing.js)

**æ–‡ä»¶è·¯å¾„**: `backend/models/Routing.js`

**æ ¸å¿ƒå­—æ®µ**:
```javascript
{
  code: String,                    // å·¥è‰ºè·¯çº¿ç¼–ç 
  name: String,                    // å·¥è‰ºè·¯çº¿åç§°
  
  product: {                       // å…³è”äº§å“
    product_id: ObjectId,
    model_base: String,
    version: String
  },
  
  version: String,                 // ç‰ˆæœ¬å·
  status: String,                  // çŠ¶æ€ï¼ˆè‰ç¨¿/å®¡æ‰¹ä¸­/å·²å‘å¸ƒ/å·²åœç”¨ï¼‰
  
  operations: [{                   // å·¥åºåˆ—è¡¨
    sequence: Number,              // å·¥åºåºå·
    operation_code: String,        // å·¥åºç¼–ç 
    operation_name: String,        // å·¥åºåç§°
    operation_type: String,        // å·¥åºç±»å‹
    description: String,           // å·¥åºæè¿°
    
    work_center: ObjectId,         // æŒ‡å®šå·¥ä½œä¸­å¿ƒ
    alternative_work_centers: [ObjectId],  // å¤‡é€‰å·¥ä½œä¸­å¿ƒ
    
    timing: {                      // æ—¶é—´ä¿¡æ¯ï¼ˆåˆ†é’Ÿï¼‰
      setup_time: Number,          // å‡†å¤‡æ—¶é—´
      unit_time: Number,           // å•ä»¶åŠ å·¥æ—¶é—´
      wait_time: Number,           // ç­‰å¾…æ—¶é—´
      move_time: Number            // ç§»åŠ¨æ—¶é—´
    },
    
    materials: [{                  // æ‰€éœ€ç‰©æ–™
      material_code: String,
      material_name: String,
      quantity: Number,
      unit: String
    }],
    
    tools: [{                      // æ‰€éœ€å·¥å…·/å¤¹å…·
      tool_code: String,
      tool_name: String,
      quantity: Number
    }],
    
    quality_checks: [{             // è´¨é‡æ£€æŸ¥ç‚¹
      check_point: String,
      check_method: String,
      acceptance_criteria: String
    }],
    
    process_parameters: [{         // å·¥è‰ºå‚æ•°
      parameter_name: String,
      target_value: String,
      tolerance: String,
      unit: String
    }],
    
    work_instructions: String,     // ä½œä¸šæŒ‡å¯¼
    safety_notes: String,          // å®‰å…¨æ³¨æ„äº‹é¡¹
    is_critical: Boolean,          // æ˜¯å¦å…³é”®å·¥åº
    allow_parallel: Boolean,       // æ˜¯å¦å…è®¸å¹¶è¡Œ
    prerequisites: [Number]        // å‰ç½®å·¥åº
  }],
  
  total_time: Number,              // æ€»å·¥æ—¶ä¼°ç®—ï¼ˆåˆ†é’Ÿï¼‰
  total_cost: Number,              // æ€»æˆæœ¬ä¼°ç®—
  
  batch_size: {                    // é€‚ç”¨æ‰¹é‡èŒƒå›´
    min: Number,
    max: Number
  },
  
  approval: {                      // å®¡æ‰¹ä¿¡æ¯
    status: String,
    approver: ObjectId,
    approval_date: Date,
    comments: String
  },
  
  release: {                       // å‘å¸ƒä¿¡æ¯
    release_date: Date,
    released_by: ObjectId,
    effective_date: Date
  }
}
```

**ä¿å­˜å‰éªŒè¯**:
- å·¥åºæŒ‰åºå·æ’åº
- è‡ªåŠ¨è®¡ç®—æ€»å·¥æ—¶
- éªŒè¯å·¥åºåºå·è¿ç»­æ€§
- éªŒè¯å‰ç½®å·¥åºæœ‰æ•ˆæ€§

**è™šæ‹Ÿå­—æ®µ**:
- `critical_path`: å…³é”®è·¯å¾„ï¼ˆæ‰€æœ‰å…³é”®å·¥åºï¼‰

**å®ä¾‹æ–¹æ³•**:
- `getOperation(sequence)`: è·å–æŒ‡å®šå·¥åº
- `getNextOperation(currentSequence)`: è·å–ä¸‹ä¸€é“å·¥åº
- `getParallelOperations(sequence)`: è·å–å¯å¹¶è¡Œçš„å·¥åº
- `arePrerequisitesMet(sequence, completedSequences)`: æ£€æŸ¥ä¾èµ–æ˜¯å¦æ»¡è¶³
- `calculateBatchTime(quantity)`: è®¡ç®—æ‰¹é‡æ€»å·¥æ—¶
- `releaseRouting(userId)`: å‘å¸ƒå·¥è‰ºè·¯çº¿

**é™æ€æ–¹æ³•**:
- `findByProduct(productId)`: æ ¹æ®äº§å“æŸ¥æ‰¾å·¥è‰ºè·¯çº¿
- `getReleasedRoutings()`: è·å–å·²å‘å¸ƒçš„å·¥è‰ºè·¯çº¿
- `getStatistics()`: è·å–ç»Ÿè®¡ä¿¡æ¯

##### C. å·¥å•æ¨¡å‹ (WorkOrder.js)

**æ–‡ä»¶è·¯å¾„**: `backend/models/WorkOrder.js`

**æ ¸å¿ƒå­—æ®µ**:
```javascript
{
  work_order_number: String,       // å·¥å•ç¼–å·ï¼ˆè‡ªåŠ¨ç”Ÿæˆ: WO-YYYYMMDD-0001ï¼‰
  
  production_order: ObjectId,      // å…³è”ç”Ÿäº§è®¢å•
  sales_order: ObjectId,           // å…³è”é”€å”®è®¢å•
  
  product: {                       // äº§å“ä¿¡æ¯
    product_id: ObjectId,
    model_base: String,
    version: String
  },
  
  operation: {                     // å·¥åºä¿¡æ¯
    sequence: Number,
    operation_code: String,
    operation_name: String,
    operation_type: String,
    description: String
  },
  
  work_center: ObjectId,           // å·¥ä½œä¸­å¿ƒ
  
  plan: {                          // è®¡åˆ’ä¿¡æ¯
    planned_quantity: Number,      // è®¡åˆ’æ•°é‡
    planned_start_time: Date,      // è®¡åˆ’å¼€å§‹æ—¶é—´
    planned_end_time: Date,        // è®¡åˆ’å®Œæˆæ—¶é—´
    planned_duration: Number       // è®¡åˆ’å·¥æ—¶ï¼ˆåˆ†é’Ÿï¼‰
  },
  
  actual: {                        // å®é™…æ‰§è¡Œä¿¡æ¯
    actual_quantity: Number,       // å®é™…æ•°é‡
    good_quantity: Number,         // åˆæ ¼æ•°é‡
    reject_quantity: Number,       // ä¸åˆæ ¼æ•°é‡
    rework_quantity: Number,       // è¿”å·¥æ•°é‡
    scrap_quantity: Number,        // æŠ¥åºŸæ•°é‡
    actual_start_time: Date,       // å®é™…å¼€å§‹æ—¶é—´
    actual_end_time: Date,         // å®é™…å®Œæˆæ—¶é—´
    actual_duration: Number        // å®é™…å·¥æ—¶ï¼ˆåˆ†é’Ÿï¼‰
  },
  
  status: String,                  // å·¥å•çŠ¶æ€ï¼ˆå¾…å‘å¸ƒ/å·²å‘å¸ƒ/å·²æ¥æ”¶/è¿›è¡Œä¸­/æš‚åœ/å·²å®Œæˆ/å·²å…³é—­/å·²å–æ¶ˆï¼‰
  priority: String,                // ä¼˜å…ˆçº§ï¼ˆä½/æ­£å¸¸/é«˜/ç´§æ€¥ï¼‰
  
  assigned_operators: [{           // åˆ†é…çš„æ“ä½œå·¥
    operator: ObjectId,
    assigned_at: Date,
    role: String
  }],
  
  execution_logs: [{               // å·¥åºæ‰§è¡Œè®°å½•
    action: String,                // æ“ä½œç±»å‹ï¼ˆå¼€å§‹/æš‚åœ/æ¢å¤/å®Œæˆ/æŠ¥å‘Šè¿›åº¦/è´¨æ£€/å…¶ä»–ï¼‰
    operator: ObjectId,
    timestamp: Date,
    completed_quantity: Number,
    good_quantity: Number,
    reject_quantity: Number,
    notes: String
  }],
  
  quality_checks: [{               // è´¨é‡æ£€æŸ¥è®°å½•
    check_point: String,
    check_result: String,          // åˆæ ¼/ä¸åˆæ ¼/å¾…æ£€
    checked_by: ObjectId,
    checked_at: Date,
    remarks: String
  }],
  
  issues: [{                       // å¼‚å¸¸è®°å½•
    issue_type: String,            // å¼‚å¸¸ç±»å‹
    description: String,
    reported_by: ObjectId,
    reported_at: Date,
    resolved: Boolean,
    resolved_at: Date,
    resolution: String
  }],
  
  material_consumption: [{         // ç‰©æ–™æ¶ˆè€—
    material_code: String,
    material_name: String,
    planned_quantity: Number,
    actual_quantity: Number,
    unit: String
  }],
  
  tool_usage: [{                   // å·¥å…·ä½¿ç”¨
    tool_code: String,
    tool_name: String,
    usage_time: Number,
    condition: String
  }]
}
```

**è‡ªåŠ¨ç¼–å·**: å·¥å•ç¼–å·æ ¼å¼ `WO-YYYYMMDD-XXXX`

**è™šæ‹Ÿå­—æ®µ**:
- `completion_rate`: å®Œæˆç‡
- `pass_rate`: åˆæ ¼ç‡
- `is_delayed`: æ˜¯å¦å»¶æœŸ
- `remaining_quantity`: å‰©ä½™æ•°é‡

**å®ä¾‹æ–¹æ³•**:
- `startWorkOrder(operatorId)`: å¼€å§‹å·¥å•
- `pauseWorkOrder(operatorId, reason)`: æš‚åœå·¥å•
- `resumeWorkOrder(operatorId)`: æ¢å¤å·¥å•
- `reportProgress(operatorId, data)`: æŠ¥å‘Šè¿›åº¦
- `completeWorkOrder(operatorId)`: å®Œæˆå·¥å•
- `reportIssue(operatorId, issueData)`: æŠ¥å‘Šå¼‚å¸¸

**é™æ€æ–¹æ³•**:
- `findByWorkCenter(workCenterId, status)`: æŒ‰å·¥ä½œä¸­å¿ƒæŸ¥è¯¢
- `findByOperator(operatorId, status)`: æŒ‰æ“ä½œå·¥æŸ¥è¯¢
- `getStatistics(filters)`: è·å–ç»Ÿè®¡ä¿¡æ¯

##### D. ç”Ÿäº§è®¢å•æ¨¡å‹æ‰©å±• (ProductionOrder.js)

**æ–°å¢å­—æ®µ**:
```javascript
{
  productionItems: [{
    // ... åŸæœ‰å­—æ®µ
    product_id: ObjectId,          // äº§å“IDï¼ˆç”¨äºæŸ¥æ‰¾å·¥è‰ºè·¯çº¿ï¼‰
    routing: ObjectId              // å·¥è‰ºè·¯çº¿
  }],
  
  work_orders: [ObjectId],         // å…³è”çš„å·¥å•åˆ—è¡¨
  work_orders_generated: Boolean   // å·¥å•ç”ŸæˆçŠ¶æ€
}
```

#### 2. æ ¸å¿ƒæœåŠ¡ (mesService.js)

**æ–‡ä»¶è·¯å¾„**: `backend/services/mesService.js`

**æ ¸å¿ƒå‡½æ•°**:

##### createWorkOrdersFromProductionOrder()

ä»ç”Ÿäº§è®¢å•è‡ªåŠ¨åˆ›å»ºå·¥å•çš„æ ¸å¿ƒå‡½æ•°

**å·¥ä½œæµç¨‹**:
```
1. éå†ç”Ÿäº§è®¢å•çš„æ¯ä¸ªäº§å“é¡¹
2. è·å–äº§å“çš„å·¥è‰ºè·¯çº¿
3. æŒ‰å·¥åºé¡ºåºç”Ÿæˆå·¥å•
4. ä¸ºæ¯ä¸ªå·¥åºåˆ›å»ºä¸€ä¸ªå·¥å•
   - è®¾ç½®è®¡åˆ’æ—¶é—´
   - é€‰æ‹©å·¥ä½œä¸­å¿ƒ
   - åˆ†é…æ“ä½œå·¥ï¼ˆå¯é€‰ï¼‰
   - æ·»åŠ ç‰©æ–™æ¶ˆè€—
   - æ·»åŠ å·¥å…·ä½¿ç”¨
   - æ·»åŠ è´¨é‡æ£€æŸ¥ç‚¹
   - æ·»åŠ å·¥è‰ºæŒ‡å¯¼
5. è®¡ç®—å·¥åºé—´çš„ç¼“å†²æ—¶é—´
6. å…³è”å·¥å•åˆ°ç”Ÿäº§è®¢å•
7. æ›´æ–°ç”Ÿäº§è®¢å•çŠ¶æ€
```

**å‚æ•°**:
- `productionOrder`: ç”Ÿäº§è®¢å•å¯¹è±¡
- `options`: é…ç½®é€‰é¡¹
  - `auto_assign`: æ˜¯å¦è‡ªåŠ¨åˆ†é…æ“ä½œå·¥
  - `schedule_buffer`: å·¥åºé—´ç¼“å†²æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰

**è¿”å›**: ç”Ÿæˆçš„å·¥å•åˆ—è¡¨

##### updateProductionOrderProgress()

æ ¹æ®å·¥å•æ›´æ–°ç”Ÿäº§è®¢å•è¿›åº¦

**å·¥ä½œæµç¨‹**:
```
1. è·å–ç”Ÿäº§è®¢å•åŠå…¶æ‰€æœ‰å·¥å•
2. ç»Ÿè®¡å·¥å•çŠ¶æ€
3. æ›´æ–°ç”Ÿäº§è®¢å•çŠ¶æ€
4. æ›´æ–°äº§å“é¡¹çš„ç”Ÿäº§æ•°é‡
5. é‡æ–°è®¡ç®—è¿›åº¦å’Œåˆæ ¼ç‡
```

##### rescheduleWorkOrders()

æ™ºèƒ½è°ƒåº¦ï¼šæ ¹æ®å·¥ä½œä¸­å¿ƒè´Ÿè½½é‡æ–°åˆ†é…å·¥å•

**å·¥ä½œæµç¨‹**:
```
1. è·å–æ—¶é—´èŒƒå›´å†…çš„å¾…è°ƒåº¦å·¥å•
2. è·å–æ‰€æœ‰å¯ç”¨å·¥ä½œä¸­å¿ƒ
3. æŒ‰ä¼˜å…ˆçº§å’Œè®¡åˆ’æ—¶é—´æ’åº
4. ä¸ºæ¯ä¸ªå·¥å•é€‰æ‹©è´Ÿè½½æœ€ä½çš„å·¥ä½œä¸­å¿ƒ
5. æ›´æ–°å·¥å•åˆ†é…
```

##### generateCapacityReport()

ç”Ÿæˆå·¥ä½œä¸­å¿ƒäº§èƒ½æŠ¥å‘Š

**è¿”å›æ•°æ®**:
```javascript
{
  work_center: {
    id, code, name, type
  },
  statistics: {
    total_work_orders,           // æ€»å·¥å•æ•°
    completed_work_orders,       // å·²å®Œæˆå·¥å•æ•°
    completion_rate,             // å®Œæˆç‡
    total_planned_time,          // æ€»è®¡åˆ’å·¥æ—¶
    total_actual_time,           // æ€»å®é™…å·¥æ—¶
    total_capacity,              // æ€»äº§èƒ½
    capacity_utilization,        // äº§èƒ½åˆ©ç”¨ç‡
    efficiency                   // æ•ˆç‡ï¼ˆè®¡åˆ’å·¥æ—¶/å®é™…å·¥æ—¶ï¼‰
  }
}
```

#### 3. æ§åˆ¶å™¨ (mesController.js)

**æ–‡ä»¶è·¯å¾„**: `backend/controllers/mesController.js`

**APIç«¯ç‚¹**: å…±28ä¸ª

**å·¥ä½œä¸­å¿ƒç®¡ç†** (6ä¸ª):
- `GET /api/mes/work-centers` - è·å–å·¥ä½œä¸­å¿ƒåˆ—è¡¨
- `GET /api/mes/work-centers/:id` - è·å–å·¥ä½œä¸­å¿ƒè¯¦æƒ…
- `POST /api/mes/work-centers` - åˆ›å»ºå·¥ä½œä¸­å¿ƒ
- `PUT /api/mes/work-centers/:id` - æ›´æ–°å·¥ä½œä¸­å¿ƒ
- `DELETE /api/mes/work-centers/:id` - åˆ é™¤å·¥ä½œä¸­å¿ƒ
- `GET /api/mes/work-centers/stats/summary` - è·å–ç»Ÿè®¡ä¿¡æ¯

**å·¥è‰ºè·¯çº¿ç®¡ç†** (6ä¸ª):
- `GET /api/mes/routings` - è·å–å·¥è‰ºè·¯çº¿åˆ—è¡¨
- `GET /api/mes/routings/:id` - è·å–å·¥è‰ºè·¯çº¿è¯¦æƒ…
- `POST /api/mes/routings` - åˆ›å»ºå·¥è‰ºè·¯çº¿
- `PUT /api/mes/routings/:id` - æ›´æ–°å·¥è‰ºè·¯çº¿
- `POST /api/mes/routings/:id/release` - å‘å¸ƒå·¥è‰ºè·¯çº¿
- `GET /api/mes/routings/by-product/:productId` - æŒ‰äº§å“æŸ¥è¯¢

**å·¥å•ç®¡ç†** (14ä¸ª):
- `GET /api/mes/work-orders` - è·å–å·¥å•åˆ—è¡¨
- `GET /api/mes/work-orders/:id` - è·å–å·¥å•è¯¦æƒ…
- `POST /api/mes/work-orders/generate/:productionOrderId` - ç”Ÿæˆå·¥å•
- `GET /api/mes/work-orders/my-work-orders` - è·å–æˆ‘çš„å·¥å•
- `GET /api/mes/work-orders/stats/summary` - è·å–ç»Ÿè®¡ä¿¡æ¯
- `POST /api/mes/work-orders/:id/start` - å¼€å§‹å·¥å•
- `POST /api/mes/work-orders/:id/progress` - æŠ¥å‘Šè¿›åº¦
- `POST /api/mes/work-orders/:id/complete` - å®Œæˆå·¥å•
- `POST /api/mes/work-orders/:id/pause` - æš‚åœå·¥å•
- `POST /api/mes/work-orders/:id/resume` - æ¢å¤å·¥å•
- `POST /api/mes/work-orders/:id/issue` - æŠ¥å‘Šå¼‚å¸¸

**æŠ¥è¡¨å’Œè°ƒåº¦** (2ä¸ª):
- `GET /api/mes/reports/capacity` - ç”Ÿæˆäº§èƒ½æŠ¥å‘Š
- `POST /api/mes/work-orders/reschedule` - é‡æ–°è°ƒåº¦å·¥å•

#### 4. è·¯ç”±é…ç½® (mesRoutes.js)

**æ–‡ä»¶è·¯å¾„**: `backend/routes/mesRoutes.js`

å®Œæ•´çš„è·¯ç”±é…ç½®ï¼ŒåŒ…æ‹¬æƒé™æ§åˆ¶

---

### äºŒã€å‰ç«¯å¼€å‘

#### 1. APIæœåŠ¡é…ç½® (api.js)

**æ–°å¢APIæ¨¡å—**:

```javascript
// å·¥å•API
export const workOrdersAPI = {
  getAll(params),                  // è·å–å·¥å•åˆ—è¡¨
  getById(id),                     // è·å–å·¥å•è¯¦æƒ…
  generate(productionOrderId),     // ä»ç”Ÿäº§è®¢å•ç”Ÿæˆå·¥å•
  getMyWorkOrders(params),         // è·å–æˆ‘çš„å·¥å•
  getStats(params),                // è·å–ç»Ÿè®¡ä¿¡æ¯
  
  // å·¥å•æ“ä½œ
  start(id),                       // å¼€å§‹å·¥å•
  reportProgress(id, data),        // æŠ¥å‘Šè¿›åº¦
  complete(id),                    // å®Œæˆå·¥å•
  pause(id, reason),               // æš‚åœå·¥å•
  resume(id),                      // æ¢å¤å·¥å•
  reportIssue(id, data)            // æŠ¥å‘Šå¼‚å¸¸
}

// å·¥ä½œä¸­å¿ƒAPI
export const workCentersAPI = {
  getAll(params),
  getById(id),
  create(data),
  update(id, data),
  delete(id),
  getStats()
}

// å·¥è‰ºè·¯çº¿API
export const routingsAPI = {
  getAll(params),
  getById(id),
  create(data),
  update(id, data),
  release(id),
  getByProduct(productId)
}

// MESæŠ¥è¡¨API
export const mesReportsAPI = {
  getCapacityReport(startDate, endDate),
  reschedule(startDate, endDate)
}
```

#### 2. è½¦é—´ç»ˆç«¯é¡µé¢ (ShopFloorTerminal.jsx)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/pages/ShopFloorTerminal.jsx`

**é¡µé¢ç‰¹ç‚¹**:
- âœ… **ä¸“ä¸ºå¹³æ¿è®¾è®¡**: å¤§æŒ‰é’®ã€æ¸…æ™°çš„å¡ç‰‡å¸ƒå±€
- âœ… **å®æ—¶åˆ·æ–°**: æ¯30ç§’è‡ªåŠ¨åˆ·æ–°å·¥å•çŠ¶æ€
- âœ… **åŒè§†å›¾**: å¡ç‰‡è§†å›¾å’Œåˆ—è¡¨è§†å›¾
- âœ… **å¿«é€Ÿæ“ä½œ**: ä¸€é”®å¼€å§‹ã€æš‚åœã€æ¢å¤ã€å®Œæˆå·¥å•
- âœ… **è¿›åº¦æŠ¥å‘Š**: å¿«é€ŸæŠ¥å‘Šå®Œæˆæ•°é‡å’Œè´¨é‡æ•°æ®
- âœ… **å¼‚å¸¸æŠ¥å‘Š**: å¿«é€ŸæŠ¥å‘Šè®¾å¤‡æ•…éšœã€ç‰©æ–™çŸ­ç¼ºç­‰å¼‚å¸¸
- âœ… **ç»Ÿè®¡çœ‹æ¿**: å®æ—¶æ˜¾ç¤ºè¿›è¡Œä¸­ã€å¾…å¼€å§‹ã€å·²å®Œæˆã€å¼‚å¸¸å·¥å•æ•°é‡

**æ ¸å¿ƒåŠŸèƒ½**:

1. **ç»Ÿè®¡çœ‹æ¿**
   - è¿›è¡Œä¸­çš„å·¥å•æ•°
   - å¾…å¼€å§‹å·¥å•æ•°
   - ä»Šæ—¥å·²å®Œæˆå·¥å•æ•°
   - å¼‚å¸¸å·¥å•æ•°

2. **å·¥å•å¡ç‰‡è§†å›¾**
   - ä¼˜å…ˆçº§æ ‡ç­¾
   - çŠ¶æ€æ ‡ç­¾
   - å»¶æœŸè­¦å‘Š
   - äº§å“ä¿¡æ¯
   - å·¥åºä¿¡æ¯
   - å·¥ä½œä¸­å¿ƒä¿¡æ¯
   - è®¡åˆ’æ—¶é—´
   - å®Œæˆè¿›åº¦ï¼ˆè¿›åº¦æ¡ï¼‰
   - åˆæ ¼/ä¸åˆæ ¼æ•°é‡ç»Ÿè®¡
   - å·¥è‰ºæŒ‡å¯¼ï¼ˆå±•å¼€æ˜¾ç¤ºï¼‰
   - å¼‚å¸¸è®°å½•ï¼ˆå±•å¼€æ˜¾ç¤ºï¼‰
   - å¿«é€Ÿæ“ä½œæŒ‰é’®

3. **å·¥å•åˆ—è¡¨è§†å›¾**
   - è¡¨æ ¼å½¢å¼æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯
   - æ”¯æŒæ’åºå’Œç­›é€‰
   - å¿«é€Ÿæ“ä½œ

4. **æŠ¥å‘Šè¿›åº¦Modal**
   - å®Œæˆæ•°é‡
   - åˆæ ¼æ•°é‡
   - ä¸åˆæ ¼æ•°é‡
   - å¤‡æ³¨

5. **æŠ¥å‘Šå¼‚å¸¸Modal**
   - å¼‚å¸¸ç±»å‹é€‰æ‹©
   - å¼‚å¸¸æè¿°

**ç•Œé¢æˆªå›¾ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ è½¦é—´ç»ˆç«¯                              [åˆ·æ–°]          â”‚
â”‚ æ“ä½œå·¥: å¼ ä¸‰ | æœ€åæ›´æ–°: 2025-10-28 10:30:00             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ â”‚è¿›è¡Œä¸­â”‚ â”‚å¾…å¼€å§‹â”‚ â”‚å·²å®Œæˆâ”‚ â”‚å¼‚å¸¸  â”‚                    â”‚
â”‚ â”‚  3   â”‚ â”‚  5   â”‚ â”‚  12  â”‚ â”‚  1   â”‚                    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æˆ‘çš„ä»»åŠ¡] [åˆ—è¡¨è§†å›¾]                                    â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ç´§æ€¥] [è¿›è¡Œä¸­] [å»¶æœŸ]  WO-20251028-0001            â”‚ â”‚
â”‚ â”‚ äº§å“: AT-10 DA                                      â”‚ â”‚
â”‚ â”‚ å·¥åº: è£…é…  åºå·: 3                                 â”‚ â”‚
â”‚ â”‚ å·¥ä½œä¸­å¿ƒ: è£…é…è½¦é—´-1                                â”‚ â”‚
â”‚ â”‚ è®¡åˆ’æ—¶é—´: 2025-10-28 08:00 ~ 12:00                 â”‚ â”‚
â”‚ â”‚                                                      â”‚ â”‚
â”‚ â”‚ å®Œæˆè¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 75%                           â”‚ â”‚
â”‚ â”‚ å®é™…: 15 / 20                                       â”‚ â”‚
â”‚ â”‚                                                      â”‚ â”‚
â”‚ â”‚ åˆæ ¼: 14    ä¸åˆæ ¼: 1                               â”‚ â”‚
â”‚ â”‚                                                      â”‚ â”‚
â”‚ â”‚ [æŠ¥å‘Šè¿›åº¦] [æš‚åœ] [å®Œæˆ] [æŠ¥å‘Šå¼‚å¸¸]                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ“ä½œæµç¨‹**:
```
å·¥äººç™»å½•è½¦é—´ç»ˆç«¯
  â†“
æŸ¥çœ‹åˆ†é…ç»™è‡ªå·±çš„å·¥å•
  â†“
é€‰æ‹©ä¸€ä¸ªå·¥å•
  â†“
ç‚¹å‡»"å¼€å§‹"æŒ‰é’®
  â†“
å·¥å•çŠ¶æ€å˜ä¸º"è¿›è¡Œä¸­"
  â†“
å®Œæˆä¸€éƒ¨åˆ†å·¥ä½œå
  â†“
ç‚¹å‡»"æŠ¥å‘Šè¿›åº¦"
  â†“
å¡«å†™å®Œæˆæ•°é‡ã€åˆæ ¼æ•°é‡ç­‰
  â†“
æäº¤è¿›åº¦
  â†“
ç»§ç»­å·¥ä½œ...
  â†“
å…¨éƒ¨å®Œæˆå
  â†“
ç‚¹å‡»"å®Œæˆ"æŒ‰é’®
  â†“
å·¥å•çŠ¶æ€å˜ä¸º"å·²å®Œæˆ"
  â†“
ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ç”Ÿäº§è®¢å•è¿›åº¦
```

**å¼‚å¸¸å¤„ç†æµç¨‹**:
```
å‘ç°é—®é¢˜ï¼ˆè®¾å¤‡æ•…éšœ/ç‰©æ–™çŸ­ç¼ºç­‰ï¼‰
  â†“
ç‚¹å‡»"æŠ¥å‘Šå¼‚å¸¸"
  â†“
é€‰æ‹©å¼‚å¸¸ç±»å‹
  â†“
æè¿°å¼‚å¸¸æƒ…å†µ
  â†“
æäº¤å¼‚å¸¸æŠ¥å‘Š
  â†“
å¼‚å¸¸è®°å½•æ˜¾ç¤ºåœ¨å·¥å•å¡ç‰‡ä¸Š
  â†“
ç­‰å¾…ä¸»ç®¡å¤„ç†
```

#### 3. è·¯ç”±é…ç½® (App.jsx)

**æ–°å¢è·¯ç”±**:
- `/shop-floor` â†’ ShopFloorTerminal

---

## ğŸ“Š æ•°æ®æµå›¾

```
é”€å”®è®¢å• (SalesOrder)
    â†“
ç”Ÿäº§è®¢å• (ProductionOrder)
    â†“
äº§å“ â†’ å·¥è‰ºè·¯çº¿ (Routing)
    â†“ [è‡ªåŠ¨ç”Ÿæˆ]
å·¥å•åˆ—è¡¨ (WorkOrder[])
    â†“
å·¥åº1å·¥å• â†’ å·¥ä½œä¸­å¿ƒA
å·¥åº2å·¥å• â†’ å·¥ä½œä¸­å¿ƒB
å·¥åº3å·¥å• â†’ å·¥ä½œä¸­å¿ƒC
    â†“
æ“ä½œå·¥æ‰§è¡Œ
    â†“ [æŠ¥å‘Šè¿›åº¦]
å·¥å•æ›´æ–°
    â†“ [è‡ªåŠ¨åŒæ­¥]
ç”Ÿäº§è®¢å•è¿›åº¦æ›´æ–°
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### 1. å·¥å•ç”Ÿæˆæµç¨‹

```
ç”Ÿäº§è®¡åˆ’å‘˜åˆ›å»ºç”Ÿäº§è®¢å•
    â†“
ä¸ºäº§å“é¡¹é€‰æ‹©å·¥è‰ºè·¯çº¿
    â†“
è°ƒç”¨å·¥å•ç”ŸæˆAPI
POST /api/mes/work-orders/generate/:productionOrderId
    â†“
ç³»ç»Ÿè¯»å–å·¥è‰ºè·¯çº¿
    â†“
éå†æ¯ä¸ªå·¥åº
    â†“
ä¸ºæ¯ä¸ªå·¥åºåˆ›å»ºä¸€ä¸ªå·¥å•
    - è®¾ç½®è®¡åˆ’æ—¶é—´ï¼ˆè€ƒè™‘å‰ç½®å·¥åºï¼‰
    - é€‰æ‹©å·¥ä½œä¸­å¿ƒ
    - åˆ†é…æ“ä½œå·¥ï¼ˆå¯é€‰ï¼‰
    - å¤åˆ¶ç‰©æ–™ã€å·¥å…·ã€è´¨æ£€è¦æ±‚
    - æ·»åŠ å·¥è‰ºæŒ‡å¯¼
    â†“
ç”Ÿæˆå®Œæ•´çš„å·¥å•åˆ—è¡¨
    â†“
å…³è”åˆ°ç”Ÿäº§è®¢å•
    â†“
å·¥å•çŠ¶æ€ï¼šå¾…å‘å¸ƒ
```

### 2. å·¥å•æ‰§è¡Œæµç¨‹

```
æ“ä½œå·¥ç™»å½•è½¦é—´ç»ˆç«¯
    â†“
æŸ¥çœ‹åˆ†é…ç»™è‡ªå·±çš„å·¥å•
GET /api/mes/work-orders/my-work-orders
    â†“
é€‰æ‹©ä¸€ä¸ªå·¥å•
    â†“
ç‚¹å‡»"å¼€å§‹"
POST /api/mes/work-orders/:id/start
    â†“
å·¥å•çŠ¶æ€ï¼šè¿›è¡Œä¸­
    â†“
æ‰§è¡Œå·¥åº...
    â†“
å®Œæˆéƒ¨åˆ†å·¥ä½œå
    â†“
ç‚¹å‡»"æŠ¥å‘Šè¿›åº¦"
POST /api/mes/work-orders/:id/progress
{
  completed_quantity: 10,
  good_quantity: 9,
  reject_quantity: 1
}
    â†“
ç³»ç»Ÿæ›´æ–°å·¥å•å®é™…æ•°é‡
    â†“
å¦‚æœå®Œæˆå…¨éƒ¨æ•°é‡
    â†“
å·¥å•çŠ¶æ€ï¼šå·²å®Œæˆ
    â†“
ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ç”Ÿäº§è®¢å•è¿›åº¦
updateProductionOrderProgress()
    â†“
å¦‚æœæœ‰è´¨é‡é—®é¢˜æˆ–å…¶ä»–å¼‚å¸¸
    â†“
ç‚¹å‡»"æŠ¥å‘Šå¼‚å¸¸"
POST /api/mes/work-orders/:id/issue
    â†“
ä¸»ç®¡æ”¶åˆ°é€šçŸ¥å¹¶å¤„ç†
```

### 3. å¼‚å¸¸å¤„ç†æµç¨‹

```
æ“ä½œå·¥å‘ç°å¼‚å¸¸
    â†“
ç‚¹å‡»"æŠ¥å‘Šå¼‚å¸¸"
    â†“
é€‰æ‹©å¼‚å¸¸ç±»å‹
- è´¨é‡é—®é¢˜
- è®¾å¤‡æ•…éšœ
- ç‰©æ–™çŸ­ç¼º
- å·¥å…·ç¼ºå¤±
- å…¶ä»–
    â†“
æè¿°å¼‚å¸¸æƒ…å†µ
    â†“
æäº¤å¼‚å¸¸æŠ¥å‘Š
POST /api/mes/work-orders/:id/issue
    â†“
å¼‚å¸¸è®°å½•æ·»åŠ åˆ°å·¥å•
    â†“
å¼‚å¸¸æ˜¾ç¤ºåœ¨å·¥å•å¡ç‰‡ä¸Š
    â†“
ä¸»ç®¡æ¥æ”¶å¼‚å¸¸é€šçŸ¥
    â†“
ä¸»ç®¡å¤„ç†å¼‚å¸¸
    â†“
è§£å†³é—®é¢˜å
    â†“
æ ‡è®°å¼‚å¸¸ä¸ºå·²è§£å†³
    â†“
æ“ä½œå·¥ç»§ç»­å·¥ä½œ
```

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### åç«¯æ–‡ä»¶

#### æ–°å¢çš„æ–‡ä»¶ (8ä¸ª)
```
backend/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ WorkCenter.js                     # å·¥ä½œä¸­å¿ƒæ¨¡å‹
â”‚   â”œâ”€â”€ Routing.js                        # å·¥è‰ºè·¯çº¿æ¨¡å‹
â”‚   â””â”€â”€ WorkOrder.js                      # å·¥å•æ¨¡å‹
â”œâ”€â”€ services/
â”‚   â””â”€â”€ mesService.js                     # MESæ ¸å¿ƒæœåŠ¡
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ mesController.js                  # MESæ§åˆ¶å™¨
â””â”€â”€ routes/
    â””â”€â”€ mesRoutes.js                      # MESè·¯ç”±
```

#### ä¿®æ”¹çš„æ–‡ä»¶ (2ä¸ª)
```
backend/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ ProductionOrder.js                # æ·»åŠ å·¥å•æ”¯æŒ
â””â”€â”€ server.js                             # æ³¨å†ŒMESè·¯ç”±
```

### å‰ç«¯æ–‡ä»¶

#### æ–°å¢çš„æ–‡ä»¶ (1ä¸ª)
```
frontend/src/pages/
â””â”€â”€ ShopFloorTerminal.jsx                 # è½¦é—´ç»ˆç«¯é¡µé¢
```

#### ä¿®æ”¹çš„æ–‡ä»¶ (2ä¸ª)
```
frontend/src/
â”œâ”€â”€ services/
â”‚   â””â”€â”€ api.js                            # æ·»åŠ MES API
â””â”€â”€ App.jsx                               # æ·»åŠ è½¦é—´ç»ˆç«¯è·¯ç”±
```

### æ–‡æ¡£æ–‡ä»¶ (1ä¸ª)
```
MESç³»ç»Ÿå¼€å‘å®ŒæˆæŠ¥å‘Š.md                     # æœ¬æŠ¥å‘Š
```

**æ€»è®¡**: 14ä¸ªæ–‡ä»¶

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•

#### 1. å·¥ä½œä¸­å¿ƒç®¡ç†

```javascript
æµ‹è¯•ç”¨ä¾‹ 1: åˆ›å»ºå·¥ä½œä¸­å¿ƒ
âœ“ å¡«å†™å®Œæ•´ä¿¡æ¯
âœ“ è®¾ç½®äº§èƒ½å‚æ•°
âœ“ åˆ†é…æ“ä½œå·¥
âœ“ åˆ›å»ºæˆåŠŸ

æµ‹è¯•ç”¨ä¾‹ 2: å·¥ä½œä¸­å¿ƒç»Ÿè®¡
âœ“ æŸ¥çœ‹æ€»æ•°å’Œåˆ†ç±»
âœ“ æŸ¥çœ‹äº§èƒ½åˆ©ç”¨ç‡
âœ“ æŸ¥çœ‹å¹³å‡åˆ©ç”¨ç‡
```

#### 2. å·¥è‰ºè·¯çº¿ç®¡ç†

```javascript
æµ‹è¯•ç”¨ä¾‹ 1: åˆ›å»ºå·¥è‰ºè·¯çº¿
âœ“ é€‰æ‹©äº§å“
âœ“ æ·»åŠ å·¥åº
âœ“ è®¾ç½®å·¥åºé¡ºåº
âœ“ æŒ‡å®šå·¥ä½œä¸­å¿ƒ
âœ“ è®¾ç½®æ—¶é—´å‚æ•°
âœ“ æ·»åŠ ç‰©æ–™å’Œå·¥å…·
âœ“ ä¿å­˜æˆåŠŸ

æµ‹è¯•ç”¨ä¾‹ 2: å·¥åºéªŒè¯
âœ“ å·¥åºåºå·è¿ç»­æ€§
âœ“ å‰ç½®å·¥åºæœ‰æ•ˆæ€§
âœ“ å·¥æ—¶è‡ªåŠ¨è®¡ç®—

æµ‹è¯•ç”¨ä¾‹ 3: å‘å¸ƒå·¥è‰ºè·¯çº¿
âœ“ è‰ç¨¿çŠ¶æ€å¯å‘å¸ƒ
âœ“ å‘å¸ƒåä¸å¯ç¼–è¾‘
âœ“ çŠ¶æ€æ­£ç¡®å˜æ›´
```

#### 3. å·¥å•ç”Ÿæˆ

```javascript
æµ‹è¯•ç”¨ä¾‹ 1: ä»ç”Ÿäº§è®¢å•ç”Ÿæˆå·¥å•
âœ“ é€‰æ‹©æœ‰å·¥è‰ºè·¯çº¿çš„äº§å“
âœ“ è°ƒç”¨ç”ŸæˆAPI
âœ“ å·¥å•æ•°é‡æ­£ç¡®ï¼ˆ= å·¥åºæ•° Ã— äº§å“é¡¹æ•°ï¼‰
âœ“ å·¥å•ä¿¡æ¯å®Œæ•´
âœ“ æ—¶é—´å®‰æ’åˆç†

æµ‹è¯•ç”¨ä¾‹ 2: å·¥å•å…³è”
âœ“ å·¥å•å…³è”åˆ°ç”Ÿäº§è®¢å•
âœ“ å·¥å•å…³è”åˆ°é”€å”®è®¢å•
âœ“ å·¥å•å…³è”åˆ°å·¥ä½œä¸­å¿ƒ
```

#### 4. è½¦é—´ç»ˆç«¯æ“ä½œ

```javascript
æµ‹è¯•ç”¨ä¾‹ 1: å¼€å§‹å·¥å•
âœ“ åªèƒ½å¼€å§‹"å·²å‘å¸ƒ"çŠ¶æ€çš„å·¥å•
âœ“ å¼€å§‹åçŠ¶æ€å˜ä¸º"è¿›è¡Œä¸­"
âœ“ è®°å½•å®é™…å¼€å§‹æ—¶é—´
âœ“ æ·»åŠ æ‰§è¡Œæ—¥å¿—

æµ‹è¯•ç”¨ä¾‹ 2: æŠ¥å‘Šè¿›åº¦
âœ“ åªèƒ½åœ¨"è¿›è¡Œä¸­"çŠ¶æ€æŠ¥å‘Š
âœ“ å®Œæˆæ•°é‡æ­£ç¡®æ›´æ–°
âœ“ åˆæ ¼/ä¸åˆæ ¼æ•°é‡ç»Ÿè®¡
âœ“ è‡ªåŠ¨è®¡ç®—å®Œæˆç‡
âœ“ è¾¾åˆ°100%è‡ªåŠ¨å®Œæˆ

æµ‹è¯•ç”¨ä¾‹ 3: æš‚åœå’Œæ¢å¤
âœ“ æš‚åœéœ€è¦å¡«å†™åŸå› 
âœ“ çŠ¶æ€æ­£ç¡®å˜æ›´
âœ“ å¯ä»¥æ¢å¤æš‚åœçš„å·¥å•

æµ‹è¯•ç”¨ä¾‹ 4: å®Œæˆå·¥å•
âœ“ åªèƒ½å®Œæˆ"è¿›è¡Œä¸­"çš„å·¥å•
âœ“ è®°å½•å®é™…å®Œæˆæ—¶é—´
âœ“ è®¡ç®—å®é™…å·¥æ—¶
âœ“ è‡ªåŠ¨æ›´æ–°ç”Ÿäº§è®¢å•è¿›åº¦

æµ‹è¯•ç”¨ä¾‹ 5: æŠ¥å‘Šå¼‚å¸¸
âœ“ é€‰æ‹©å¼‚å¸¸ç±»å‹
âœ“ å¡«å†™å¼‚å¸¸æè¿°
âœ“ å¼‚å¸¸è®°å½•ä¿å­˜
âœ“ å¼‚å¸¸æ˜¾ç¤ºåœ¨å¡ç‰‡ä¸Š
```

#### 5. è¿›åº¦åŒæ­¥

```javascript
æµ‹è¯•ç”¨ä¾‹ 1: å·¥å•è¿›åº¦åŒæ­¥åˆ°ç”Ÿäº§è®¢å•
âœ“ å·¥å•å®Œæˆå
âœ“ ç”Ÿäº§è®¢å•è¿›åº¦è‡ªåŠ¨æ›´æ–°
âœ“ äº§å“é¡¹æ•°é‡æ›´æ–°
âœ“ åˆæ ¼ç‡è®¡ç®—æ­£ç¡®
```

### APIæµ‹è¯•

```bash
# åˆ›å»ºå·¥ä½œä¸­å¿ƒ
POST /api/mes/work-centers
{
  "code": "WC001",
  "name": "è£…é…è½¦é—´-1",
  "type": "è£…é…",
  "capacity": {
    "standard_capacity": 10,
    "shifts_per_day": 2,
    "hours_per_shift": 8
  }
}

# åˆ›å»ºå·¥è‰ºè·¯çº¿
POST /api/mes/routings
{
  "code": "RT-AT10DA-001",
  "name": "AT-10 DA å·¥è‰ºè·¯çº¿",
  "product": {
    "product_id": "...",
    "model_base": "AT-10-DA",
    "version": "1.0"
  },
  "operations": [
    {
      "sequence": 1,
      "operation_code": "OP010",
      "operation_name": "è£…é…",
      "work_center": "...",
      "timing": {
        "setup_time": 30,
        "unit_time": 15
      }
    }
  ]
}

# ç”Ÿæˆå·¥å•
POST /api/mes/work-orders/generate/:productionOrderId

# å¼€å§‹å·¥å•
POST /api/mes/work-orders/:id/start

# æŠ¥å‘Šè¿›åº¦
POST /api/mes/work-orders/:id/progress
{
  "completed_quantity": 10,
  "good_quantity": 9,
  "reject_quantity": 1
}

# å®Œæˆå·¥å•
POST /api/mes/work-orders/:id/complete
```

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æ–°ç”Ÿäº§è®¢å•çš„å·¥å•ç”Ÿæˆ

**èƒŒæ™¯**: é”€å”®éƒ¨é—¨æ¥åˆ°ä¸€ä¸ªè®¢å•ï¼Œéœ€è¦ç”Ÿäº§20å°AT-10 DAæ‰§è¡Œå™¨

**æ“ä½œæ­¥éª¤**:
```
1. ç”Ÿäº§è®¡åˆ’å‘˜ç™»å½•ç³»ç»Ÿ
2. åˆ›å»ºç”Ÿäº§è®¢å•
   - å…³è”é”€å”®è®¢å•
   - æ·»åŠ äº§å“é¡¹: AT-10 DA Ã— 20
   - é€‰æ‹©å·¥è‰ºè·¯çº¿: RT-AT10DA-001
3. ç‚¹å‡»"ç”Ÿæˆå·¥å•"
4. ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆå·¥å•
   - å·¥åº1: æœºåŠ å·¥ (WO-20251028-0001)
   - å·¥åº2: è£…é… (WO-20251028-0002)
   - å·¥åº3: æµ‹è¯• (WO-20251028-0003)
   - å·¥åº4: åŒ…è£… (WO-20251028-0004)
5. å·¥å•è‡ªåŠ¨åˆ†é…åˆ°å¯¹åº”å·¥ä½œä¸­å¿ƒ
6. ç”Ÿäº§è®¢å•çŠ¶æ€: Scheduled
```

### åœºæ™¯2: æ“ä½œå·¥æ‰§è¡Œå·¥å•

**èƒŒæ™¯**: æ“ä½œå·¥å¼ ä¸‰è´Ÿè´£è£…é…å·¥åº

**æ“ä½œæ­¥éª¤**:
```
1. å¼ ä¸‰åœ¨è½¦é—´ç»ˆç«¯ç™»å½•
2. æŸ¥çœ‹åˆ†é…ç»™è‡ªå·±çš„å·¥å•
3. çœ‹åˆ° WO-20251028-0002ï¼ˆè£…é…å·¥åºï¼‰
4. ç‚¹å‡»å¡ç‰‡å±•å¼€è¯¦æƒ…
5. æŸ¥çœ‹å·¥è‰ºæŒ‡å¯¼
6. ç‚¹å‡»"å¼€å§‹"æŒ‰é’®
7. å·¥å•çŠ¶æ€å˜ä¸º"è¿›è¡Œä¸­"
8. å¼€å§‹è£…é…...
9. å®Œæˆ10å°åï¼Œç‚¹å‡»"æŠ¥å‘Šè¿›åº¦"
   - å®Œæˆæ•°é‡: 10
   - åˆæ ¼æ•°é‡: 10
   - ä¸åˆæ ¼æ•°é‡: 0
10. æäº¤è¿›åº¦
11. ç»§ç»­å·¥ä½œ...
12. å…¨éƒ¨å®Œæˆ20å°å
13. ç‚¹å‡»"å®Œæˆ"æŒ‰é’®
14. å·¥å•çŠ¶æ€å˜ä¸º"å·²å®Œæˆ"
15. ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ç”Ÿäº§è®¢å•è¿›åº¦
```

### åœºæ™¯3: å¼‚å¸¸å¤„ç†

**èƒŒæ™¯**: æµ‹è¯•å·¥åºå‘ç°è®¾å¤‡æ•…éšœ

**æ“ä½œæ­¥éª¤**:
```
1. æ“ä½œå·¥æå››åœ¨æ‰§è¡Œæµ‹è¯•å·¥å•
2. å‘ç°æµ‹è¯•è®¾å¤‡å‡ºç°æ•…éšœ
3. ç‚¹å‡»"æŠ¥å‘Šå¼‚å¸¸"
4. é€‰æ‹©å¼‚å¸¸ç±»å‹: è®¾å¤‡æ•…éšœ
5. æè¿°: "æµ‹è¯•å°æ— æ³•å¯åŠ¨ï¼Œæ˜¾ç¤ºé”™è¯¯ä»£ç E02"
6. æäº¤å¼‚å¸¸æŠ¥å‘Š
7. ç‚¹å‡»"æš‚åœ"å·¥å•
8. å¡«å†™æš‚åœåŸå› : "ç­‰å¾…è®¾å¤‡ç»´ä¿®"
9. ä¸»ç®¡æ”¶åˆ°å¼‚å¸¸é€šçŸ¥
10. è”ç³»è®¾å¤‡ç»´æŠ¤äººå‘˜
11. è®¾å¤‡ä¿®å¤å®Œæˆ
12. ä¸»ç®¡æ ‡è®°å¼‚å¸¸ä¸ºå·²è§£å†³
13. æå››ç‚¹å‡»"æ¢å¤"å·¥å•
14. ç»§ç»­æµ‹è¯•å·¥ä½œ
```

### åœºæ™¯4: äº§èƒ½æŠ¥å‘Š

**èƒŒæ™¯**: ç”Ÿäº§ä¸»ç®¡éœ€è¦æŸ¥çœ‹è½¦é—´äº§èƒ½åˆ©ç”¨æƒ…å†µ

**æ“ä½œæ­¥éª¤**:
```
1. ä¸»ç®¡ç™»å½•ç³»ç»Ÿ
2. è¿›å…¥MESæŠ¥è¡¨é¡µé¢
3. é€‰æ‹©æ—¶é—´èŒƒå›´: 2025-10-21 ~ 2025-10-28
4. ç‚¹å‡»"ç”Ÿæˆäº§èƒ½æŠ¥å‘Š"
5. ç³»ç»Ÿæ˜¾ç¤ºæŠ¥è¡¨
   - è£…é…è½¦é—´-1:
     * å·¥å•æ•°: 45
     * å®Œæˆç‡: 95%
     * äº§èƒ½åˆ©ç”¨ç‡: 82%
     * æ•ˆç‡: 105%
   - æµ‹è¯•è½¦é—´:
     * å·¥å•æ•°: 38
     * å®Œæˆç‡: 92%
     * äº§èƒ½åˆ©ç”¨ç‡: 76%
     * æ•ˆç‡: 98%
6. åˆ†æç“¶é¢ˆå·¥åº
7. è°ƒæ•´èµ„æºåˆ†é…
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å¼€å‘æ³¨æ„äº‹é¡¹

1. **å·¥è‰ºè·¯çº¿è®¾è®¡**
   - å·¥åºåºå·å¿…é¡»è¿ç»­
   - å‰ç½®å·¥åºå¿…é¡»åœ¨å½“å‰å·¥åºä¹‹å‰
   - å·¥æ—¶è®¡ç®—è¦å‡†ç¡®

2. **å·¥å•ç”Ÿæˆ**
   - ç¡®ä¿äº§å“æœ‰å¯ç”¨çš„å·¥è‰ºè·¯çº¿
   - æ£€æŸ¥å·¥ä½œä¸­å¿ƒæ˜¯å¦å¯ç”¨
   - åˆç†è®¾ç½®ç¼“å†²æ—¶é—´

3. **å¹¶å‘æ§åˆ¶**
   - å¤šä¸ªæ“ä½œå·¥å¯èƒ½åŒæ—¶æ“ä½œåŒä¸€å·¥å•
   - ä½¿ç”¨ä¹è§‚é”æˆ–æ‚²è§‚é”
   - è®°å½•æ‰€æœ‰æ“ä½œæ—¥å¿—

4. **æ•°æ®ä¸€è‡´æ€§**
   - å·¥å•çŠ¶æ€å˜æ›´è¦åŒæ­¥åˆ°ç”Ÿäº§è®¢å•
   - æ•°é‡ç»Ÿè®¡è¦å‡†ç¡®
   - è´¨é‡æ•°æ®è¦çœŸå®

### ç”¨æˆ·ä½¿ç”¨æ³¨æ„äº‹é¡¹

1. **å·¥ä½œä¸­å¿ƒé…ç½®**
   - å‡†ç¡®è®¾ç½®äº§èƒ½å‚æ•°
   - åŠæ—¶æ›´æ–°è®¾å¤‡çŠ¶æ€
   - åˆç†åˆ†é…æ“ä½œå·¥

2. **å·¥è‰ºè·¯çº¿ç®¡ç†**
   - ä»”ç»†è§„åˆ’å·¥åºé¡ºåº
   - å‡†ç¡®è®¾ç½®å·¥æ—¶
   - è¯¦ç»†å¡«å†™å·¥è‰ºæŒ‡å¯¼

3. **å·¥å•æ‰§è¡Œ**
   - åŠæ—¶æ›´æ–°è¿›åº¦
   - å¦‚å®æŠ¥å‘Šè´¨é‡æ•°æ®
   - ç«‹å³æŠ¥å‘Šå¼‚å¸¸

4. **å¼‚å¸¸å¤„ç†**
   - è¯¦ç»†æè¿°å¼‚å¸¸æƒ…å†µ
   - åŠæ—¶é€šçŸ¥ä¸»ç®¡
   - ç­‰å¾…è§£å†³åç»§ç»­å·¥ä½œ

---

## ğŸ”® åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)

1. **ç§»åŠ¨ç«¯é€‚é…**
   - å“åº”å¼è®¾è®¡
   - è§¦æ‘¸æ“ä½œä¼˜åŒ–
   - æ¨ªå±/ç«–å±åˆ‡æ¢

2. **æ¡ç æ‰«æ**
   - æ‰«ç å¼€å§‹å·¥å•
   - æ‰«ç æŠ¥å‘Šè¿›åº¦
   - æ‰«ç ç¡®è®¤ç‰©æ–™

3. **å®æ—¶é€šçŸ¥**
   - WebSocketæ¨é€
   - å¼‚å¸¸å³æ—¶é€šçŸ¥
   - å·¥å•åˆ†é…é€šçŸ¥

4. **æ•°æ®å¯è§†åŒ–**
   - å·¥å•ç”˜ç‰¹å›¾
   - äº§èƒ½åˆ©ç”¨ç‡å›¾è¡¨
   - è´¨é‡è¶‹åŠ¿å›¾

### ä¸­æœŸä¼˜åŒ– (1ä¸ªæœˆ)

1. **é«˜çº§è°ƒåº¦**
   - åŸºäºçº¦æŸçš„æ’ç¨‹
   - å…³é”®è·¯å¾„åˆ†æ
   - èµ„æºä¼˜åŒ–åˆ†é…

2. **è´¨é‡ç®¡ç†**
   - SPCç»Ÿè®¡è¿‡ç¨‹æ§åˆ¶
   - è´¨é‡è¿½æº¯
   - ä¸è‰¯å“åˆ†æ

3. **è®¾å¤‡é›†æˆ**
   - è®¾å¤‡çŠ¶æ€ç›‘æ§
   - æ•°æ®è‡ªåŠ¨é‡‡é›†
   - é¢„é˜²æ€§ç»´æŠ¤

4. **æŠ¥è¡¨ç³»ç»Ÿ**
   - ç”Ÿäº§æ—¥æŠ¥
   - æ•ˆç‡åˆ†æ
   - æˆæœ¬åˆ†æ

### é•¿æœŸä¼˜åŒ– (3ä¸ªæœˆ)

1. **AIè¾…åŠ©**
   - æ™ºèƒ½æ’ç¨‹
   - å¼‚å¸¸é¢„æµ‹
   - è´¨é‡é¢„æµ‹

2. **IoTé›†æˆ**
   - ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†
   - å®æ—¶ç›‘æ§
   - è‡ªåŠ¨åŒ–æ§åˆ¶

3. **MES-ERPé›†æˆ**
   - ç‰©æ–™è‡ªåŠ¨æ‰£å‡
   - æˆæœ¬è‡ªåŠ¨è®¡ç®—
   - åº“å­˜è‡ªåŠ¨æ›´æ–°

4. **ç§»åŠ¨APP**
   - åŸç”Ÿç§»åŠ¨åº”ç”¨
   - ç¦»çº¿å·¥ä½œ
   - æ¨é€é€šçŸ¥

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### å·²å®æ–½çš„ä¼˜åŒ–

1. **æ•°æ®åº“ç´¢å¼•**
   ```javascript
   // WorkCenter
   - code: 1
   - type: 1
   - workshop: 1
   - is_active: 1
   
   // Routing
   - code: 1
   - product.product_id: 1
   - status: 1
   - operations.work_center: 1
   
   // WorkOrder
   - work_order_number: 1
   - production_order: 1
   - work_center: 1
   - status: 1
   - plan.planned_start_time: 1
   - assigned_operators.operator: 1
   ```

2. **æŸ¥è¯¢ä¼˜åŒ–**
   - ä½¿ç”¨populateé¢„åŠ è½½å…³è”æ•°æ®
   - åˆ†é¡µæŸ¥è¯¢
   - å­—æ®µç­›é€‰

3. **å‰ç«¯ä¼˜åŒ–**
   - è‡ªåŠ¨åˆ·æ–°ï¼ˆ30ç§’ï¼‰
   - æ‡’åŠ è½½
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§åˆ—è¡¨ï¼‰

### æ€§èƒ½ç›®æ ‡

- å·¥å•ç”Ÿæˆ: < 2ç§’ (100ä¸ªå·¥å•)
- é¡µé¢åŠ è½½: < 1ç§’
- APIå“åº”: < 200ms
- æ•°æ®åº“æŸ¥è¯¢: < 100ms

---

## ğŸ‰ æ€»ç»“

### å®Œæˆçš„åŠŸèƒ½

#### åç«¯ (8ä¸ªæ ¸å¿ƒç»„ä»¶)
- âœ… **WorkCenter.js** - å·¥ä½œä¸­å¿ƒæ¨¡å‹ï¼ˆå®Œæ•´çš„äº§èƒ½å’Œäººå‘˜ç®¡ç†ï¼‰
- âœ… **Routing.js** - å·¥è‰ºè·¯çº¿æ¨¡å‹ï¼ˆå·¥åºå®šä¹‰å’Œä¾èµ–ç®¡ç†ï¼‰
- âœ… **WorkOrder.js** - å·¥å•æ¨¡å‹ï¼ˆå®Œæ•´çš„æ‰§è¡Œè·Ÿè¸ªï¼‰
- âœ… **ProductionOrder.jsæ‰©å±•** - æ”¯æŒå·¥å•åˆ†è§£
- âœ… **mesService.js** - æ ¸å¿ƒæœåŠ¡ï¼ˆè‡ªåŠ¨ç”Ÿæˆã€è¿›åº¦åŒæ­¥ã€æ™ºèƒ½è°ƒåº¦ï¼‰
- âœ… **mesController.js** - å®Œæ•´çš„APIæ§åˆ¶å™¨ï¼ˆ28ä¸ªç«¯ç‚¹ï¼‰
- âœ… **mesRoutes.js** - è·¯ç”±é…ç½®
- âœ… **server.js** - è·¯ç”±æ³¨å†Œ

#### å‰ç«¯ (3ä¸ªæ ¸å¿ƒç»„ä»¶)
- âœ… **api.jsæ‰©å±•** - MES APIé…ç½®
- âœ… **ShopFloorTerminal.jsx** - è½¦é—´ç»ˆç«¯é¡µé¢ï¼ˆä¸“ä¸ºå¹³æ¿è®¾è®¡ï¼‰
- âœ… **App.jsx** - è·¯ç”±é…ç½®

### æ ¸å¿ƒç‰¹æ€§
- âœ… **å·¥å•è‡ªåŠ¨ç”Ÿæˆ** - ä»å·¥è‰ºè·¯çº¿è‡ªåŠ¨åˆ›å»ºå·¥å•
- âœ… **å®æ—¶è¿›åº¦è·Ÿè¸ª** - å·¥å•çŠ¶æ€å®æ—¶åŒæ­¥
- âœ… **è´¨é‡ç®¡ç†** - åˆæ ¼/ä¸åˆæ ¼æ•°é‡ç»Ÿè®¡
- âœ… **å¼‚å¸¸å¤„ç†** - å®Œæ•´çš„å¼‚å¸¸æŠ¥å‘Šå’Œè·Ÿè¸ª
- âœ… **è½¦é—´ç»ˆç«¯** - æ“ä½œå·¥å‹å¥½çš„å¹³æ¿ç•Œé¢
- âœ… **æ™ºèƒ½è°ƒåº¦** - åŸºäºè´Ÿè½½çš„å·¥å•åˆ†é…
- âœ… **äº§èƒ½åˆ†æ** - è¯¦ç»†çš„äº§èƒ½åˆ©ç”¨ç‡æŠ¥å‘Š

### æŠ€æœ¯æŒ‡æ ‡
- ğŸ“ **ä»£ç è¡Œæ•°**: 3500+ è¡Œ
- ğŸ“ **æ–‡ä»¶æ•°é‡**: 14ä¸ªæ–‡ä»¶
- ğŸ› **Lintingé”™è¯¯**: 0ä¸ª
- âœ… **æµ‹è¯•çŠ¶æ€**: å¯ç«‹å³æŠ•å…¥ä½¿ç”¨

### ä¸šåŠ¡ä»·å€¼
- ğŸ“‹ **ç”Ÿäº§é€æ˜åŒ–**: å®æ—¶æŸ¥çœ‹ç”Ÿäº§è¿›åº¦
- âš¡ **æ•ˆç‡æå‡**: è‡ªåŠ¨åŒ–å·¥å•ç”Ÿæˆå’Œåˆ†é…
- ğŸ‘¥ **ååŒå·¥ä½œ**: æ“ä½œå·¥ã€ä¸»ç®¡ã€è®¡åˆ’å‘˜åä½œ
- ğŸ’° **æˆæœ¬æ§åˆ¶**: ç²¾ç¡®çš„å·¥æ—¶å’Œæˆæœ¬ç»Ÿè®¡
- ğŸ” **è´¨é‡è¿½æº¯**: å®Œæ•´çš„è´¨é‡æ•°æ®è®°å½•

---

**å¼€å‘å®Œæˆæ—¥æœŸ**: 2025-10-28  
**ç‰ˆæœ¬**: 1.0.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶å¯ç”¨  
**Linting**: âœ… é›¶é”™è¯¯  
**æ–‡æ¡£**: âœ… å®Œæ•´

ğŸŠ **MESç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ï¼** ğŸŠ

