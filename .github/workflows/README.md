# GitHub Actions å·¥ä½œæµ

æœ¬æ–‡ä»¶å¤¹åŒ…å« Project Ark é¡¹ç›®çš„ GitHub Actions è‡ªåŠ¨åŒ–å·¥ä½œæµã€‚

---

## ğŸ“š æ–‡æ¡£å¥åº·æ£€æŸ¥ (docs-health-check.yml)

### åŠŸèƒ½è¯´æ˜

è‡ªåŠ¨è¿è¡Œæ–‡æ¡£å¥åº·æ£€æŸ¥ï¼Œç›‘æµ‹ `docs/` æ–‡ä»¶å¤¹ä¸­çš„æ–‡æ¡£æ˜¯å¦åŠæ—¶æ›´æ–°ã€‚

### è§¦å‘æ¡ä»¶

| è§¦å‘æ–¹å¼ | è¯´æ˜ | ä½•æ—¶ä½¿ç”¨ |
|---------|------|---------|
| **å®šæ—¶è§¦å‘** | æ¯æœˆ1å· UTC 00:00<br/>(åŒ—äº¬æ—¶é—´ 08:00) | è‡ªåŠ¨å®šæœŸæ£€æŸ¥ |
| **æ‰‹åŠ¨è§¦å‘** | åœ¨ GitHub Actions é¡µé¢ç‚¹å‡» "Run workflow" | æŒ‰éœ€æ£€æŸ¥ |
| **Pull Request** | PR æ¶‰åŠæ–‡æ¡£æˆ–æ£€æŸ¥è„šæœ¬æ—¶ | ç¡®ä¿æ–‡æ¡£æ›´æ–° |

### å·¥ä½œæµç¨‹

```
1. ğŸ“¥ æ£€å‡ºä»£ç  (å®Œæ•´ Git å†å²)
   â†“
2. ğŸ”§ è®¾ç½® Node.js 16 ç¯å¢ƒ
   â†“
3. ğŸ“¦ å®‰è£…ä¾èµ– (å¦‚æœéœ€è¦)
   â†“
4. ğŸ©º è¿è¡Œæ–‡æ¡£å¥åº·æ£€æŸ¥
   â†“
5. ğŸ“ åˆ›å»º Issue (å¦‚æœå‘ç°é™ˆæ—§æ–‡æ¡£)
   â†“
6. ğŸ“¤ ä¸Šä¼ æ£€æŸ¥æŠ¥å‘Š
```

### æŸ¥çœ‹ç»“æœ

#### åœ¨ GitHub Actions é¡µé¢æŸ¥çœ‹

1. è¿›å…¥ä»“åº“çš„ **Actions** æ ‡ç­¾
2. ç‚¹å‡» **Documentation Health Check** å·¥ä½œæµ
3. æŸ¥çœ‹æœ€è¿‘çš„è¿è¡Œè®°å½•
4. å±•å¼€ **Run documentation health check** æ­¥éª¤æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š

#### æ‰‹åŠ¨è§¦å‘

1. è¿›å…¥ä»“åº“çš„ **Actions** æ ‡ç­¾
2. é€‰æ‹© **Documentation Health Check** å·¥ä½œæµ
3. ç‚¹å‡» **Run workflow** æŒ‰é’®
4. é€‰æ‹©åˆ†æ”¯ï¼ˆé€šå¸¸æ˜¯ main/masterï¼‰
5. ç‚¹å‡»ç»¿è‰²çš„ **Run workflow** æŒ‰é’®

### è¾“å‡ºç¤ºä¾‹

#### âœ… æ‰€æœ‰æ–‡æ¡£å¥åº·

```
ğŸ“š Documentation Health Check
ğŸ©º å¼€å§‹æ‰«ææ–‡æ¡£å¥åº·åº¦...
ğŸ“‚ æ–‡æ¡£ç›®å½•: /home/runner/work/project/project/docs
â° é™ˆæ—§é˜ˆå€¼: 180 å¤©

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
           ğŸ“Š æ‰«ææŠ¥å‘Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯:
  - æ€»æ–‡æ¡£æ•°: 4
  - å¥åº·æ–‡æ¡£: 4
  - é™ˆæ—§æ–‡æ¡£: 0
  - å¥åº·ç‡: 100.0%

ğŸ‰ æ‰€æœ‰æ ¸å¿ƒæ–‡æ¡£éƒ½ä¿æŒæœ€æ–°çŠ¶æ€ï¼Œåšå¾—å¾ˆå¥½ï¼
```

#### âš ï¸ æ£€æµ‹åˆ°é™ˆæ—§æ–‡æ¡£

```
âš ï¸  è­¦å‘Šï¼šä»¥ä¸‹ 2 ä»½æ–‡æ¡£å¯èƒ½å·²é™ˆæ—§ï¼Œè¯·å›¢é˜Ÿè¿›è¡Œäººå·¥å®¡æŸ¥ï¼š

  ğŸ“„ OLD_GUIDE.md
     æœ€åæ›´æ–°: 200 å¤©å‰
     è·¯å¾„: /home/runner/work/project/project/docs/OLD_GUIDE.md

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   ğŸ” å®¡æŸ¥å»ºè®®:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

   1. å†…å®¹æ˜¯å¦ä»ç„¶å‡†ç¡®ï¼Ÿ
   2. è¿™ä»½æ–‡æ¡£æ˜¯å¦è¿˜æœ‰å­˜åœ¨çš„å¿…è¦ï¼Ÿ
   3. æ–‡æ¡£æ˜¯å¦éœ€è¦æ‹†åˆ†æˆ–é‡ç»„ï¼Ÿ
```

### é…ç½®é€‰é¡¹

#### ä¿®æ”¹æ£€æŸ¥é¢‘ç‡

ç¼–è¾‘ `docs-health-check.yml` ä¸­çš„ cron è¡¨è¾¾å¼ï¼š

```yaml
schedule:
  - cron: '0 0 1 * *'  # æ¯æœˆ1å·
  # å…¶ä»–é€‰é¡¹ï¼š
  # - cron: '0 0 * * 1'  # æ¯å‘¨ä¸€
  # - cron: '0 0 1 */3 *'  # æ¯å­£åº¦
```

#### ä¿®æ”¹é™ˆæ—§é˜ˆå€¼

ç¼–è¾‘ `scripts/check_docs_freshness.js` ä¸­çš„é˜ˆå€¼ï¼š

```javascript
const STALE_THRESHOLD_DAYS = 180; // ä¿®æ”¹ä¸ºéœ€è¦çš„å¤©æ•°
```

#### å¯ç”¨/ç¦ç”¨ PR æ£€æŸ¥

ç¼–è¾‘ `docs-health-check.yml`ï¼š

```yaml
# å¯ç”¨ PR æ£€æŸ¥
pull_request:
  paths:
    - 'docs/**'

# ç¦ç”¨ PR æ£€æŸ¥ï¼ˆæ³¨é‡Šæ‰ï¼‰
# pull_request:
#   paths:
#     - 'docs/**'
```

### é€šçŸ¥é…ç½®

#### æ–¹æ¡ˆ1: é€šè¿‡ Slack é€šçŸ¥ï¼ˆæ¨èï¼‰

æ·»åŠ  Slack é€šçŸ¥æ­¥éª¤ï¼š

```yaml
- name: ğŸ“¢ Notify Slack
  if: failure()
  uses: slackapi/slack-github-action@v1
  with:
    payload: |
      {
        "text": "âš ï¸ æ–‡æ¡£å¥åº·æ£€æŸ¥å‘ç°é™ˆæ—§æ–‡æ¡£",
        "blocks": [
          {
            "type": "section",
            "text": {
              "type": "mrkdwn",
              "text": "è¯·æŸ¥çœ‹ GitHub Actions æ—¥å¿—è·å–è¯¦æƒ…"
            }
          }
        ]
      }
  env:
    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
```

#### æ–¹æ¡ˆ2: é€šè¿‡é‚®ä»¶é€šçŸ¥

```yaml
- name: ğŸ“§ Send email notification
  if: failure()
  uses: dawidd6/action-send-mail@v3
  with:
    server_address: smtp.gmail.com
    server_port: 465
    username: ${{ secrets.MAIL_USERNAME }}
    password: ${{ secrets.MAIL_PASSWORD }}
    subject: âš ï¸ æ–‡æ¡£å¥åº·æ£€æŸ¥è­¦å‘Š
    to: team@example.com
    from: GitHub Actions
    body: æ£€æµ‹åˆ°é™ˆæ—§æ–‡æ¡£ï¼Œè¯·æŸ¥çœ‹ Actions æ—¥å¿—
```

#### æ–¹æ¡ˆ3: è‡ªåŠ¨åˆ›å»º Issue

```yaml
- name: ğŸ“ Create issue for stale docs
  if: failure()
  uses: actions/github-script@v7
  with:
    script: |
      await github.rest.issues.create({
        owner: context.repo.owner,
        repo: context.repo.repo,
        title: 'âš ï¸ æ£€æµ‹åˆ°é™ˆæ—§æ–‡æ¡£',
        body: 'æ–‡æ¡£å¥åº·æ£€æŸ¥å‘ç°ä»¥ä¸‹æ–‡æ¡£éœ€è¦æ›´æ–°...',
        labels: ['documentation', 'maintenance']
      });
```

### æƒé™è¯´æ˜

å·¥ä½œæµéœ€è¦ä»¥ä¸‹æƒé™ï¼š

| æƒé™ | ç”¨é€” | é»˜è®¤ |
|------|------|------|
| `contents: read` | è¯»å–ä»“åº“ä»£ç  | âœ… å·²å¯ç”¨ |
| `issues: write` | åˆ›å»º Issue | âš ï¸ æŒ‰éœ€å¯ç”¨ |
| `pull-requests: write` | PR è¯„è®º | âš ï¸ æŒ‰éœ€å¯ç”¨ |

### æ•…éšœæ’é™¤

#### é—®é¢˜1: å·¥ä½œæµæ²¡æœ‰è¿è¡Œ

**æ£€æŸ¥**:
- ç¡®è®¤æ–‡ä»¶è·¯å¾„æ­£ç¡®: `.github/workflows/docs-health-check.yml`
- æ£€æŸ¥ YAML è¯­æ³•æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹ Actions æ ‡ç­¾æ˜¯å¦æœ‰é”™è¯¯æç¤º

#### é—®é¢˜2: Git log æ— æ³•è·å–å†å²

**åŸå› **: checkout æ²¡æœ‰è·å–å®Œæ•´å†å²

**è§£å†³**:
```yaml
- uses: actions/checkout@v4
  with:
    fetch-depth: 0  # å¿…é¡»è®¾ç½®ä¸º 0
```

#### é—®é¢˜3: npm å‘½ä»¤æ‰¾ä¸åˆ°

**åŸå› **: package.json ä¸åœ¨æ ¹ç›®å½•æˆ–è„šæœ¬æœªå®šä¹‰

**è§£å†³**:
- ç¡®è®¤ `package.json` åœ¨é¡¹ç›®æ ¹ç›®å½•
- ç¡®è®¤å®šä¹‰äº† `docs:health-check` è„šæœ¬

#### é—®é¢˜4: å·¥ä½œæµä¸€ç›´å¤±è´¥

**æ£€æŸ¥**:
1. æŸ¥çœ‹ Actions æ—¥å¿—çš„è¯¦ç»†é”™è¯¯
2. åœ¨æœ¬åœ°è¿è¡Œ `npm run docs:health-check` æµ‹è¯•
3. ç¡®è®¤ Node.js ç‰ˆæœ¬å…¼å®¹

### æœ€ä½³å®è·µ

#### 1. å®šæœŸæŸ¥çœ‹æŠ¥å‘Š

- **æ¯æœˆåˆ**: æŸ¥çœ‹è‡ªåŠ¨è¿è¡Œçš„ç»“æœ
- **å‘ç°é—®é¢˜**: åŠæ—¶å®‰æ’æ–‡æ¡£æ›´æ–°
- **æ— é—®é¢˜**: è®°å½•åœ¨å›¢é˜Ÿä¼šè®®ä¸­

#### 2. ç»“åˆå…¶ä»–æ£€æŸ¥

å¯ä»¥ä¸å…¶ä»–è´¨é‡æ£€æŸ¥ä¸€èµ·è¿è¡Œï¼š

```yaml
# ä¸æµ‹è¯•ä¸€èµ·è¿è¡Œ
- name: Run tests
  run: npm test

- name: Run docs health check
  run: npm run docs:health-check
```

#### 3. ä¿å­˜å†å²è®°å½•

ä½¿ç”¨ artifact ä¿å­˜æ£€æŸ¥æŠ¥å‘Šï¼š

```yaml
- uses: actions/upload-artifact@v4
  with:
    name: docs-health-check-${{ github.run_number }}
    path: docs/
    retention-days: 90
```

### æˆæœ¬è€ƒè™‘

GitHub Actions å…è´¹é¢åº¦ï¼ˆå…¬å¼€ä»“åº“ï¼‰ï¼š
- **å…¬å¼€ä»“åº“**: æ— é™åˆ¶ âœ…
- **ç§æœ‰ä»“åº“**: æ¯æœˆ 2000 åˆ†é’Ÿ

æœ¬å·¥ä½œæµæ¯æ¬¡è¿è¡Œçº¦ **1-2 åˆ†é’Ÿ**ï¼Œæ¯æœˆè¿è¡Œ 1 æ¬¡ï¼Œæˆæœ¬å¯å¿½ç•¥ã€‚

### å®‰å…¨è€ƒè™‘

- âœ… å·¥ä½œæµåªè¯»å–ä»£ç ï¼Œä¸ä¿®æ”¹
- âœ… ä¸éœ€è¦æ•æ„Ÿå‡­æ®ï¼ˆé™¤éé…ç½®é€šçŸ¥ï¼‰
- âœ… å¯ä»¥åœ¨ fork ä¸­å®‰å…¨è¿è¡Œ
- âš ï¸ å¦‚æœæ·»åŠ é€šçŸ¥ï¼Œéœ€è¦å®‰å…¨å­˜å‚¨ secrets

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¯ç”¨å·¥ä½œæµ

1. **æäº¤å·¥ä½œæµæ–‡ä»¶**
   ```bash
   git add .github/workflows/docs-health-check.yml
   git commit -m "ci: Add documentation health check workflow"
   git push
   ```

2. **é¦–æ¬¡æ‰‹åŠ¨è¿è¡Œ**
   - è¿›å…¥ GitHub â†’ Actions
   - é€‰æ‹© Documentation Health Check
   - ç‚¹å‡» Run workflow

3. **æŸ¥çœ‹ç»“æœ**
   - ç­‰å¾…å·¥ä½œæµå®Œæˆ
   - æŸ¥çœ‹è¾“å‡ºæ—¥å¿—

### é…ç½®é€šçŸ¥ï¼ˆå¯é€‰ï¼‰

1. **é€‰æ‹©é€šçŸ¥æ–¹å¼**ï¼ˆSlack / Email / Issueï¼‰
2. **é…ç½® Secrets**ï¼ˆå¦‚æœéœ€è¦ï¼‰
   - Settings â†’ Secrets â†’ New repository secret
3. **ä¿®æ”¹å·¥ä½œæµæ–‡ä»¶**æ·»åŠ é€šçŸ¥æ­¥éª¤
4. **æµ‹è¯•é€šçŸ¥**

---

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### å®šæœŸæ£€æŸ¥

- **æ¯æœˆ**: æŸ¥çœ‹è‡ªåŠ¨è¿è¡Œç»“æœ
- **æ¯å­£åº¦**: è¯„ä¼°å·¥ä½œæµæ•ˆæœ
- **æ¯å¹´**: æ›´æ–° GitHub Actions ç‰ˆæœ¬

### æ€§èƒ½ä¼˜åŒ–

å¦‚æœå·¥ä½œæµè¿è¡Œæ—¶é—´è¿‡é•¿ï¼š

1. **ç¼“å­˜ä¾èµ–**
   ```yaml
   - uses: actions/cache@v3
     with:
       path: ~/.npm
       key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
   ```

2. **å‡å°‘æ£€æŸ¥èŒƒå›´**ï¼ˆå¦‚æœæ–‡æ¡£å¾ˆå¤šï¼‰

3. **è°ƒæ•´è¿è¡Œé¢‘ç‡**

---

## ğŸ“ æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|---------|
| v1.0 | 2025-10-30 | åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒå®šæ—¶å’Œæ‰‹åŠ¨è§¦å‘ |

---

Â© 2025 Project Ark Team. All Rights Reserved.

